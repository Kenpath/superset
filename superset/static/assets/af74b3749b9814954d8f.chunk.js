/*! For license information please see af74b3749b9814954d8f.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1685:function(t,e,i){var s;!function(n,o,a){if(n){for(var r,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},h={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)l[111+p]="f"+p;for(p=0;p<=9;++p)l[p+96]=p.toString();_.prototype.bind=function(t,e,i){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,i),this},_.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},_.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},_.prototype.reset=function(){return this._callbacks={},this._directMap={},this},_.prototype.stopCallback=function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!function t(e,i){return null!==e&&e!==o&&(e===i||t(e.parentNode,i))}(e,this.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},_.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},_.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(l[e]=t[e]);r=null},_.init=function(){var t=_(o);for(var e in t)"_"!==e.charAt(0)&&(_[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},_.init(),n.Mousetrap=_,t.exports&&(t.exports=_),void 0===(s=function(){return _}.call(e,i,e,t))||(t.exports=s)}function d(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}function g(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return l[t.which]?l[t.which]:h[t.which]?h[t.which]:String.fromCharCode(t.which).toLowerCase()}function f(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function m(t,e,i){return i||(i=function(){if(!r)for(var t in r={},l)t>95&&t<112||l.hasOwnProperty(t)&&(r[l[t]]=t);return r}()[t]?"keydown":"keypress"),"keypress"==i&&e.length&&(i="keydown"),i}function v(t,e){var i,s,n,o=[];for(i=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),n=0;n<i.length;++n)s=i[n],u[s]&&(s=u[s]),e&&"keypress"!=e&&c[s]&&(s=c[s],o.push("shift")),f(s)&&o.push(s);return{key:s,modifiers:o,action:e=m(s,o,e)}}function _(t){var e=this;if(t=t||o,!(e instanceof _))return new _(t);e.target=t,e._callbacks={},e._directMap={};var i,s={},n=!1,a=!1,r=!1;function l(t){t=t||{};var e,i=!1;for(e in s)t[e]?i=!0:s[e]=0;i||(r=!1)}function h(t,i,n,o,a,r){var l,h,c,u,p=[],d=n.type;if(!e._callbacks[t])return[];for("keyup"==d&&f(t)&&(i=[t]),l=0;l<e._callbacks[t].length;++l)if(h=e._callbacks[t][l],(o||!h.seq||s[h.seq]==h.level)&&d==h.action&&("keypress"==d&&!n.metaKey&&!n.ctrlKey||(c=i,u=h.modifiers,c.sort().join(",")===u.sort().join(",")))){var g=!o&&h.combo==a,m=o&&h.seq==o&&h.level==r;(g||m)&&e._callbacks[t].splice(l,1),p.push(h)}return p}function c(t,i,s,n){e.stopCallback(i,i.target||i.srcElement,s,n)||!1===t(i,s)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(i),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(i))}function u(t){"number"!=typeof t.which&&(t.which=t.keyCode);var i=g(t);i&&("keyup"!=t.type||n!==i?e.handleKey(i,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):n=!1)}function p(t,e,o,a){function h(e){return function(){r=e,++s[t],clearTimeout(i),i=setTimeout(l,1e3)}}function u(e){c(o,e,t),"keyup"!==a&&(n=g(e)),setTimeout(l,10)}s[t]=0;for(var p=0;p<e.length;++p){var d=p+1===e.length?u:h(a||v(e[p+1]).action);m(e[p],d,a,t,p)}}function m(t,i,s,n,o){e._directMap[t+":"+s]=i;var a,r=(t=t.replace(/\s+/g," ")).split(" ");r.length>1?p(t,r,i,s):(a=v(t,s),e._callbacks[a.key]=e._callbacks[a.key]||[],h(a.key,a.modifiers,{type:a.action},n,t,o),e._callbacks[a.key][n?"unshift":"push"]({callback:i,modifiers:a.modifiers,action:a.action,seq:n,level:o,combo:t}))}e._handleKey=function(t,e,i){var s,n=h(t,e,i),o={},u=0,p=!1;for(s=0;s<n.length;++s)n[s].seq&&(u=Math.max(u,n[s].level));for(s=0;s<n.length;++s)if(n[s].seq){if(n[s].level!=u)continue;p=!0,o[n[s].seq]=1,c(n[s].callback,i,n[s].combo,n[s].seq)}else p||c(n[s].callback,i,n[s].combo);var d="keypress"==i.type&&a;i.type!=r||f(t)||d||l(o),a=p&&"keydown"==i.type},e._bindMultiple=function(t,e,i){for(var s=0;s<t.length;++s)m(t[s],e,i)},d(t,"keypress",u),d(t,"keydown",u),d(t,"keyup",u)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},4640:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(4644),n=i(167);const o=[-90,90],a=[-180,180];function r(t,e,i){let[s,n]=t,[o,a]=e;return void 0===i&&(i=.25),s<n?[s,n]:[Math.max(o,s-i),Math.min(a,n+i)]}function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function h(t,e){let{points:i,width:h,height:c,minExtent:u,maxZoom:p,offset:d,padding:g=20}=e;const{bearing:f,pitch:m}=t,v=function(t){const e=r(Object(n.extent)(t,t=>t[1]),o),i=r(Object(n.extent)(t,t=>t[0]),a);return[[i[0],e[0]],[i[1],e[1]]]}(i);try{return l({},Object(s.c)({bounds:v,width:h,height:c,minExtent:u,maxZoom:p,offset:d,padding:g}),{bearing:f,pitch:m})}catch(t){console.error("Could not fit viewport",t)}return t}},4645:function(t,e,i){"use strict";i.d(e,"f",(function(){return n})),i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return d})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return _})),i.d(e,"c",(function(){return y}));i(4637);const s={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function n(t,e,i={}){return function(t,e={}){return Math.sign(o(t,e))}(t,i)!==e&&(function(t,e){const{start:i=0,end:s=t.length,size:n=2}=e,o=(s-i)/n,a=Math.floor(o/2);for(let e=0;e<a;++e){const s=i+e*n,a=i+(o-1-e)*n;for(let e=0;e<n;++e){const i=t[s+e];t[s+e]=t[a+e],t[a+e]=i}}}(t,i),!0)}function o(t,e={}){const{start:i=0,end:s=t.length}=e,n=e.size||2;let o=0;for(let e=i,a=s-n;e<s;e+=n)o+=(t[e]-t[a])*(t[e+1]+t[a+1]),a=e;return o/2}function a(t,e){const i=e.length,s=t.length;if(s>0){let n=!0;for(let o=0;o<i;o++)if(t[s-i+o]!==e[o]){n=!1;break}if(n)return!1}for(let n=0;n<i;n++)t[s+n]=e[n];return!0}function r(t,e){const i=e.length;for(let s=0;s<i;s++)t[s]=e[s]}function l(t,e,i,s,n=[]){const o=s+e*i;for(let e=0;e<i;e++)n[e]=t[o+e];return n}function h(t,e,i,s,n=[]){let o,a;if(8&i)o=(s[3]-t[1])/(e[1]-t[1]),a=3;else if(4&i)o=(s[1]-t[1])/(e[1]-t[1]),a=1;else if(2&i)o=(s[2]-t[0])/(e[0]-t[0]),a=2;else{if(!(1&i))return null;o=(s[0]-t[0])/(e[0]-t[0]),a=0}for(let i=0;i<t.length;i++)n[i]=(1&a)===i?s[a]:o*(e[i]-t[i])+t[i];return n}function c(t,e){let i=0;return t[0]<e[0]?i|=1:t[0]>e[2]&&(i|=2),t[1]<e[1]?i|=4:t[1]>e[3]&&(i|=8),i}function u(t,e={}){const{size:i=2,broken:s=!1,gridResolution:n=10,gridOffset:o=[0,0],startIndex:u=0,endIndex:p=t.length}=e,d=(p-u)/i;let g=[];const v=[g],_=l(t,0,i,u);let y,b;const C=f(_,n,o,[]),w=[];a(g,_);for(let e=1;e<d;e++){for(y=l(t,e,i,u,y),b=c(y,C);b;){h(_,y,b,C,w);const t=c(w,C);t&&(h(_,w,t,C,w),b=t),a(g,w),r(_,w),m(C,n,b),s&&g.length>i&&(g=[],v.push(g),a(g,_)),b=c(y,C)}a(g,y),r(_,y)}return s?v:v[0]}function p(t,e){for(let i=0;i<e.length;i++)t.push(e[i]);return t}function d(t,e,i={}){if(!t.length)return[];const{size:s=2,gridResolution:n=10,gridOffset:o=[0,0],edgeTypes:a=!1}=i,r=[],l=[{pos:t,types:a&&new Array(t.length/s).fill(1),holes:e||[]}],h=[[],[]];let u=[];for(;l.length;){const{pos:t,types:e,holes:i}=l.shift();v(t,s,i[0]||t.length,h),u=f(h[0],n,o,u);const d=c(h[1],u);if(d){let n=g(t,e,s,0,i[0]||t.length,u,d);const o={pos:n[0].pos,types:n[0].types,holes:[]},r={pos:n[1].pos,types:n[1].types,holes:[]};l.push(o,r);for(let l=0;l<i.length;l++)n=g(t,e,s,i[l],i[l+1]||t.length,u,d),n[0]&&(o.holes.push(o.pos.length),o.pos=p(o.pos,n[0].pos),a&&(o.types=p(o.types,n[0].types))),n[1]&&(r.holes.push(r.pos.length),r.pos=p(r.pos,n[1].pos),a&&(r.types=p(r.types,n[1].types)))}else{const s={positions:t};a&&(s.edgeTypes=e),i.length&&(s.holeIndices=i),r.push(s)}}return r}function g(t,e,i,s,n,o,c){const u=(n-s)/i,p=[],d=[],g=[],f=[],m=[];let v,_,y;const b=l(t,u-1,i,s);let C=Math.sign(8&c?b[1]-o[3]:b[0]-o[2]),w=e&&e[u-1],x=0,k=0;for(let n=0;n<u;n++)v=l(t,n,i,s,v),_=Math.sign(8&c?v[1]-o[3]:v[0]-o[2]),y=e&&e[s/i+n],_&&C&&C!==_&&(h(b,v,c,o,m),a(p,m)&&g.push(w),a(d,m)&&f.push(w)),_<=0?(a(p,v)&&g.push(y),x-=_):g.length&&(g[g.length-1]=0),_>=0?(a(d,v)&&f.push(y),k+=_):f.length&&(f[f.length-1]=0),r(b,v),C=_,w=y;return[x?{pos:p,types:e&&g}:null,k?{pos:d,types:e&&f}:null]}function f(t,e,i,s){const n=Math.floor((t[0]-i[0])/e)*e+i[0],o=Math.floor((t[1]-i[1])/e)*e+i[1];return s[0]=n,s[1]=o,s[2]=n+e,s[3]=o+e,s}function m(t,e,i){8&i?(t[1]+=e,t[3]+=e):4&i?(t[1]-=e,t[3]-=e):2&i?(t[0]+=e,t[2]+=e):1&i&&(t[0]-=e,t[2]-=e)}function v(t,e,i,s){let n=1/0,o=-1/0,a=1/0,r=-1/0;for(let s=0;s<i;s+=e){const e=t[s],i=t[s+1];n=e<n?e:n,o=e>o?e:o,a=i<a?i:a,r=i>r?i:r}return s[0][0]=n,s[0][1]=a,s[1][0]=o,s[1][1]=r,s}function _(t,e={}){const{size:i=2,startIndex:s=0,endIndex:n=t.length,normalize:o=!0}=e,a=t.slice(s,n);w(a,i,0,n-s);const r=u(a,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of r)x(t,i);return r}function y(t,e,i={}){const{size:s=2,normalize:n=!0,edgeTypes:o=!1}=i;e=e||[];const a=[],r=[];let l=0,h=0;for(let n=0;n<=e.length;n++){const o=e[n]||t.length,c=h,u=b(t,s,l,o);for(let e=u;e<o;e++)a[h++]=t[e];for(let e=l;e<u;e++)a[h++]=t[e];w(a,s,c,h),C(a,s,c,h,i.maxLatitude),l=o,r[n]=h}r.pop();const c=d(a,r,{size:s,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(n)for(const t of c)x(t.positions,s);return c}function b(t,e,i,s){let n=-1,o=-1;for(let a=i+1;a<s;a+=e){const e=Math.abs(t[a]);e>n&&(n=e,o=a-1)}return o}function C(t,e,i,s,n=85.051129){const o=t[i],r=t[s-e];if(Math.abs(o-r)>180){const s=l(t,0,e,i);s[0]+=360*Math.round((r-o)/360),a(t,s),s[1]=Math.sign(s[1])*n,a(t,s),s[0]=o,a(t,s)}}function w(t,e,i,s){let n,o=t[0];for(let a=i;a<s;a+=e){n=t[a];const e=n-o;(e>180||e<-180)&&(n-=360*Math.round(e/360)),t[a]=o=n}}function x(t,e){let i;const s=t.length/e;for(let n=0;n<s&&(i=t[n*e],(i+180)%360==0);n++);const n=360*-Math.round(i/360);if(0!==n)for(let i=0;i<s;i++)t[i*e]+=n}},4646:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var s=i(37),n=i.n(s);const o=[1,0,1,0,0,0,0];function a(t,e){const i=parseInt(n()(e).format("x"),10);return parseInt(n()(e).add(t).format("x"),10)-i}function r(t,e){const i=n()(Number(t.reduce((t,e)=>t<e?t:e))),s=n()(Number(t.reduce((t,e)=>t>e?t:e)));let r,l,h;if(e.includes("/")){const t=e.split("/",2);t[0].endsWith("Z")?(l=n()(t[0]),r=n.a.duration(t[1])):(l=n()(t[1]),r=n.a.duration(t[0]))}else r=n.a.duration(e),l=function(t,e){const i=n()(t).subtract(e),s=t.toArray(),a=i.toArray(),r=s.map((t,e)=>a[e]!==t).indexOf(!0),l=s.map((t,e)=>{if(e===r){const i=t-a[e];return t-(t-o[e])%i}return e<r||-1===r?t:o[e]});return n()(l)}(i,r);const c=i.valueOf();for(h=l.clone();h.valueOf()<c;)h.add(r);for(;h.valueOf()>c;)h.subtract(r);let u;const p=s.valueOf();for(u=l.clone();u.valueOf()>p;)u.subtract(r);for(;u.valueOf()<p;)u.add(r);const d=null!=e?[h,h.clone().add(r)]:[h,u],g=t.every(t=>null===t);return{start:parseInt(h.format("x"),10),end:parseInt(u.format("x"),10),getStep:a.bind(this,r),values:d.map(t=>parseInt(t.format("x"),10)),disabled:g}}},4648:function(t,e,i){"use strict";i.d(e,"a",(function(){return _}));var s=i(0),n=i.n(s),o=i(2),a=i.n(o),r=i(4647),l=i(1685),h=i.n(l),c=i(13),u=i(4654),p=i.n(u);i(4656),i(4657);function d(t){return n.a.createElement("span",{className:"BootstrapSliderWrapper"},n.a.createElement(p.a,t))}i(4658);const g={start:a.a.number.isRequired,step:a.a.number.isRequired,end:a.a.number.isRequired,values:a.a.array.isRequired,onChange:a.a.func,loopDuration:a.a.number,maxFrames:a.a.number,orientation:a.a.oneOf(["horizontal","vertical"]),reversed:a.a.bool,disabled:a.a.bool,range:a.a.bool};class f extends n.a.PureComponent{constructor(t){super(t),this.state={intervalId:null};const e=t.end-t.start,i=Math.min(t.maxFrames,e/t.step),s=e/i;this.intervalMilliseconds=t.loopDuration/i,this.increment=s<t.step?t.step:s-s%t.step,this.onChange=this.onChange.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stepBackward=this.stepBackward.bind(this),this.stepForward=this.stepForward.bind(this),this.getPlayClass=this.getPlayClass.bind(this),this.formatter=this.formatter.bind(this)}componentDidMount(){h.a.bind(["space"],this.play)}componentWillUnmount(){h.a.unbind(["space"])}onChange(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}getPlayClass(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"}play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{const t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}stepForward(){const{start:t,end:e,step:i,values:s,disabled:n}=this.props;if(n)return;const o=(Array.isArray(s)?s:[s,s+i]).map(t=>t+this.increment),a=o[1]>e?o[0]-t:0;this.props.onChange(o.map(t=>t-a))}stepBackward(){const{start:t,end:e,step:i,values:s,disabled:n}=this.props;if(n)return;const o=(Array.isArray(s)?s:[s,s+i]).map(t=>t-this.increment),a=o[0]<t?e-o[1]:0;this.props.onChange(o.map(t=>t+a))}formatter(t){if(this.props.disabled)return Object(c.e)("Data has no time steps");let e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(t=>new Date(t).toUTCString()).join(" : ")}render(){const{start:t,end:e,step:i,orientation:s,reversed:o,disabled:a,range:r,values:l}=this.props;return n.a.createElement("div",{className:"play-slider"},n.a.createElement("div",{className:"play-slider-controls padded"},n.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),n.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),n.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),n.a.createElement("div",{className:"play-slider-scrobbler padded"},n.a.createElement(d,{value:r?l:l[0],range:r,formatter:this.formatter,change:this.onChange,min:t,max:e,step:i,orientation:s,reversed:o,disabled:a?"disabled":"enabled"})))}}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}f.propTypes=g,f.defaultProps={onChange:()=>{},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0};const v={getLayers:a.a.func.isRequired,start:a.a.number.isRequired,end:a.a.number.isRequired,getStep:a.a.func,values:a.a.array.isRequired,aggregation:a.a.bool,disabled:a.a.bool,viewport:a.a.object.isRequired,children:a.a.node,mapStyle:a.a.string,mapboxApiAccessToken:a.a.string.isRequired,setControlValue:a.a.func,onValuesChange:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class _ extends n.a.PureComponent{constructor(){super(...arguments),m(this,"containerRef",n.a.createRef()),m(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)})}render(){const{start:t,end:e,getStep:i,disabled:s,aggregation:o,children:a,getLayers:l,values:h,onValuesChange:c,viewport:u,setControlValue:p,mapStyle:d,mapboxApiAccessToken:g,height:m,width:v}=this.props,_=l(h);return n.a.createElement("div",null,n.a.createElement(r.a,{ref:this.containerRef,viewport:u,layers:_,setControlValue:p,mapStyle:d,mapboxApiAccessToken:g,bottomMargin:s?0:20,width:v,height:m}),!s&&n.a.createElement(f,{start:t,end:e,step:i(t),values:h,range:!o,onChange:c}),a)}}_.propTypes=v,_.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:()=>{},onValuesChange:()=>{}}},4652:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return l}));const s={SUM:1,MEAN:2,MIN:3,MAX:4};function n(t,e){return t+e}function o(t,e){return e>t?e:t}function a(t,e){return e<t?e:t}function r(t,e,i){const r=s[t]||s.SUM;switch(e=function(t,e={}){if(Number.isFinite(t))return t;return i=>(e.index=i.index,t(i.source,e))}(e,i),r){case s.MIN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(a,1/0):null}(t,e);case s.SUM:return t=>function(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(n,0):null}(t,e);case s.MEAN:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(n,0)/i.length:null}(t,e);case s.MAX:return t=>function(t,e){if(Number.isFinite(e))return t.length?e:null;const i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(o,-1/0):null}(t,e);default:return null}}function l(t,e={}){return i=>(e.indices=i.map(t=>t.index),t(i.map(t=>t.source),e))}},4654:function(t,e,i){var s,n,o;n=[e,i(90),i(217),i(265),i(255),i(256),i(0),i(2),i(4655)],void 0===(o="function"==typeof(s=function(t,e,i,s,n,o,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactBootstrapSlider=void 0;var h=v(e),c=v(i),u=v(s),p=v(n),d=v(o),g=v(a),f=v(r),m=v(l);function v(t){return t&&t.__esModule?t:{default:t}}var _=t.ReactBootstrapSlider=function(t){function e(){var t,i,s,n;(0,c.default)(this,e);for(var o=arguments.length,a=Array(o),r=0;r<o;r++)a[r]=arguments[r];return i=s=(0,p.default)(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),s.checkAndDoDisabled=function(){var t="disabled"!==s.props.disabled,e=s.mySlider.isEnabled();t?e||s.mySlider.enable():e&&s.mySlider.disable()},s.updateSliderValues=function(){void 0===s.props.min||void 0===s.mySlider.min&&void 0===s.mySlider.options.min||s.mySlider.setAttribute("min",s.props.min),void 0===s.props.max||void 0===s.mySlider.max&&void 0===s.mySlider.options.max||s.mySlider.setAttribute("max",s.props.max),void 0===s.props.step||void 0===s.mySlider.step&&void 0===s.mySlider.options.step||s.mySlider.setAttribute("step",s.props.step),s.mySlider.setValue(s.props.value),s.checkAndDoDisabled()},n=i,(0,p.default)(s,n)}return(0,d.default)(e,t),(0,u.default)(e,[{key:"componentDidMount",value:function(){var t=this,e=(0,h.default)({},this.props,{tooltip:this.props.tooltip||"show"});if(this.mySlider=new m.default(this.node,e),this.props.change||this.props.handleChange){var i=this.props.change||this.props.handleChange;this.mySlider.on("change",(function(t){var e={target:{}};e.target.value=t.newValue,i(e)}))}this.props.slideStop&&this.mySlider.on("slideStop",(function(e){var i={target:{}};i.target.value=e,t.props.slideStop(i)})),this.checkAndDoDisabled()}},{key:"componentDidUpdate",value:function(){this.updateSliderValues()}},{key:"componentWillUnmount",value:function(){this.mySlider.destroy()}},{key:"render",value:function(){var t=this;return g.default.createElement("div",{ref:function(e){return t.node=e}})}}]),e}(g.default.Component);_.propTypes={min:f.default.number,max:f.default.number,step:f.default.number,value:f.default.oneOfType([f.default.number,f.default.arrayOf(f.default.number.isRequired).isRequired]).isRequired,disabled:f.default.string,tooltip:f.default.string,change:f.default.func,handleChange:f.default.func,slideStop:f.default.func,labelledby:f.default.oneOfType([f.default.string,f.default.arrayOf(f.default.string)])},t.default=_})?s.apply(e,n):s)||(t.exports=o)},4655:function(t,e,i){"use strict";var s,n,o,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="object"===("undefined"==typeof window?"undefined":a(window));n=[i(107)],void 0===(o="function"==typeof(s=function(t){var e;return r&&!window.console&&(window.console={}),r&&!window.console.log&&(window.console.log=function(){}),r&&!window.console.warn&&(window.console.warn=function(){}),function(t){var e=Array.prototype.slice;function i(){}!function(t){if(t){var s="undefined"==typeof console?i:function(t){console.error(t)};t.bridget=function(i,n){!function(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}(n),function(i,n){t.fn[i]=function(o){if("string"==typeof o){for(var a=e.call(arguments,1),r=0,l=this.length;r<l;r++){var h=this[r],c=t.data(h,i);if(c)if(t.isFunction(c[o])&&"_"!==o.charAt(0)){var u=c[o].apply(c,a);if(void 0!==u&&u!==c)return u}else s("no such method '"+o+"' for "+i+" instance");else s("cannot call methods on "+i+" prior to initialization; attempted to call '"+o+"'")}return this}var p=this.map((function(){var e=t.data(this,i);return e?(e.option(o),e._init()):(e=new n(this,o),t.data(this,i,e)),t(this)}));return!p||p.length>1?p:p[0]}}(i,n)},t.bridget}}(t)}(t),function(t){var i=function(t){return"Invalid input value '"+t+"' passed in"},s={linear:{toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(this.options.ticks_positions.length>0){for(var s,n,o,a=0,r=1;r<this.options.ticks_positions.length;r++)if(t<=this.options.ticks_positions[r]){s=this.options.ticks[r-1],o=this.options.ticks_positions[r-1],n=this.options.ticks[r],a=this.options.ticks_positions[r];break}e=s+(t-o)/(a-o)*(n-s),i=!1}var l=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return l<this.options.min?this.options.min:l>this.options.max?this.options.max:l},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var e,i,s,n=0,o=0;o<this.options.ticks.length;o++)if(t<=this.options.ticks[o]){e=o>0?this.options.ticks[o-1]:0,s=o>0?this.options.ticks_positions[o-1]:0,i=this.options.ticks[o],n=this.options.ticks_positions[o];break}if(o>0)return s+(t-e)/(i-e)*(n-s)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),s=Math.exp(e+(i-e)*t/100);return Math.round(s)===this.options.max?this.options.max:(s=this.options.min+Math.round((s-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:s>this.options.max?this.options.max:s},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===t?0:Math.log(t))-i)/(e-i)}}};function n(e,i){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),i=i||{};for(var n=Object.keys(this.defaultOptions),o=0;o<n.length;o++){var a=n[o],r=i[a];r=null!==(r=void 0!==r?r:l(this.element,a))?r:this.defaultOptions[a],this.options||(this.options={}),this.options[a]=r}function l(t,e){var i="data-slider-"+e.replace(/_/g,"-"),s=t.getAttribute(i);try{return JSON.parse(s)}catch(t){return s}}"auto"===this.options.rtl&&(this.options.rtl="rtl"===window.getComputedStyle(this.element).direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var h,c,u,p,d,g=this.element.style.width,f=!1,m=this.element.parentNode;if(this.sliderElem)f=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var v=document.createElement("div");v.className="slider-track",(c=document.createElement("div")).className="slider-track-low",(h=document.createElement("div")).className="slider-selection",(u=document.createElement("div")).className="slider-track-high",(p=document.createElement("div")).className="slider-handle min-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),(d=document.createElement("div")).className="slider-handle max-slider-handle",d.setAttribute("role","slider"),d.setAttribute("aria-valuemin",this.options.min),d.setAttribute("aria-valuemax",this.options.max),v.appendChild(c),v.appendChild(h),v.appendChild(u),this.rangeHighlightElements=[];var _=this.options.rangeHighlights;if(Array.isArray(_)&&_.length>0)for(var y=0;y<_.length;y++){var b=document.createElement("div"),C=_[y].class||"";b.className="slider-rangeHighlight slider-selection "+C,this.rangeHighlightElements.push(b),v.appendChild(b)}var w=Array.isArray(this.options.labelledby);if(w&&this.options.labelledby[0]&&p.setAttribute("aria-labelledby",this.options.labelledby[0]),w&&this.options.labelledby[1]&&d.setAttribute("aria-labelledby",this.options.labelledby[1]),!w&&this.options.labelledby&&(p.setAttribute("aria-labelledby",this.options.labelledby),d.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",o=0;o<this.options.ticks.length;o++){var x=document.createElement("div");if(x.className="slider-tick",this.options.ticks_tooltip){var k=this._addTickListener(),E=k.addMouseEnter(this,x,o),S=k.addMouseLeave(this,x);this.ticksCallbackMap[o]={mouseEnter:E,mouseLeave:S}}this.ticks.push(x),this.ticksContainer.appendChild(x)}h.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",o=0;o<this.options.ticks_labels.length;o++){var L=document.createElement("div"),P=0===this.options.ticks_positions.length,A=this.options.reversed&&P?this.options.ticks_labels.length-(o+1):o;L.className="slider-tick-label",L.innerHTML=this.options.ticks_labels[A],this.tickLabels.push(L),this.tickLabelContainer.appendChild(L)}var M=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},T=document.createElement("div");T.className="tooltip tooltip-main",T.setAttribute("role","presentation"),M(T);var D=document.createElement("div");D.className="tooltip tooltip-min",D.setAttribute("role","presentation"),M(D);var O=document.createElement("div");O.className="tooltip tooltip-max",O.setAttribute("role","presentation"),M(O),this.sliderElem.appendChild(v),this.sliderElem.appendChild(T),this.sliderElem.appendChild(D),this.sliderElem.appendChild(O),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(p),this.sliderElem.appendChild(d),m.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),s[this.options.scale]&&(this.options.scale=s[this.options.scale]),!0===f&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach((function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)}),this),[this.handle1,this.handle2].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")}),this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-right"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"left"),this._removeClass(t,"top")}),this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=g,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=c||this.trackLow,this.trackSelection=h||this.trackSelection,this.trackHigh=u||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=p||this.handle1,this.handle2=d||this.handle2,!0===f)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),o=0;o<this.ticks.length;o++)this._removeClass(this.ticks[o],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),o=0;o<this.ticks.length;o++)this._addClass(this.ticks[o],this.options.handle);if(this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable){var N=!1;try{var R=Object.defineProperty({},"passive",{get:function(){N=!0}});window.addEventListener("test",null,R)}catch(t){}var j=!!N&&{passive:!0};this.sliderElem.addEventListener("touchstart",this.touchstart,j),this.sliderElem.addEventListener("touchmove",this.touchmove,j)}if(this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip)this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide");else if("always"===this.options.tooltip)this._showTooltip(),this._alwaysShowTooltip=!0;else{if(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip){var V=this._addTickListener(),F=V.addMouseEnter(this,this.handle1),z=V.addMouseLeave(this,this.handle1);this.handleCallbackMap.handle1={mouseEnter:F,mouseLeave:z},F=V.addMouseEnter(this,this.handle2),z=V.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:F,mouseLeave:z}}else this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1);this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)}this.options.enabled?this.enable():this.disable()}if((e=function(t,e){return n.call(this,t,e),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t||(t=0);var s=this.getValue();this._state.value=this._validateInputValue(t);var n=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=n(this._state.value[0]),this._state.value[1]=n(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=n(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var o=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(o),!0===e&&this._trigger("slide",o),s!==o&&!0===i&&this._trigger("change",{oldValue:s,newValue:o}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(e,i){t?(this.$element.off(e,i),this.$sliderElem.off(e,i)):this._unbindNonQueryEventHandler(e,i)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),n.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._resize(),this._layout(),this},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1)}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_setToolTipOnMouseOver:function(t){var e=this.options.formatter(t?t.value[0]:this._state.value[0]),i=s(t||this._state,this.options.reversed);function s(t,e){return e?[100-t.percentage[0],this.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=i[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px")},_addTickListener:function(){return{addMouseEnter:function(t,e,i){var s=function(){var e=t._state,s=i>=0?i:this.attributes["aria-valuenow"].value,n=parseInt(s,10);e.value[0]=n,e.percentage[0]=t.options.ticks_positions[n],t._setToolTipOnMouseOver(e),t._showTooltip()};return e.addEventListener("mouseenter",s,!1),s},addMouseLeave:function(t,e){var i=function(){t._hideTooltip()};return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),isNaN(this.options.formatter(this._state.value[0]))&&this.handle1.setAttribute("aria-valuetext",this.options.formatter(this._state.value[0])),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),isNaN(this.options.formatter(this._state.value[1]))&&this.handle2.setAttribute("aria-valuetext",this.options.formatter(this._state.value[1])),this.rangeHighlightElements.length>0&&Array.isArray(this.options.rangeHighlights)&&this.options.rangeHighlights.length>0)for(var i=0;i<this.options.rangeHighlights.length;i++){var s=this._toPercentage(this.options.rangeHighlights[i].start),n=this._toPercentage(this.options.rangeHighlights[i].end);if(this.options.reversed){var o=100-n;n=100-s,s=o}var a=this._createHighlightRange(s,n);a?"vertical"===this.options.orientation?(this.rangeHighlightElements[i].style.top=a.start+"%",this.rangeHighlightElements[i].style.height=a.size+"%"):(this.options.rtl?this.rangeHighlightElements[i].style.right=a.start+"%":this.rangeHighlightElements[i].style.left=a.start+"%",this.rangeHighlightElements[i].style.width=a.size+"%"):this.rangeHighlightElements[i].style.display="none"}if(Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var r,l="vertical"===this.options.orientation?"height":"width";r="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft";var h=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var c=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[r]=-h/2+"px"),c=this.tickLabelContainer.offsetHeight;else for(u=0;u<this.tickLabelContainer.childNodes.length;u++)this.tickLabelContainer.childNodes[u].offsetHeight>c&&(c=this.tickLabelContainer.childNodes[u].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=c+"px")}for(var u=0;u<this.options.ticks.length;u++){var p=this.options.ticks_positions[u]||this._toPercentage(this.options.ticks[u]);this.options.reversed&&(p=100-p),this.ticks[u].style[this.stylePos]=p+"%",this._removeClass(this.ticks[u],"in-selection"),this.options.range?p>=t[0]&&p<=t[1]&&this._addClass(this.ticks[u],"in-selection"):"after"===this.options.selection&&p>=t[0]?this._addClass(this.ticks[u],"in-selection"):"before"===this.options.selection&&p<=t[0]&&this._addClass(this.ticks[u],"in-selection"),this.tickLabels[u]&&(this.tickLabels[u].style[l]=h+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[u]?(this.tickLabels[u].style.position="absolute",this.tickLabels[u].style[this.stylePos]=p+"%",this.tickLabels[u].style[r]=-h/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[u].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[u].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[r]=this.sliderElem.offsetWidth/2*-1+"px"))}}if(this.options.range){e=this.options.formatter(this._state.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");var d=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,d);var g=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,g),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetWidth/2+"px")}else e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{"right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(t[0],t[1])+"%":this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var f=this.tooltip_min.getBoundingClientRect(),m=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?f.right>m.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):f.right>m.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?t>e?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var i=Math.abs(this._state.percentage[0]-e),s=Math.abs(this._state.percentage[1]-e);this._state.dragged=i<s?0:1,this._adjustPercentageForRangeSliders(e)}else this._state.dragged=0;this._state.percentage[this._state.dragged]=e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var n=this._calculateValue();return this._trigger("slideStart",n),this._setDataVal(n),this.setValue(n,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0];this.touchX=e.pageX,this.touchY=e.pageY}else this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var s="vertical"===this.options.orientation&&!this.options.reversed,n="horizontal"===this.options.orientation&&this.options.reversed;(s||n)&&(i=-i)}var o=this._state.value[t]+i*this.options.step,a=o/this.options.max*100;return this._state.keyCtrl=t,this.options.range&&(this._adjustPercentageForRangeSliders(a),o=[this._state.keyCtrl?this._state.value[0]:o,this._state.keyCtrl?o:this._state.value[1]]),this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!0,!0),this._setDataVal(o),this._trigger("slideStop",o),this._layout(),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this._state.percentage[this._state.dragged]=e,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_touchmove:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0],i=e.pageX-this.touchX,s=e.pageY-this.touchY;this._state.inDrag||("vertical"===this.options.orientation&&i<=5&&i>=-5&&(s>=15||s<=-15)?this._mousedown(t):s<=5&&s>=-5&&(i>=15||i<=-15)&&this._mousedown(t))}},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var e=this._getNumDigitsAfterDecimalPlace(t);e=e?e-1:0;var i=this._applyToFixedAndParseFloat(t,e);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._state.value[1]/this.options.max*100<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._state.value[0]/this.options.max*100>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus())}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,!1===this._state.over&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var e;if(this.options.range?(e=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(e[0]=this._toValue(this._state.percentage[0]),e[0]=this._applyPrecision(e[0])),100!==this._state.percentage[1]&&(e[1]=this._toValue(this._state.percentage[1]),e[1]=this._applyPrecision(e[1]))):(e=this._toValue(this._state.percentage[0]),e=parseFloat(e),e=this._applyPrecision(e)),t){for(var i=[e,1/0],s=0;s<this.options.ticks.length;s++){var n=Math.abs(this.options.ticks[s]-e);n<=i[1]&&(i=[this.options.ticks[s],n])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return e},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var i=t.toFixed(e);return parseFloat(i)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(e=-e);var i=e/this._state.size*100;return i=Math.round(i/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(i=100-i),Math.max(0,Math.min(100,i))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(i(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var s=t[e];if("number"!=typeof s)throw new Error(i(s))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(e,i){i=i||0===i?i:void 0;var s=this.eventToCallbackMap[e];if(s&&s.length)for(var n=0;n<s.length;n++)(0,s[n])(i);t&&this._triggerJQueryEvent(e,i)},_triggerJQueryEvent:function(t,e){var i={type:t,value:e};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),s=t.className,n=0;n<i.length;n++){var o=i[n],a=new RegExp("(?:\\s|^)"+o+"(?:\\s|$)");s=s.replace(a," ")}t.className=s.trim()},_addClass:function(t,e){for(var i=e.split(" "),s=t.className,n=0;n<i.length;n++){var o=i[n];new RegExp("(?:\\s|^)"+o+"(?:\\s|$)").test(s)||(s+=" "+o)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(e,i,s){if(t)t.style(e,i,s);else{var n=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}));e.style[n]=s}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var e,i="left"===(e=this.options.tooltip_position?this.options.tooltip_position:this.options.rtl?"left":"right")?"right":"left";t.forEach(function(t){this._addClass(t,e),t.style[i]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t&&t.fn){var o=void 0;t.fn.slider?(r&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),o="bootstrapSlider"):(t.bridget("slider",e),o="slider"),t.bridget("bootstrapSlider",e),t((function(){t("input[data-provide=slider]")[o]()}))}}(t),e})?s.apply(e,n):s)||(t.exports=o)},4656:function(t,e,i){},4657:function(t,e,i){},4658:function(t,e,i){},4659:function(t,e,i){"use strict";i.d(e,"b",(function(){return E})),i.d(e,"a",(function(){return S}));var s=i(0),n=i.n(s),o=i(2),a=i.n(o),r=i(134),l=i(4647),h=i(917),c=i(4648),u=i(4661),p=i(4665),d=i(4646),g=i(4643),f=i(4640);function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const{getScale:_}=h.b;const y={formData:a.a.object.isRequired,mapboxApiKey:a.a.string.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,getLayer:a.a.func.isRequired,getPoints:a.a.func.isRequired,payload:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class b extends n.a.PureComponent{constructor(t){super(t),v(this,"containerRef",n.a.createRef()),v(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)}),this.state=this.getStateFromProps(t),this.getLayers=this.getLayers.bind(this),this.onValuesChange=this.onValuesChange.bind(this),this.toggleCategory=this.toggleCategory.bind(this),this.showSingleCategory=this.showSingleCategory.bind(this)}UNSAFE_componentWillReceiveProps(t){t.payload.form_data!==this.state.formData&&this.setState(m({},this.getStateFromProps(t)))}onValuesChange(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}getStateFromProps(t,e){const i=t.payload.data.features||[],s=i.map(t=>t.__timestamp),n=function(t,e){const i=t.color_picker||{r:0,g:0,b:0,a:1},s=[i.r,i.g,i.b,255*i.a],n=_(t.color_scheme),o={};return e.forEach(e=>{if(null!=e.cat_color&&!o.hasOwnProperty(e.cat_color)){let a;a=t.dimension?Object(p.hexToRGB)(n(e.cat_color),255*i.a):s,o[e.cat_color]={color:a,enabled:!0}}}),o}(t.formData,i);if(e&&t.payload.form_data===e.formData)return m({},e,{categories:n});const o=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||"P1D",{start:a,end:r,getStep:l,values:h,disabled:c}=Object(d.a)(s,o),{width:u,height:g,formData:v}=t;let{viewport:y}=t;return v.autozoom&&(y=Object(f.a)(y,{width:u,height:g,points:t.getPoints(i)})),y.zoom<0&&(y.zoom=0),{start:a,end:r,getStep:l,values:h,disabled:c,viewport:y,selected:[],lastClick:0,formData:t.payload.form_data,categories:n}}getLayers(t){const{getLayer:e,payload:i,formData:s,onAddFilter:n}=this.props;let o=i.data.features?[...i.data.features]:[];if(o=this.addColor(o,s),s.js_data_mutator){o=Object(g.a)(s.js_data_mutator)(o)}o=t[0]===t[1]||t[1]===this.end?o.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<=t[1]):o.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<t[1]);const a=this.state.categories;return s.dimension&&(o=o.filter(t=>a[t.cat_color]&&a[t.cat_color].enabled)),[e(s,m({},i,{data:m({},i.data,{features:o})}),n,this.setTooltip)]}addColor(t,e){const i=e.color_picker||{r:0,g:0,b:0,a:1},s=_(e.color_scheme);return t.map(t=>{let n;return e.dimension?(n=Object(p.hexToRGB)(s(t.cat_color),255*i.a),m({},t,{color:n})):t})}toggleCategory(t){const e=this.state.categories[t],i=m({},this.state.categories,{[t]:m({},e,{enabled:!e.enabled})});Object.values(i).every(t=>!t.enabled)&&Object.values(i).forEach(t=>{t.enabled=!0}),this.setState({categories:i})}showSingleCategory(t){const e=m({},this.state.categories);Object.values(e).forEach(t=>{t.enabled=!1}),e[t].enabled=!0,this.setState({categories:e})}render(){return n.a.createElement("div",{style:{position:"relative"}},n.a.createElement(c.a,{ref:this.containerRef,getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,disabled:this.state.disabled,viewport:this.state.viewport,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue,width:this.props.width,height:this.props.height},n.a.createElement(u.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))}}function C(){return(C=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}b.propTypes=y;const x={formData:a.a.object.isRequired,payload:a.a.object.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired},k={onAddFilter(){}};function E(t,e){class i extends n.a.PureComponent{constructor(t){super(t),w(this,"containerRef",n.a.createRef()),w(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)});const{width:i,height:s,formData:o}=t;let{viewport:a}=t;o.autozoom&&(a=Object(f.a)(a,{width:i,height:s,points:e(t.payload.data.features)})),this.state={viewport:a,layer:this.computeLayer(t)},this.onViewportChange=this.onViewportChange.bind(this)}UNSAFE_componentWillReceiveProps(t){const e=C({},t.formData,{viewport:null}),i=C({},this.props.formData,{viewport:null});Object(r.isEqual)(e,i)&&t.payload===this.props.payload||this.setState({layer:this.computeLayer(t)})}onViewportChange(t){this.setState({viewport:t})}computeLayer(e){const{formData:i,payload:s,onAddFilter:n}=e;return t(i,s,n,this.setTooltip)}render(){const{formData:t,payload:e,setControlValue:i,height:s,width:o}=this.props,{layer:a,viewport:r}=this.state;return n.a.createElement(l.a,{ref:this.containerRef,mapboxApiAccessToken:e.data.mapboxApiKey,viewport:r,layers:[a],mapStyle:t.mapbox_style,setControlValue:i,width:o,height:s,onViewportChange:this.onViewportChange})}}return i.propTypes=x,i.defaultProps=k,i}function S(t,e){function i(i){const{formData:s,payload:o,setControlValue:a,viewport:r,width:l,height:h}=i;return n.a.createElement(b,{formData:s,mapboxApiKey:o.data.mapboxApiKey,setControlValue:a,viewport:r,getLayer:t,payload:o,getPoints:e,width:l,height:h})}return i.propTypes=x,i.defaultProps=k,i}},4661:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(0),n=i.n(s),o=i(2),a=i.n(o),r=i(302);i(4662);const l={categories:a.a.object,toggleCategory:a.a.func,showSingleCategory:a.a.func,format:a.a.string,position:a.a.oneOf([null,"tl","tr","bl","br"])};class h extends n.a.PureComponent{format(t){if(!this.props.format)return t;const e=parseFloat(t);return Object(r.b)(this.props.format,e)}formatCategoryLabel(t){if(!this.props.format)return t;if(t.includes(" - ")){const e=t.split(" - ");return this.format(e[0])+" - "+this.format(e[1])}return this.format(t)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const t=Object.entries(this.props.categories).map(t=>{let[e,i]=t;const s={color:"rgba("+i.color.join(", ")+")"},o=i.enabled?"◼":"◻";return n.a.createElement("li",{key:e},n.a.createElement("a",{href:"#",onClick:()=>this.props.toggleCategory(e),onDoubleClick:()=>this.props.showSingleCategory(e)},n.a.createElement("span",{style:s},o)," ",this.formatCategoryLabel(e)))}),e={position:"absolute",["t"===this.props.position.charAt(0)?"top":"bottom"]:"0px",["r"===this.props.position.charAt(1)?"right":"left"]:"10px"};return n.a.createElement("div",{className:"legend",style:e},n.a.createElement("ul",{className:"categories"},t))}}h.propTypes=l,h.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:"tr"}},4662:function(t,e,i){},4663:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return n}));const s=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function n(t,e=!1,i=Float32Array){let s;if(Number.isFinite(t[0]))s=new i(t);else{s=new i(4*t.length);let e=0;for(let i=0;i<t.length;i++){const n=t[i];s[e++]=n[0],s[e++]=n[1],s[e++]=n[2],s[e++]=Number.isFinite(n[3])?n[3]:255}}if(e)for(let t=0;t<s.length;t++)s[t]/=255;return s}},4673:function(t,e,i){"use strict";i.d(e,"c",(function(){return d})),i.d(e,"b",(function(){return g})),i.d(e,"a",(function(){return f})),i.d(e,"d",(function(){return m}));var s=i(4653);function n(t,e,i){const s=i;return s.domain=()=>t,s.range=()=>e,s}function o(t,e){return n(t,e,i=>function(t,e,i){const n=t[1]-t[0];if(n<=0)return s.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const o=n/e.length,a=Math.floor((i-t[0])/o),r=Math.max(Math.min(a,e.length-1),0);return e[r]}(t,e,i))}function a(t,e){return n(t,e,i=>function(t,e,i){return(i-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}(t,e,i))}function r(t,e){const i=t.sort(l);let s=0;const o=Math.max(1,e.length),a=new Array(o-1);for(;++s<o;)a[s-1]=h(i,s/o);const r=t=>function(t,e,i){return e[function(t,e){let i=0,s=t.length;for(;i<s;){const n=i+s>>>1;l(t[n],e)>0?s=n:i=n+1}return i}(t,i)]}(a,e,t);return r.thresholds=()=>a,n(t,e,r)}function l(t,e){return t-e}function h(t,e){const i=t.length;if(e<=0||i<2)return t[0];if(e>=1)return t[i-1];const s=(i-1)*e,n=Math.floor(s),o=t[n];return o+(t[n+1]-o)*(s-n)}function c(t,e){const i=new Map,s=[];for(const e of t){const t="".concat(e);i.has(t)||i.set(t,s.push(e))}return n(t,e,t=>function(t,e,i,s){const n="".concat(s);let o=e.get(n);return void 0===o&&(o=t.push(s),e.set(n,o)),i[(o-1)%i.length]}(s,i,e,t))}function u(t){return null!=t}function p(t,e){return("function"==typeof e?t.map(e):t).filter(u)}function d(t,e){return p(t,e)}function g(t,e){return function(t){const e=[];return t.forEach(t=>{!e.includes(t)&&u(t)&&e.push(t)}),e}(p(t,e))}function f(t,e,i){return Math.max(e,Math.min(i,t))}function m(t){switch(t){case"quantize":return o;case"linear":return a;case"quantile":return r;case"ordinal":return c;default:return o}}},4674:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var s=i(4723),n=i(4875),o=i(4993),a=i(4636);function r(t,e){const i={};for(const s in t)e.includes(s)||(i[s]=t[s]);return i}class l extends s.a{initializeState(t){super.initializeState(),this.setState({ignoreProps:r(this.constructor._propTypes,t.data.props),dimensions:t})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){const t=this.getShaders({});t&&t.defines&&(t.defines.NON_INSTANCED_MODEL=1),this.updateShaders(t)}this._updateAttributes(t.props)}updateAttributes(t){this.setState({changedAttributes:t})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:t,mousePosition:e,gl:i}=this.context;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:e,pickingActive:0,devicePixelRatio:Object(a.e)(i)})}updateShaders(t){}isAggregationDirty(t,e={}){const{props:i,oldProps:s,changeFlags:o}=t,{compareAll:a=!1,dimension:r}=e,{ignoreProps:l}=this.state,{props:h,accessors:c=[]}=r,{updateTriggersChanged:u}=o;if(o.dataChanged)return!0;if(u){if(u.all)return!0;for(const t of c)if(u[t])return!0}if(a)return!!o.extensionsChanged||Object(n.a)({oldProps:s,newProps:i,ignoreProps:l,propTypes:this.constructor._propTypes});for(const t of h)if(i[t]!==s[t])return!0;return!1}isAttributeChanged(t){const{changedAttributes:e}=this.state;return t?e&&void 0!==e[t]:!function(t){let e=!0;for(const i in t){e=!1;break}return e}(e)}_getAttributeManager(){return new o.a(this.context.gl,{id:this.props.id,stats:this.context.stats})}}l.layerName="AggregationLayer"},4680:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(4673);const n=t=>t.length,o=t=>t.points,a=t=>t.index,r=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,l={getValue:n,getPoints:o,getIndex:a,filterData:null};class h{constructor(t=[],e=l){this.aggregatedBins=this.getAggregatedBins(t,e),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(t,e){const{getValue:i=n,getPoints:s=o,getIndex:r=a,filterData:l}=e,h="function"==typeof l,c=t.length,u=[];let p=0;for(let e=0;e<c;e++){const n=t[e],o=s(n),a=r(n),c=h?o.filter(l):o;n.filteredPoints=h?c:null;const d=c.length?i(c):null;null!=d&&(u[p]={i:Number.isFinite(a)?a:e,value:d,counts:c.length},p++)}return u}_percentileToIndex(t){const e=this.sortedBins.length;if(e<2)return[0,0];const[i,n]=t.map(t=>Object(s.a)(t,0,100));return[Math.ceil(i/100*(e-1)),Math.floor(n/100*(e-1))]}getBinMap(){const t={};for(const e of this.aggregatedBins)t[e.i]=e;return t}_updateMinMaxValues(){let t=0,e=0,i=3402823466e29,s=0;for(const n of this.aggregatedBins)t=t>n.counts?t:n.counts,e=e>n.value?e:n.value,i=i<n.value?i:n.value,s+=n.counts;this.maxCount=t,this.maxValue=e,this.minValue=i,this.totalCount=s}getValueRange(t){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((t,e)=>r(t.value,e.value))),!this.sortedBins.length)return[];let e=0,i=this.sortedBins.length-1;if(Array.isArray(t)){const s=this._percentileToIndex(t);e=s[0],i=s[1]}return[this.sortedBins[e].value,this.sortedBins[i].value]}getValueDomainByScale(t,[e=0,i=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((t,e)=>r(t.value,e.value))),!this.sortedBins.length)return[];const s=this._percentileToIndex([e,i]);return this._getScaleDomain(t,s)}_getScaleDomain(t,[e,i]){const n=this.sortedBins;switch(t){case"quantize":case"linear":return[n[e].value,n[i].value];case"quantile":return Object(s.c)(n.slice(e,i+1),t=>t.value);case"ordinal":return Object(s.b)(n,t=>t.value);default:return[n[e].value,n[i].value]}}}},4714:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i(4680),n=i(4673),o=i(4652);function a(){}const r=["getBins","getDomain","getScaleFunc"],l=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],h=t=>t.cellSize;class c{constructor(t){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=t.getCellSize||h,this._getAggregator=t.getAggregator,this._addDimension(t.dimensions||l)}static defaultDimensions(){return l}updateState(t,e){const{oldProps:i,props:s,changeFlags:n}=t;this.updateGetValueFuncs(i,s,n);const o=this.needsReProjectPoints(i,s,n);let a=!1;if(n.dataChanged||o)this.getAggregatedData(s,e),a=!0;else{(this.getDimensionChanges(i,s,n)||[]).forEach(t=>"function"==typeof t&&t()),a=!0}return this.setState({aggregationDirty:a}),this.state}setState(t){this.state={...this.state,...t}}setDimensionState(t,e){this.setState({dimensions:{...this.state.dimensions,[t]:{...this.state.dimensions[t],...e}}})}normalizeResult(t={}){return t.hexagons?{data:t.hexagons,...t}:t.layerData?{data:t.layerData,...t}:t}getAggregatedData(t,e){const i=this._getAggregator(t)(t,e);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(t)}updateGetValueFuncs(t,e,i){for(const s in this.dimensionUpdaters){const{value:n,weight:a,aggregation:r}=this.dimensionUpdaters[s].getBins.triggers;let l=e[n.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[s].getBins,t,e,i)&&(l=l?Object(o.c)(l,{data:e.data}):Object(o.b)(e[r.prop],e[a.prop],{data:e.data})),l&&this.setDimensionState(s,{getValue:l})}}needsReProjectPoints(t,e,i){return this._getCellSize(t)!==this._getCellSize(e)||this._getAggregator(t)!==this._getAggregator(e)||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPosition)}addDimension(t){this._addDimension(t)}_addDimension(t=[]){t.forEach(t=>{const{key:e}=t;this.dimensionUpdaters[e]=this.getDimensionUpdaters(t),this.state.dimensions[e]={getValue:null,domain:null,sortedBins:null,scaleFunc:a}})}getDimensionUpdaters({key:t,accessor:e,pickingInfo:i,getBins:s,getDomain:n,getScaleFunc:o,nullValue:a}){return{key:t,accessor:e,pickingInfo:i,getBins:{updater:this.getDimensionSortedBins,...s},getDomain:{updater:this.getDimensionValueDomain,...n},getScaleFunc:{updater:this.getDimensionScale,...o},attributeAccessor:this.getSubLayerDimensionAttribute(t,a)}}needUpdateDimensionStep(t,e,i,s){return Object.values(t.triggers).some(t=>t.updateTrigger?s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged[t.updateTrigger]):e[t.prop]!==i[t.prop])}getDimensionChanges(t,e,i){const s=[];for(const n in this.dimensionUpdaters){const o=r.find(s=>this.needUpdateDimensionStep(this.dimensionUpdaters[n][s],t,e,i));o&&s.push(this.dimensionUpdaters[n][o].updater.bind(this,e,this.dimensionUpdaters[n]))}return s.length?s:null}getUpdateTriggers(t){const e=t.updateTriggers||{},i={};for(const s in this.dimensionUpdaters){const{accessor:n}=this.dimensionUpdaters[s];i[n]={},r.forEach(o=>{Object.values(this.dimensionUpdaters[s][o].triggers).forEach(({prop:s,updateTrigger:o})=>{if(o){const t=e[o];"object"!=typeof t||Array.isArray(t)?void 0!==t&&(i[n][s]=t):Object.assign(i[n],t)}else i[n][s]=t[s]})})}return i}getSortedBins(t){for(const e in this.dimensionUpdaters)this.getDimensionSortedBins(t,this.dimensionUpdaters[e])}getDimensionSortedBins(t,e){const{key:i}=e,{getValue:n}=this.state.dimensions[i],o=new s.a(this.state.layerData.data||[],{getValue:n,filterData:t._filterData});this.setDimensionState(i,{sortedBins:o}),this.getDimensionValueDomain(t,e)}getDimensionValueDomain(t,e){const{getDomain:i,key:s}=e,{triggers:{lowerPercentile:n,upperPercentile:o,scaleType:a}}=i,r=this.state.dimensions[s].sortedBins.getValueDomainByScale(t[a.prop],[t[n.prop],t[o.prop]]);this.setDimensionState(s,{valueDomain:r}),this.getDimensionScale(t,e)}getDimensionScale(t,e){const{key:i,getScaleFunc:s,getDomain:o}=e,{domain:a,range:r}=s.triggers,{scaleType:l}=o.triggers,{onSet:h}=s,c=t[r.prop],u=t[a.prop]||this.state.dimensions[i].valueDomain,p=Object(n.d)(l&&t[l.prop])(u,c);"object"==typeof h&&"function"==typeof t[h.props]&&t[h.props](p.domain()),this.setDimensionState(i,{scaleFunc:p})}getSubLayerDimensionAttribute(t,e){return i=>{const{sortedBins:s,scaleFunc:n}=this.state.dimensions[t],o=s.binMap[i.index];if(o&&0===o.counts)return e;const a=o&&o.value,r=n.domain();return a>=r[0]&&a<=r[r.length-1]?n(a):e}}getSubLayerAccessors(t){const e={};for(const i in this.dimensionUpdaters){const{accessor:s}=this.dimensionUpdaters[i];e[s]=this.getSubLayerDimensionAttribute(t,i)}return e}getPickingInfo({info:t}){let e=null;if(t.picked&&t.index>-1){const i=this.state.layerData.data[t.index],s={};for(const t in this.dimensionUpdaters){const{pickingInfo:e}=this.dimensionUpdaters[t],{sortedBins:n}=this.state.dimensions[t],o=n.binMap[i.index]&&n.binMap[i.index].value;s[e]=o}e=Object.assign(s,i,{points:i.filteredPoints||i.points})}return t.picked=Boolean(e),t.object=e,t}getAccessor(t){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].attributeAccessor:a}}},4723:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(4717),n=i(4667),o=i(4678);class a extends s.a{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){const{_subLayerProps:i}=this.props;return e&&e.length||i&&i[t]}getSubLayerClass(t,e){const{_subLayerProps:i}=this.props;return i&&i[t]&&i[t].type||e}getSubLayerRow(t,e,i){return t.__source={parent:this,object:e,index:i},t}getSubLayerAccessor(t){if("function"==typeof t){const e={data:this.props.data,target:[]};return(i,s)=>i&&i.__source?(e.index=i.__source.index,t(i.__source.object,e)):t(i,s)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:r,highlightColor:l,coordinateSystem:h,coordinateOrigin:c,wrapLongitude:u,positionFormat:p,modelMatrix:d,extensions:g,fetch:f,_subLayerProps:m}=this.props,v={opacity:e,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:r,highlightColor:l,coordinateSystem:h,coordinateOrigin:c,wrapLongitude:u,positionFormat:p,modelMatrix:d,extensions:g,fetch:f},_=m&&m[t.id],y=_&&_.updateTriggers,b=t.id||"sublayer";if(_){const e=this.constructor._propTypes,i=t.type?t.type._propTypes:{};for(const t in _){const s=i[t]||e[t];s&&"accessor"===s.type&&(_[t]=this.getSubLayerAccessor(_[t]))}}Object.assign(v,t,_),v.id="".concat(this.props.id,"-").concat(b),v.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,...y};for(const t of g){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(v,e,{updateTriggers:Object.assign(v.updateTriggers,e.updateTriggers)})}return v}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=Object(o.b)(t,Boolean),this.internalState.subLayers=t),Object(n.a)("compositeLayer.renderLayers",this,e,t);for(const e of t)e.parent=this}}a.layerName="CompositeLayer"},4738:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var s=i(4717),n=i(4802),o=i(4739),a=i(4837),r=i(4992),l=i(4653),h=i(4803),c=i(5015),u=i(4645);class p extends h.a{constructor(t={}){const{id:e=Object(c.c)("column-geometry")}=t,{indices:i,attributes:s}=function(t){const{radius:e,height:i=1,nradial:s=10}=t;let{vertices:n}=t;n&&(l.a.assert(n.length>=s),n=n.flatMap(t=>[t[0],t[1]]),Object(u.f)(n,u.a.COUNTER_CLOCKWISE));const o=i>0,a=s+1,r=o?3*a+1:s,h=2*Math.PI/s,c=new Uint16Array(o?3*s*2:0),p=new Float32Array(3*r),d=new Float32Array(3*r);let g=0;if(o){for(let t=0;t<a;t++){const o=t*h,a=t%s,r=Math.sin(o),l=Math.cos(o);for(let t=0;t<2;t++)p[g+0]=n?n[2*a]:l*e,p[g+1]=n?n[2*a+1]:r*e,p[g+2]=(.5-t)*i,d[g+0]=n?n[2*a]:l,d[g+1]=n?n[2*a+1]:r,g+=3}p[g+0]=p[g-3],p[g+1]=p[g-2],p[g+2]=p[g-1],g+=3}for(let t=o?0:1;t<a;t++){const o=Math.floor(t/2)*Math.sign(.5-t%2),a=o*h,r=(o+s)%s,l=Math.sin(a),c=Math.cos(a);p[g+0]=n?n[2*r]:c*e,p[g+1]=n?n[2*r+1]:l*e,p[g+2]=i/2,d[g+2]=1,g+=3}if(o){let t=0;for(let e=0;e<s;e++)c[t++]=2*e+0,c[t++]=2*e+2,c[t++]=2*e+0,c[t++]=2*e+1,c[t++]=2*e+1,c[t++]=2*e+3}return{indices:c,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:d}}}}(t);super({...t,id:e,indices:i,attributes:s})}}const d=[0,0,0,255],g={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:d},getLineColor:{type:"accessor",value:d},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class f extends s.a{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio -= sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec3 pos = vec3(project_size(rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[n.a,o.a,a.a]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:d},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:d},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState({props:t,oldProps:e,changeFlags:i}){super.updateState({props:t,oldProps:e,changeFlags:i});const s=i.extensionsChanged;if(s){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(s||t.diskResolution!==e.diskResolution||t.vertices!==e.vertices||(t.extruded||t.stroked)!==(e.extruded||e.stroked))&&this._updateGeometry(t)}getGeometry(t,e,i){const s=new p({radius:1,height:i?2:0,vertices:e,nradial:t});let n=0;if(e)for(let i=0;i<t;i++){const s=e[i];n+=Math.sqrt(s[0]*s[0]+s[1]*s[1])/t}else n=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*n}),s}_getModel(t){return new r.a(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:i,stroked:s}){const n=this.getGeometry(t,e,i||s);this.setState({fillVertexCount:n.attributes.POSITION.value.length/3,wireframeVertexCount:n.indices.value.length}),this.state.model.setProps({geometry:n})}draw({uniforms:t}){const{viewport:e}=this.context,{lineWidthUnits:i,lineWidthScale:s,lineWidthMinPixels:n,lineWidthMaxPixels:o,elevationScale:a,extruded:r,filled:l,stroked:h,wireframe:c,offset:u,coverage:p,radius:d,angle:g}=this.props,{model:f,fillVertexCount:m,wireframeVertexCount:v,edgeDistance:_}=this.state,y="pixels"===i?e.metersPerPixel:1;f.setUniforms(t).setUniforms({radius:d,angle:g/180*Math.PI,offset:u,extruded:r,coverage:p,elevationScale:a,edgeDistance:_,widthScale:s*y,widthMinPixels:n,widthMaxPixels:o}),r&&c&&(f.setProps({isIndexed:!0}),f.setVertexCount(v).setDrawMode(1).setUniforms({isStroke:!0}).draw()),l&&(f.setProps({isIndexed:!1}),f.setVertexCount(m).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!r&&h&&(f.setProps({isIndexed:!1}),f.setVertexCount(2*m/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}f.layerName="ColumnLayer",f.defaultProps=g},4739:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";const n={lightSources:{}};function o({color:t=[0,0,0],intensity:e=1}={}){return t.map(t=>t*e/255)}const a={name:"lights",vs:s,fs:s,getUniforms:function t(e=n){if("lightSources"in e){const{ambientLight:t,pointLights:i,directionalLights:s}=e.lightSources||{};return t||i&&i.length>0||s&&s.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:i=[]}){const s={};return s["lighting_uAmbientLight.color"]=t?o(t):[0,0,0],e.forEach((t,e)=>{s["lighting_uPointLight[".concat(e,"].color")]=o(t),s["lighting_uPointLight[".concat(e,"].position")]=t.position,s["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]}),s.lighting_uPointLightCount=e.length,i.forEach((t,e)=>{s["lighting_uDirectionalLight[".concat(e,"].color")]=o(t),s["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction}),s.lighting_uDirectionalLightCount=i.length,s}({ambientLight:t,pointLights:i,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const i={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":i.ambientLight=t;break;case"directional":i.directionalLights.push(t);break;case"point":i.pointLights.push(t)}return t({lightSources:i})}return{}},defines:{MAX_LIGHTS:3}};var r="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";const l={};function h(t=l){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:i=.6,shininess:s=32,specularColor:n=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:i,lighting_uShininess:s,lighting_uSpecularColor:n.map(t=>t/255)}}(e):{lighting_uEnabled:!1}}const c={name:"gouraud-lighting",dependencies:[a],vs:r,defines:{LIGHTING_VERTEX:1},getUniforms:h}},4831:function(t,e,i){"use strict";i.r(e),i.d(e,"getLayer",(function(){return E}));var s=i(4653),n=i(4738),o=i(4663),a=Math.PI/3,r=[0,a,2*a,3*a,4*a,5*a];function l(t){return t[0]}function h(t){return t[1]}var c=i(4692);var u=i(4714),p=i(4674);function d(){}const g={colorDomain:null,colorRange:o.b,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:d,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:d,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){const{data:i,radius:n}=t,{viewport:o,attributes:u}=e,p=i.length?function(t,e){const{attributes:i}=e,s=i.positions.value,{size:n}=i.positions.getAccessor();let o,a=1/0,r=1/0,l=-1/0,h=-1/0;for(o=0;o<n*t.length;o+=n){const t=s[o],e=s[o+1];Number.isFinite(t)&&Number.isFinite(e)&&(a=Math.min(t,a),l=Math.max(t,l),r=Math.min(e,r),h=Math.max(e,h))}return[a,r,l,h].every(Number.isFinite)?[(a+l)/2,(r+h)/2]:null}(i,e):null,d=function(t,e,i){const{unitsPerMeter:s}=e.getDistanceScales(i);return t*s[0]}(n,o,p),g=[],{iterable:f,objectInfo:m}=Object(c.a)(i),v=u.positions.value,{size:_}=u.positions.getAccessor();for(const t of f){m.index++;const e=m.index*_,i=[v[e],v[e+1]];Number.isFinite(i[0])&&Number.isFinite(i[1])?g.push({screenCoord:o.projectFlat(i),source:t,index:m.index}):s.a.warn("HexagonLayer: invalid position")()}return{hexagons:function(){var t,e,i,s=0,n=0,o=1,c=1,u=l,p=h;function d(t){var s,n={},o=[],a=t.length;for(s=0;s<a;++s)if(!isNaN(l=+u.call(null,r=t[s],s,t))&&!isNaN(h=+p.call(null,r,s,t))){var r,l,h,c=Math.round(h/=i),d=Math.round(l=l/e-(1&c)/2),g=h-c;if(3*Math.abs(g)>1){var f=l-d,m=d+(l<d?-1:1)/2,v=c+(h<c?-1:1),_=l-m,y=h-v;f*f+g*g>_*_+y*y&&(d=m+(1&c?1:-1)/2,c=v)}var b=d+"-"+c,C=n[b];C?C.push(r):(o.push(C=n[b]=[r]),C.x=(d+(1&c)/2)*e,C.y=c*i)}return o}function g(t){var e=0,i=0;return r.map((function(s){var n=Math.sin(s)*t,o=-Math.cos(s)*t,a=n-e,r=o-i;return e=n,i=o,[a,r]}))}return d.hexagon=function(e){return"m"+g(null==e?t:+e).join("l")+"z"},d.centers=function(){for(var a=[],r=Math.round(n/i),l=Math.round(s/e),h=r*i;h<c+t;h+=i,++r)for(var u=l*e+(1&r)*e/2;u<o+e/2;u+=e)a.push([u,h]);return a},d.mesh=function(){var e=g(t).slice(0,4).join("l");return d.centers().map((function(t){return"M"+t+"m"+e})).join("")},d.x=function(t){return arguments.length?(u=t,d):u},d.y=function(t){return arguments.length?(p=t,d):p},d.radius=function(s){return arguments.length?(e=2*(t=+s)*Math.sin(a),i=1.5*t,d):t},d.size=function(t){return arguments.length?(s=n=0,o=+t[0],c=+t[1],d):[o-s,c-n]},d.extent=function(t){return arguments.length?(s=+t[0][0],n=+t[0][1],o=+t[1][0],c=+t[1][1],d):[[s,n],[o,c]]},d.radius(1)}().radius(d).x(t=>t.screenCoord[0]).y(t=>t.screenCoord[1])(g).map((t,e)=>({position:o.unprojectFlat([t.x,t.y]),points:t,index:e})),radiusCommon:d}},getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class f extends p.a{shouldUpdateState({changeFlags:t}){return t.somethingChanged}initializeState(){const t=new u.a({getAggregator:t=>t.hexagonAggregator,getCellSize:t=>t.radius});this.state={cpuAggregator:t,aggregatorState:t.state,hexagonVertices:null},this.getAttributeManager().add({positions:{size:3,accessor:"getPosition"}})}updateState(t){super.updateState(t);const{cpuAggregator:e,hexagonVertices:i}=this.state;t.changeFlags.propsOrDataChanged&&this.setState({aggregatorState:e.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes()})});const{hexagonVertices:s}=e.state.layerData||{};if(s&&i!==s){const t=this.convertLatLngToMeterOffset(s);t&&this.setState({hexagonVertices:s,vertices:t})}else this.updateRadiusAngle()}updateRadiusAngle(t){const{viewport:e}=this.context,{unitsPerMeter:i}=e.getDistanceScales(),{cpuAggregator:s}=this.state;if(s.state.layerData&&s.state.layerData.radiusCommon){const{radiusCommon:t}=s.state.layerData,e=t/i[0];this.setState({angle:90,radius:e})}}convertLatLngToMeterOffset(t){const{viewport:e}=this.context;if(Array.isArray(t)&&6===t.length){const i=t[0],s=t[3],n=[(i[0]+s[0])/2,(i[1]+s[1])/2],o=e.projectFlat(n),{metersPerUnit:a}=e.getDistanceScales(n);return t.map(t=>{const i=e.projectFlat(t);return[(i[0]-o[0])*a[0],(i[1]-o[1])*a[1]]})}return s.a.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,coverage:i,material:s,transitions:o}=this.props,{angle:a,radius:r,cpuAggregator:l,vertices:h}=this.state,c=this.getSubLayerClass("hexagon-cell",n.a),u=this._getSublayerUpdateTriggers();return new c({...h&&h.length?{vertices:h,radius:1}:{radius:r,angle:a},diskResolution:6,elevationScale:t,extruded:e,coverage:i,material:s,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:o&&{getFillColor:o.getColorValue||o.getColorWeight,getElevation:o.getElevationValue||o.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:u}),{data:l.state.layerData.data})}}f.layerName="HexagonLayer",f.defaultProps=g;var m=i(0),v=i.n(m),_=i(13),y=i(4650),b=i(4643),C=i(4659),w=i(4651);function x(){return(x=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function k(t){return v.a.createElement("div",{className:"deckgl-tooltip"},v.a.createElement(w.a,{label:Object(_.e)("Centroid (Longitude and Latitude)")+": ",value:"("+t.coordinate[0]+", "+t.coordinate[1]+")"}),v.a.createElement(w.a,{label:Object(_.e)("Height")+": ",value:""+t.object.elevationValue}))}function E(t,e,i,s){const n=t,o=n.color_picker;let a=e.data.features.map(t=>x({},t,{color:[o.r,o.g,o.b,255*o.a]}));if(n.js_data_mutator){a=Object(b.a)(n.js_data_mutator)(a)}const r=Object(y.b)(n.js_agg_function,t=>t.weight);return new f(x({id:"hex-layer-"+n.slice_id,data:a,pickable:!0,radius:n.grid_size,minColor:[0,0,0,0],extruded:n.extruded,maxColor:[o.r,o.g,o.b,255*o.a],outline:!1,getElevationValue:r,getColorValue:r},Object(y.a)(n,s,k)))}e.default=Object(C.b)(E,(function(t){return t.map(t=>t.position)}))}}]);