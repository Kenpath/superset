/*! For license information please see ac50ec01306d39366195.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1128:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(0);var r=n(1);var i={name:"1qbe4ct",styles:"& :nth-child(1):not(:nth-last-child(1)){border-top-right-radius:0;border-bottom-right-radius:0;border-right:0;margin-left:0;}& :not(:nth-child(1)):not(:nth-last-child(1)){border-radius:0;border-right:0;margin-left:0;}& :nth-last-child(1):not(:nth-child(1)){border-top-left-radius:0;border-bottom-left-radius:0;margin-left:0;}"};function a(e){const{className:t,children:n}=e;return Object(r.jsx)("div",{role:"group",className:t,css:i},n)}},1150:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return x}));var r=n(11),i=n.n(r),a=n(71),o=n.n(a),s=n(2),l=n.n(s),c=n(70),d=n(1686),u=n(1742);const h=l.a.shape({id:l.a.string.isRequired,type:l.a.oneOf(o()(c.m)).isRequired,parents:l.a.arrayOf(l.a.string),children:l.a.arrayOf(l.a.string),meta:l.a.shape({width:l.a.number,height:l.a.number,headerSize:l.a.oneOf(i()(u.a).call(u.a,e=>e.value)),background:l.a.oneOf(i()(d.a).call(d.a,e=>e.value)),chartId:l.a.number})}),p=l.a.shape({id:l.a.number.isRequired,chartAlert:l.a.string,chartStatus:l.a.string,chartUpdateEndTime:l.a.number,chartUpdateStartTime:l.a.number,latestQueryFormData:l.a.object,queryController:l.a.shape({abort:l.a.func}),queriesResponse:l.a.arrayOf(l.a.object),triggerQuery:l.a.bool,lastRendered:l.a.number}),f=l.a.shape({slice_id:l.a.number.isRequired,slice_url:l.a.string.isRequired,slice_name:l.a.string.isRequired,datasource:l.a.string,datasource_name:l.a.string,datasource_link:l.a.string,changed_on:l.a.number.isRequired,modified:l.a.string.isRequired,viz_type:l.a.string.isRequired,description:l.a.string,description_markeddown:l.a.string,owners:l.a.arrayOf(l.a.string)}),b=l.a.shape({chartId:l.a.number.isRequired,componentId:l.a.string.isRequired,filterName:l.a.string.isRequired,datasourceId:l.a.string.isRequired,directPathToFilter:l.a.arrayOf(l.a.string).isRequired,isDateFilter:l.a.bool.isRequired,isInstantFilter:l.a.bool.isRequired,columns:l.a.object,labels:l.a.object,scopes:l.a.object}),m=l.a.shape({sliceIds:l.a.arrayOf(l.a.number).isRequired,expandedSlices:l.a.object,editMode:l.a.bool,isPublished:l.a.bool.isRequired,colorNamespace:l.a.string,colorScheme:l.a.string,updatedColorScheme:l.a.bool,hasUnsavedChanges:l.a.bool}),g=l.a.shape({id:l.a.number.isRequired,metadata:l.a.object,slug:l.a.string,dash_edit_perm:l.a.bool.isRequired,dash_save_perm:l.a.bool.isRequired,common:l.a.object,userId:l.a.string.isRequired}),v=e=>()=>e().apply(void 0,arguments),j=l.a.shape({value:l.a.oneOfType([l.a.number,l.a.string]).isRequired,label:l.a.string.isRequired}),y={value:l.a.oneOfType([l.a.number,l.a.string]).isRequired,label:l.a.string.isRequired,children:l.a.arrayOf(l.a.oneOfType([l.a.shape(v(()=>y)),j]))},x=l.a.oneOfType([l.a.shape(y),j])},1587:function(e,t,n){"use strict";function r(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function i(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function a(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}function o(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,o=null,s=null;if("function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?o="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(o="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?s="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(s="UNSAFE_componentWillUpdate"),null!==n||null!==o||null!==s){var l=e.displayName||e.name,c="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+l+" uses "+c+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==o?"\n  "+o:"")+(null!==s?"\n  "+s:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=r,t.componentWillReceiveProps=i),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=a;var d=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;d.call(this,e,t,r)}}return e}n.r(t),n.d(t,"polyfill",(function(){return o})),r.__suppressDeprecationWarning=!0,i.__suppressDeprecationWarning=!0,a.__suppressDeprecationWarning=!0},1638:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(0);var r=n(2),i=n.n(r),a=n(13),o=n(302),s=n(123),l=n(51),c=n(1);const d={rowcount:i.a.number,limit:i.a.number,rows:i.a.string,suffix:i.a.string,loading:i.a.bool},u={suffix:Object(a.e)("rows")};function h({rowcount:e,limit:t,suffix:n,loading:r}){const i=e===t,d=i||0===e&&!r?"danger":"default",u=Object(o.c)()(e),h=Object(c.jsx)("span",null,i&&Object(c.jsx)("div",null,Object(a.e)("Limit reached")),r?"Loading":e);return Object(c.jsx)(l.a,{id:"tt-rowcount-tooltip",title:h},Object(c.jsx)(s.a,{type:d},r?"Loading...":`${u} ${n}`))}h.propTypes=d,h.defaultProps=u},1686:function(e,t,n){"use strict";var r=n(13),i=n(58);t.a=[{value:i.b,label:Object(r.e)("Transparent"),className:"background--transparent"},{value:i.c,label:Object(r.e)("White"),className:"background--white"}]},1742:function(e,t,n){"use strict";var r=n(13),i=n(58);t.a=[{value:i.E,label:Object(r.e)("Small"),className:"header-style-option header-small"},{value:i.s,label:Object(r.e)("Medium"),className:"header-style-option header-medium"},{value:i.r,label:Object(r.e)("Large"),className:"header-style-option header-large"}]},1745:function(e,t,n){"use strict";var r;function i(){return r||((r=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),r}n.d(t,"a",(function(){return i}))},1910:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r,i=n(0),a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return a(t,e),t.prototype.render=function(){return i.createElement("div",{className:this.props.className||"",style:o(o({position:"absolute",userSelect:"none"},s[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(i.PureComponent),c=n(957),d=n.n(c),u=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},p={width:"auto",height:"auto"},f=d()((function(e,t,n){return Math.max(Math.min(e,n),t)})),b=d()((function(e,t){return Math.round(e/t)*t})),m=d()((function(e,t){return new RegExp(e,"i").test(t)})),g=function(e){return Boolean(e.touches&&e.touches.length)},v=d()((function(e,t,n){void 0===n&&(n=0);var r=t.reduce((function(n,r,i){return Math.abs(r-e)<Math.abs(t[n]-e)?i:n}),0),i=Math.abs(t[r]-e);return 0===n||i<n?t[r]:e})),j=d()((function(e,t){return e.substr(e.length-t.length,t.length)===t})),y=d()((function(e){return"auto"===(e=e.toString())?e:j(e,"px")?e:j(e,"%")?e:j(e,"vh")?e:j(e,"vw")?e:j(e,"vmax")?e:j(e,"vmin")?e:e+"px"})),x=function(e,t,n,r){if(e&&"string"==typeof e){if(j(e,"px"))return Number(e.replace("px",""));if(j(e,"%"))return t*(Number(e.replace("%",""))/100);if(j(e,"vw"))return n*(Number(e.replace("vw",""))/100);if(j(e,"vh"))return r*(Number(e.replace("vh",""))/100)}return e},O=d()((function(e,t,n,r,i,a,o){return r=x(r,e.width,t,n),i=x(i,e.height,t,n),a=x(a,e.width,t,n),o=x(o,e.height,t,n),{maxWidth:void 0===r?void 0:Number(r),maxHeight:void 0===i?void 0:Number(i),minWidth:void 0===a?void 0:Number(a),minHeight:void 0===o?void 0:Number(o)}})),C=["as","style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],S=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableTop=0,n.targetLeft=0,n.targetTop=0,n.appendBase=function(){if(!n.resizable||!n.window)return null;var e=n.parentNode;if(!e)return null;var t=n.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0",t.classList?t.classList.add("__resizable_base__"):t.className+="__resizable_base__",e.appendChild(t),t},n.removeBase=function(e){var t=n.parentNode;t&&t.removeChild(e)},n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return u(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,r=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:r,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&j(e.propsSize[t].toString(),"%")){if(j(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return y(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?y(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?y(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,n=this.parentNode.style.flexWrap;"wrap"!==n&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%";var r={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=n),this.removeBase(e),r},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var n=this.parentNode;if(n){var r=n.offsetWidth+(this.parentLeft-this.resizableLeft),i=n.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<r?e:r,t=t&&t<i?t:i}}else if("window"===this.props.bounds){if(this.window){r=this.window.innerWidth-this.resizableLeft,i=this.window.innerHeight-this.resizableTop;e=e&&e<r?e:r,t=t&&t<i?t:i}}else if(this.props.bounds){r=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop);e=e&&e<r?e:r,t=t&&t<i?t:i}return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,r=this.props.resizeRatio||1,i=this.state,a=i.direction,o=i.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,d=s.lockAspectRatioExtraWidth,u=o.width,h=o.height,p=c||0,f=d||0;return m("right",a)&&(u=o.width+(e-o.x)*r/n,l&&(h=(u-f)/this.ratio+p)),m("left",a)&&(u=o.width-(e-o.x)*r/n,l&&(h=(u-f)/this.ratio+p)),m("bottom",a)&&(h=o.height+(t-o.y)*r/n,l&&(u=(h-p)*this.ratio+f)),m("top",a)&&(h=o.height-(t-o.y)*r/n,l&&(u=(h-p)*this.ratio+f)),{newWidth:u,newHeight:h}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,r){var i=this.props,a=i.lockAspectRatio,o=i.lockAspectRatioExtraHeight,s=i.lockAspectRatioExtraWidth,l=void 0===r.width?10:r.width,c=void 0===n.width||n.width<0?e:n.width,d=void 0===r.height?10:r.height,u=void 0===n.height||n.height<0?t:n.height,h=o||0,p=s||0;if(a){var b=(d-h)*this.ratio+p,m=(u-h)*this.ratio+p,g=(l-p)/this.ratio+h,v=(c-p)/this.ratio+h,j=Math.max(l,b),y=Math.min(c,m),x=Math.max(d,g),O=Math.min(u,v);e=f(e,j,y),t=f(t,x,O)}else e=f(e,l,c),t=f(t,d,u);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var r=this.resizable.getBoundingClientRect(),i=r.left,a=r.top;this.resizableLeft=i,this.resizableTop=a}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,r=0,i=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)){if(r=e.nativeEvent.clientX,i=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent&&g(e.nativeEvent)&&(r=e.nativeEvent.touches[0].clientX,i=e.nativeEvent.touches[0].clientY);if(this.props.onResizeStart)if(this.resizable)if(!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var a=this.window.getComputedStyle(this.resizable);if("auto"!==a.flexBasis){var o=this.parentNode;if(o){var s=this.window.getComputedStyle(o).flexDirection;this.flexDir=s.startsWith("row")?"row":"column",n=a.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:r,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:h(h({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(l)}},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&g(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var t=this.props,n=t.maxWidth,r=t.maxHeight,i=t.minWidth,a=t.minHeight,o=g(e)?e.touches[0].clientX:e.clientX,s=g(e)?e.touches[0].clientY:e.clientY,l=this.state,c=l.direction,d=l.original,u=l.width,h=l.height,p=this.getParentSize(),f=O(p,this.window.innerWidth,this.window.innerHeight,n,r,i,a);n=f.maxWidth,r=f.maxHeight,i=f.minWidth,a=f.minHeight;var m=this.calculateNewSizeFromDirection(o,s),y=m.newHeight,x=m.newWidth,C=this.calculateNewMaxFromBoundary(n,r),S=this.calculateNewSizeFromAspectRatio(x,y,{width:C.maxWidth,height:C.maxHeight},{width:i,height:a});if(x=S.newWidth,y=S.newHeight,this.props.grid){var w=b(x,this.props.grid[0]),R=b(y,this.props.grid[1]),k=this.props.snapGap||0;x=0===k||Math.abs(w-x)<=k?w:x,y=0===k||Math.abs(R-y)<=k?R:y}this.props.snap&&this.props.snap.x&&(x=v(x,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(y=v(y,this.props.snap.y,this.props.snapGap));var T={width:x-d.width,height:y-d.height};if(u&&"string"==typeof u)if(j(u,"%"))x=x/p.width*100+"%";else if(j(u,"vw")){x=x/this.window.innerWidth*100+"vw"}else if(j(u,"vh")){x=x/this.window.innerHeight*100+"vh"}if(h&&"string"==typeof h)if(j(h,"%"))y=y/p.height*100+"%";else if(j(h,"vw")){y=y/this.window.innerWidth*100+"vw"}else if(j(h,"vh")){y=y/this.window.innerHeight*100+"vh"}var _={width:this.createSizeForCssProperty(x,"width"),height:this.createSizeForCssProperty(y,"height")};"row"===this.flexDir?_.flexBasis=_.width:"column"===this.flexDir&&(_.flexBasis=_.height),this.setState(_),this.props.onResize&&this.props.onResize(e,c,this.resizable,T)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,r=t.direction,i=t.original;if(n&&this.resizable){var a={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,r,this.resizable,a),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:h(h({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,r=t.handleStyles,a=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,c=t.handleComponent;if(!n)return null;var d=Object.keys(n).map((function(t){return!1!==n[t]?i.createElement(l,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:r&&r[t],className:a&&a[t]},c&&c[t]?c[t]:null):null}));return i.createElement("span",{className:s,style:o},d)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==C.indexOf(n)?t:(t[n]=e.props[n],t)}),{}),n=h(h(h({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return i.createElement(r,h({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&i.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(i.PureComponent)},1929:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n(41);var r=n(115),i=n.n(r),a=n(0),o=n(5),s=n.n(o),l=n(13),c=n(51),d=n(1);function u({canEdit:e=!1,editing:t=!1,extraClasses:n,multiLine:r=!1,noPermitTooltip:o,onSaveTitle:u,showTooltip:h=!0,style:p,title:f="",defaultTitle:b="",placeholder:m=""}){const[g,v]=Object(a.useState)(t),[j,y]=Object(a.useState)(f),[x,O]=Object(a.useState)(f),[C,S]=Object(a.useState)(null),w=Object(a.useRef)();function R(){if(!e||g)return;const t=w.current?w.current.getBoundingClientRect():null;v(!0),S(t)}function k(){const t=i()(j).call(j);e&&(v(!1),t.length?(x!==t&&O(t),f!==t&&u(t)):y(x))}function T(e){" "===e.key&&e.stopPropagation(),"Enter"===e.key&&(e.preventDefault(),k())}function _(t){e&&y(t.target.value)}function F(e){"Enter"===e.key&&(e.preventDefault(),k())}let E;Object(a.useEffect)(()=>{f!==j&&(O(j),y(f))},[f]),Object(a.useEffect)(()=>{if(g&&(w.current.focus(),w.current.setSelectionRange)){const{length:e}=w.current.value;w.current.setSelectionRange(e,e),w.current.scrollLeft=w.current.scrollWidth,w.current.scrollTop=w.current.scrollHeight}},[g]),E=j,g||j||(E=b||f);const M=g&&C?{height:`${C.height}px`}:void 0;let D=r&&g?Object(d.jsx)("textarea",{ref:w,value:E,className:f?void 0:"text-muted",onKeyDown:T,onChange:_,onBlur:k,onClick:R,onKeyPress:F,placeholder:m,style:M}):Object(d.jsx)("input",{ref:w,type:g?"text":"button",value:E,className:f?void 0:"text-muted",onKeyDown:T,onChange:_,onBlur:k,onClick:R,onKeyPress:F,placeholder:m});return h&&!g&&(D=Object(d.jsx)(c.a,{id:"title-tooltip",title:e?Object(l.e)("Click to edit"):o||Object(l.e)("You don't have the rights to alter this title.")},D)),e||(D=Object(d.jsx)("span",{title:E},E)),Object(d.jsx)("span",{className:s()("editable-title",n,e&&"editable-title--editable",g&&"editable-title--editing"),style:p},D)}},1930:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(2287)).default;t.default=i},1931:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(2288)).default;t.default=i},1932:function(e,t,n){"use strict";var r=n(8);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(2289)).default;t.default=i},1942:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={id:0,type:n(190).a.Table,uid:"_placeholder_",datasource_name:"",table_name:"",columns:[],column_types:[],metrics:[],column_format:{},verbose_map:{},main_dttm_col:"",description:""}},1945:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n(183);var r=n(32),i=n.n(r),a=n(1965),o=n.n(a),s=n(482),l=n.n(s),c=n(13),d=n(63);function u(e,t,n={},r=!1){return n=>{const a=r?document.querySelector(e):n.currentTarget.closest(e);if(!a)return Object(d.g)(Object(c.e)("Image download failed, please refresh and try again."));return o.a.toJpeg(a,{quality:.95,bgcolor:"#F5F5F5",filter:e=>{var t;return"string"!=typeof e.className||"mapboxgl-control-container"!==e.className&&!i()(t=e.className).call(t,"ant-dropdown")}}).then(e=>{const n=document.createElement("a");n.download=`${((e,t=new Date)=>`${l()(e)}-${t.toISOString().replace(/[: ]/g,"-")}`)(t)}.jpg`,n.href=e,n.click()}).catch(e=>{console.error("Creating image failed",e)})}}},1963:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));n(41);var r=n(1),i=n(39),a=n.n(i),o=n(0),s=n.n(o),l=n(91),c=n(40),d=n(13),u=n(31),h=n(1937),p=n(19),f=n(42),b=n(961);const m=e=>r.css`
  color: ${e.colors.error.base};
`;var g={name:"833hqy",styles:"width:200px"};function v({showReportModal:e,toggleActive:t,deleteActiveReport:n}){const i=Object(l.d)(e=>e.reports),v=i[a()(i)[0]],[j,y]=Object(o.useState)(null),x=Object(c.i)();return Object(f.c)(f.a.ALERT_REPORTS)?Object(r.jsx)(s.a.Fragment,null,Object(r.jsx)(p.s,{overlay:Object(r.jsx)(p.q,{selectable:!1,css:g},Object(r.jsx)(p.q.Item,null,Object(d.e)("Email reports active"),Object(r.jsx)(h.a,{checked:null==v?void 0:v.active,onClick:e=>(async(e,n)=>{null!=e&&e.id&&t(e,n)})(v,e),size:"small",css:Object(r.css)({marginLeft:2*x.gridUnit},"","")})),Object(r.jsx)(p.q.Item,{onClick:e},Object(d.e)("Edit email report")),Object(r.jsx)(p.q.Item,{onClick:()=>y(v),css:m},Object(d.e)("Delete email report"))),trigger:["click"],getPopupContainer:e=>e.closest(".action-button")},Object(r.jsx)("span",{role:"button",className:"action-button",tabIndex:0},Object(r.jsx)(u.a.Calendar,null))),j&&Object(r.jsx)(b.a,{description:Object(d.e)("This action will permanently delete %s.",j.name),onConfirm:()=>{j&&(e=>{n(e),y(null)})(j)},onHide:()=>y(null),open:!0,title:Object(d.e)("Delete Report?")})):null}},1964:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(41);var r=n(0),i=n(325);function a(e){const[t,n]=Object(r.useState)(!1),[a,o]=Object(r.useState)("");return Object(r.useEffect)(()=>n(!0),[e]),async function(){if(t){const t=await Object(i.a)(e);return o(t),n(!1),t}return a}}},1965:function(e,t,n){!function(t){"use strict";var n=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();return(r="application/font-woff",{woff:r,woff2:r,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[n]||"";var r},dataAsUrl:function(e,t){return"data:"+t+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise((function(t){e.toBlob(t)})):function(e){return new Promise((function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);t(new Blob([i],{type:"image/png"}))}))}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var i=n.createElement("a");return n.body.appendChild(i),r.href=t,i.href=e,i.href},getAndEncode:function(e){s.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new Promise((function(t){var n,r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4!==r.readyState)return;if(200!==r.status)return void(n?t(n):a("cannot fetch resource: "+e+", status: "+r.status));var i=new FileReader;i.onloadend=function(){var e=i.result.split(/,/)[1];t(e)},i.readAsDataURL(r.response)},r.ontimeout=function(){n?t(n):a("timeout of 30000ms occured while fetching resource: "+e)},r.responseType="blob",r.timeout=3e4,r.open("GET",e,!0),r.send(),s.impl.options.imagePlaceholder){var i=s.impl.options.imagePlaceholder.split(/,/);i&&i[1]&&(n=i[1])}function a(e){console.error(e),t("")}}))},uid:(e=0,function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}),delay:function(e){return function(t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e}))},width:function(e){var t=n(e,"border-left-width"),r=n(e,"border-right-width");return e.scrollWidth+t+r},height:function(e){var t=n(e,"border-top-width"),r=n(e,"border-bottom-width");return e.scrollHeight+t+r}};var e;function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function n(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}}(),r=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,n,a){return function(){return!t(e)}()?Promise.resolve(e):Promise.resolve(e).then(r).then((function(t){var r=Promise.resolve(e);return t.forEach((function(e){r=r.then((function(t){return i(t,e,n,a)}))})),r}))},shouldProcess:t,impl:{readUrls:r,inline:i}};function t(t){return-1!==t.search(e)}function r(t){for(var r,i=[];null!==(r=e.exec(t));)i.push(r[1]);return i.filter((function(e){return!n.isDataUrl(e)}))}function i(e,t,r,i){return Promise.resolve(t).then((function(e){return r?n.resolveUrl(e,r):e})).then(i||n.getAndEncode).then((function(e){return n.dataAsUrl(e,n.mimeType(t))})).then((function(r){return e.replace(function(e){return new RegExp("(url\\(['\"]?)("+n.escape(e)+")(['\"]?\\))","g")}(t),"$1"+r+"$3")}))}}(),i=function(){return{resolveAll:function(){return e(document).then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join("\n")}))},impl:{readAll:e}};function e(){return Promise.resolve(n.asArray(document.styleSheets)).then((function(e){var t=[];return e.forEach((function(e){try{n.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}})),t})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return r.shouldProcess(e.style.getPropertyValue("src"))}))})).then((function(t){return t.map(e)}));function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return r.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}}}(),a=function(){return{inlineAll:function t(i){return i instanceof Element?function(e){var t=e.style.getPropertyValue("background");return t?r.inlineAll(t).then((function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))})).then((function(){return e})):Promise.resolve(e)}(i).then((function(){return i instanceof HTMLImageElement?e(i).inline():Promise.all(n.asArray(i.childNodes).map((function(e){return t(e)})))})):Promise.resolve(i)},impl:{newImage:e}};function e(e){return{inline:function(t){return n.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||n.getAndEncode).then((function(t){return n.dataAsUrl(t,n.mimeType(e.src))})).then((function(t){return new Promise((function(n,r){e.onload=n,e.onerror=r,e.src=t}))}))}}}}(),o={imagePlaceholder:void 0,cacheBust:!1},s={toSvg:l,toPng:function(e,t){return c(e,t||{}).then((function(e){return e.toDataURL()}))},toJpeg:function(e,t){return c(e,t=t||{}).then((function(e){return e.toDataURL("image/jpeg",t.quality||1)}))},toBlob:function(e,t){return c(e,t||{}).then(n.canvasToBlob)},toPixelData:function(e,t){return c(e,t||{}).then((function(t){return t.getContext("2d").getImageData(0,0,n.width(e),n.height(e)).data}))},impl:{fontFaces:i,images:a,util:n,inliner:r,options:{}}};function l(e,t){return function(e){void 0===e.imagePlaceholder?s.impl.options.imagePlaceholder=o.imagePlaceholder:s.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?s.impl.options.cacheBust=o.cacheBust:s.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then((function(e){return function e(t,r,i){return i||!r||r(t)?Promise.resolve(t).then((function(e){return e instanceof HTMLCanvasElement?n.makeImage(e.toDataURL()):e.cloneNode(!1)})).then((function(e){return a(t,e,r)})).then((function(e){return function(e,t){return t instanceof Element?Promise.resolve().then(r).then(i).then(a).then(o).then((function(){return t})):t;function r(){var r,i;r=window.getComputedStyle(e),i=t.style,r.cssText?i.cssText=r.cssText:function(e,t){n.asArray(e).forEach((function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))}))}(r,i)}function i(){[":before",":after"].forEach((function(r){!function(r){var i=window.getComputedStyle(e,r),a=i.getPropertyValue("content");if(""===a||"none"===a)return;var o=n.uid();t.className=t.className+" "+o;var s=document.createElement("style");s.appendChild(function(e,t,r){var i="."+e+":"+t,a=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.asArray(e).map((function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")})).join("; ")+";"}(r);return document.createTextNode(i+"{"+a+"}")}(o,r,i)),t.appendChild(s)}(r)}))}function a(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function o(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach((function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)})))}}(t,e)})):Promise.resolve();function a(t,r,i){var a=t.childNodes;return 0===a.length?Promise.resolve(r):o(r,n.asArray(a),i).then((function(){return r}));function o(t,n,r){var i=Promise.resolve();return n.forEach((function(n){i=i.then((function(){return e(n,r)})).then((function(e){e&&t.appendChild(e)}))})),i}}}(e,t.filter,!0)})).then(d).then(u).then((function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.width&&(e.style.width=t.width+"px");t.height&&(e.style.height=t.height+"px");t.style&&Object.keys(t.style).forEach((function(n){e.style[n]=t.style[n]}));return e})).then((function(r){return function(e,t,r){return Promise.resolve(e).then((function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)})).then(n.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+e+"</svg>"})).then((function(e){return"data:image/svg+xml;charset=utf-8,"+e}))}(r,t.width||n.width(e),t.height||n.height(e))}))}function c(e,t){return l(e,t).then(n.makeImage).then(n.delay(100)).then((function(r){var i=function(e){var r=document.createElement("canvas");if(r.width=t.width||n.width(e),r.height=t.height||n.height(e),t.bgcolor){var i=r.getContext("2d");i.fillStyle=t.bgcolor,i.fillRect(0,0,r.width,r.height)}return r}(e);return i.getContext("2d").drawImage(r,0,0),i}))}function d(e){return i.resolveAll().then((function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e}))}function u(e){return a.inlineAll(e).then((function(){return e}))}e.exports=s}()},1966:function(e,t,n){"use strict";n(41);var r=n(11),i=n.n(r),a=n(64),o=n.n(a),s=n(0),l=n.n(s),c=n(40),d=n(230),u=n(13),h=n(359),p=n.n(h),f=n(524),b=n.n(f),m=n(221),g=n(171),v=n(664),j=n(65),y=n(125),x=n(1930),O=n.n(x),C=n(1931),S=n.n(C),w=n(641),R=n.n(w),k=n(1932),T=n.n(k),_=n(1);const F=Object(c.g)(v.a)`
  && {
    margin: 0 0 ${({theme:e})=>e.gridUnit}px;
  }
`;p.a.registerLanguage("markdown",O.a),p.a.registerLanguage("html",S.a),p.a.registerLanguage("sql",R.a),p.a.registerLanguage("json",T.a);t.a=e=>{const[t,n]=Object(s.useState)([]),[r,a]=Object(s.useState)(!1),[c,h]=Object(s.useState)(null);return Object(s.useEffect)(()=>{var t;t="query",a(!0),Object(y.getChartDataRequest)({formData:e.latestQueryFormData,resultFormat:"json",resultType:t}).then(({json:e})=>{n(Object(d.a)(e.result)),a(!1),h(null)}).catch(e=>{Object(j.a)(e).then(({error:t,message:n})=>{h(t||n||e.statusText||Object(u.e)("Sorry, An error occurred")),a(!1)})})},[o()(e.latestQueryFormData)]),r?Object(_.jsx)(g.a,null):c?Object(_.jsx)("pre",null,c):Object(_.jsx)(l.a.Fragment,null,i()(t).call(t,e=>e.query?Object(_.jsx)("div",null,Object(_.jsx)(m.a,{text:e.query,shouldShowText:!1,copyNode:Object(_.jsx)(F,{buttonSize:"xsmall"},Object(_.jsx)("i",{className:"fa fa-clipboard"}))}),Object(_.jsx)(p.a,{language:e.language||void 0,style:b.a},e.query)):null))}},1969:function(e,t,n){"use strict";var r=n(91),i=n(77),a=n(125),o=n(440),s=n(11),l=n.n(s),c=n(23),d=n.n(c),u=n(2),h=n.n(u),p=n(0),f=n.n(p),b=n(213),m=n(40),g=n(195),v=n(13),j=n(42),y=n(1942),x=n(45),O=n(171),C=n(380),S=(n(41),n(57)),w=n.n(S),R=n(156),k=n.n(R),T=n(2189),_=n.n(T),F=n(918),E=n(287),M=n(214),D=n(1);const P={annotationData:h.a.object,actions:h.a.object,chartId:h.a.number.isRequired,datasource:h.a.object,initialValues:h.a.object,formData:h.a.object.isRequired,height:h.a.number,width:h.a.number,setControlValue:h.a.func,vizType:h.a.string.isRequired,triggerRender:h.a.bool,chartAlert:h.a.string,chartStatus:h.a.string,queriesResponse:h.a.arrayOf(h.a.object),triggerQuery:h.a.bool,refreshOverlayVisible:h.a.bool,addFilter:h.a.func,setDataMask:h.a.func,onFilterMenuOpen:h.a.func,onFilterMenuClose:h.a.func,ownState:h.a.object},I={},N={addFilter:()=>I,onFilterMenuOpen:()=>I,onFilterMenuClose:()=>I,initialValues:I,setControlValue(){},triggerRender:!1};class q extends f.a.Component{constructor(e){var t,n,r,i;super(e),this.hasQueryResponseChange=!1,this.handleAddFilter=d()(t=this.handleAddFilter).call(t,this),this.handleRenderSuccess=d()(n=this.handleRenderSuccess).call(n,this),this.handleRenderFailure=d()(r=this.handleRenderFailure).call(r,this),this.handleSetControlValue=d()(i=this.handleSetControlValue).call(i,this),this.hooks={onAddFilter:this.handleAddFilter,onError:this.handleRenderFailure,setControlValue:this.handleSetControlValue,onFilterMenuOpen:this.props.onFilterMenuOpen,onFilterMenuClose:this.props.onFilterMenuClose,setDataMask:e=>{var t;null==(t=this.props.actions)||t.updateDataMask(this.props.chartId,e)}}}shouldComponentUpdate(e){var t,n,r;return!(!(e.queriesResponse&&w()(t=["success","rendered"]).call(t,e.chartStatus)>-1)||null!=(n=e.queriesResponse)&&null!=(r=n[0])&&r.error||e.refreshOverlayVisible)&&(this.hasQueryResponseChange=e.queriesResponse!==this.props.queriesResponse,this.hasQueryResponseChange||!k()(e.datasource,this.props.datasource)||e.annotationData!==this.props.annotationData||e.ownState!==this.props.ownState||e.filterState!==this.props.filterState||e.height!==this.props.height||e.width!==this.props.width||e.triggerRender||e.formData.color_scheme!==this.props.formData.color_scheme||e.cacheBusterProp!==this.props.cacheBusterProp)}handleAddFilter(e,t,n=!0,r=!0){this.props.addFilter(e,t,n,r)}handleRenderSuccess(){var e;const{actions:t,chartStatus:n,chartId:r,vizType:i}=this.props;w()(e=["loading","rendered"]).call(e,n)<0&&t.chartRenderingSucceeded(r),this.hasQueryResponseChange&&t.logEvent(M.m,{slice_id:r,viz_type:i,start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:M.q.getTimestamp()-this.renderStartTime})}handleRenderFailure(e,t){const{actions:n,chartId:r}=this.props;g.a.warn(e),n.chartRenderingFailed(e.toString(),r,t?t.componentStack:null),this.hasQueryResponseChange&&n.logEvent(M.m,{slice_id:r,has_err:!0,error_details:e.toString(),start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:M.q.getTimestamp()-this.renderStartTime})}handleSetControlValue(...e){const{setControlValue:t}=this.props;t&&t(...e)}render(){const{chartAlert:e,chartStatus:t,vizType:n,chartId:r,refreshOverlayVisible:i}=this.props;if(i||"loading"===t||e||null===t)return null;this.renderStartTime=M.q.getTimestamp();const{width:a,height:o,datasource:s,annotationData:l,initialValues:c,ownState:d,filterState:u,formData:h,queriesResponse:p}=this.props,f=_()(n),b="table"===n?`superset-chart-${f}`:f;return Object(D.jsx)(F.a,{disableErrorBoundary:!0,key:`${r}`,id:`chart-id-${r}`,className:b,chartType:n,width:a,height:o,annotationData:l,datasource:s,initialValues:c,formData:h,ownState:d,filterState:u,hooks:this.hooks,behaviors:[E.b.INTERACTIVE_CHART],queriesData:p,onRenderSuccess:this.handleRenderSuccess,onRenderFailure:this.handleRenderFailure})}}q.propTypes=P,q.defaultProps=N;var z=q,A=n(25),U=n.n(A),$=n(1959),L=n(647);const V=({chartId:e,error:t,...n})=>{const{result:r}=Object($.a)(e),i=t&&{...t,extra:{...t.extra,owners:r}};return Object(D.jsx)(L.a,U()({},n,{error:i}))},H={annotationData:h.a.object,actions:h.a.object,chartId:h.a.number.isRequired,datasource:h.a.object,dashboardId:h.a.number,initialValues:h.a.object,formData:h.a.object.isRequired,width:h.a.number,height:h.a.number,setControlValue:h.a.func,timeout:h.a.number,vizType:h.a.string.isRequired,triggerRender:h.a.bool,isFiltersInitialized:h.a.bool,chartAlert:h.a.string,chartStatus:h.a.string,chartStackTrace:h.a.string,queriesResponse:h.a.arrayOf(h.a.object),triggerQuery:h.a.bool,refreshOverlayVisible:h.a.bool,errorMessage:h.a.node,addFilter:h.a.func,onQuery:h.a.func,onFilterMenuOpen:h.a.func,onFilterMenuClose:h.a.func,ownState:h.a.object},B={},W={addFilter:()=>B,onFilterMenuOpen:()=>B,onFilterMenuClose:()=>B,initialValues:B,setControlValue(){},triggerRender:!1,dashboardId:null,chartStackTrace:null},G=m.g.div`
  min-height: ${e=>e.height}px;
  position: relative;

  .chart-tooltip {
    opacity: 0.75;
    font-size: ${({theme:e})=>e.typography.sizes.s}px;
  }
`,K=m.g.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`;class Q extends f.a.PureComponent{constructor(e){var t;super(e),this.handleRenderContainerFailure=d()(t=this.handleRenderContainerFailure).call(t,this)}componentDidMount(){this.props.triggerQuery&&this.runQuery()}componentDidUpdate(){this.props.triggerQuery&&this.runQuery()}runQuery(){this.props.chartId>0&&Object(j.c)(j.a.CLIENT_CACHE)?this.props.actions.getSavedChart(this.props.formData,!1,this.props.timeout,this.props.chartId,this.props.dashboardId,this.props.ownState):this.props.actions.postChartFormData(this.props.formData,!1,this.props.timeout,this.props.chartId,this.props.dashboardId,this.props.ownState)}handleRenderContainerFailure(e,t){const{actions:n,chartId:r}=this.props;g.a.warn(e),n.chartRenderingFailed(e.toString(),r,t?t.componentStack:null),n.logEvent(M.m,{slice_id:r,has_err:!0,error_details:e.toString(),start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:M.q.getTimestamp()-this.renderStartTime})}renderErrorMessage(e){var t;const{chartId:n,chartAlert:r,chartStackTrace:i,datasource:a,dashboardId:o,height:s}=this.props,l=null==e?void 0:null==(t=e.errors)?void 0:t[0],c=r||(null==e?void 0:e.message);return r&&a===y.a?Object(D.jsx)(G,{"data-ui-anchor":"chart",className:"chart-container",height:s},Object(D.jsx)(O.a,null)):Object(D.jsx)(V,{chartId:n,error:l,subtitle:c,copyText:c,link:e?e.link:null,source:o?"dashboard":"explore",stackTrace:i})}render(){const{height:e,chartAlert:t,chartStatus:n,errorMessage:r,onQuery:i,refreshOverlayVisible:a,queriesResponse:o=[]}=this.props,s="loading"===n,c=a&&!r;return this.renderContainerStartTime=M.q.getTimestamp(),"failed"===n?l()(o).call(o,e=>this.renderErrorMessage(e)):r?Object(D.jsx)(b.a,{message:r,type:"warning"}):Object(D.jsx)(C.a,{onError:this.handleRenderContainerFailure,showMessage:!1},Object(D.jsx)(G,{"data-ui-anchor":"chart",className:"chart-container",height:e},Object(D.jsx)("div",{className:`slice_container ${c?" faded":""}`},Object(D.jsx)(z,this.props)),!s&&!t&&c&&Object(D.jsx)(K,null,Object(D.jsx)(x.a,{onClick:i,buttonStyle:"primary"},Object(v.e)("Run query"))),s&&Object(D.jsx)(O.a,null)))}}Q.propTypes=H,Q.defaultProps=W;var Y=Q,X=n(313);t.a=Object(r.b)(null,(function(e){return{actions:Object(i.b)({...a,updateDataMask:X.h,logEvent:o.logEvent},e)}}))(Y)},1971:function(e,t,n){"use strict";n(41);var r=n(32),i=n.n(r),a=n(39),o=n.n(a),s=n(0),l=n.n(s),c=n(13),d=n(77),u=n(91),h=n(372),p=n(1943),f=n(467),b=n(31),m=n(142),g=n(40),v=n(1),j=n(114),y=n(45),x=n(199),O=n(1944);const C=Object(g.g)(j.b)`
  .ant-modal-body {
    padding: 0;
  }

  h4 {
    font-weight: 600;
  }
`,S=g.g.div`
  padding: ${({theme:e})=>`${3*e.gridUnit}px ${4*e.gridUnit}px ${2*e.gridUnit}px`};
  label {
    font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }
`,w=g.g.div`
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  padding: ${({theme:e})=>`${4*e.gridUnit}px ${4*e.gridUnit}px ${6*e.gridUnit}px`};
  .ant-select {
    width: 100%;
  }
  .control-label {
    font-size: ${({theme:e})=>e.typography.sizes.s-1}px;
    color: ${({theme:e})=>e.colors.grayscale.light1};
  }
`,R=g.g.span`
  span {
    margin-right: ${({theme:e})=>2*e.gridUnit}px;
    vertical-align: middle;
  }
  .text {
    vertical-align: middle;
  }
`,k=g.g.div`
  margin-bottom: ${({theme:e})=>7*e.gridUnit}px;

  h4 {
    margin-bottom: ${({theme:e})=>3*e.gridUnit}px;
  }
`,T=Object(g.g)(O.CronPicker)`
  margin-bottom: ${({theme:e})=>3*e.gridUnit}px;
`,_=g.g.p`
  color: ${({theme:e})=>e.colors.error.base};
`,F=v.css`
  margin-bottom: 0;
`,E=Object(g.g)(y.a)`
  width: ${({theme:e})=>40*e.gridUnit}px;
`,M=g.g.div`
  margin: ${({theme:e})=>8*e.gridUnit}px 0
    ${({theme:e})=>4*e.gridUnit}px;
`,D=Object(g.g)(x.a)`
  display: block;
  line-height: ${({theme:e})=>8*e.gridUnit}px;
`,P=Object(g.g)(x.a.Group)`
  margin-left: ${({theme:e})=>.5*e.gridUnit}px;
`;var I;!function(e){e[e.inputChange=0]="inputChange",e[e.fetched=1]="fetched",e[e.reset=2]="reset"}(I||(I={}));const N=["pivot_table","pivot_table_v2","table","paired_ttest"],q=(e,t)=>{const n={name:(null==e?void 0:e.name)||"Weekly Report",report_format:(null==e?void 0:e.report_format)||"TEXT",...e||{}};switch(t.type){case I.inputChange:return{...n,[t.payload.name]:t.payload.value};case I.fetched:return{...t.payload};case I.reset:return null;default:return e}};t.a=Object(u.b)(null,e=>Object(d.b)({addReport:h.d,editReport:h.f},e))(Object(m.a)(({onReportAdd:e,onHide:t,show:n=!1,...r})=>{var a,d;const m=null==(a=r.props.chart)?void 0:null==(d=a.sliceFormData)?void 0:d.viz_type,[g,j]=Object(s.useReducer)(q,null),y=Object(s.useCallback)((e,t)=>{j({type:e,payload:t})},[]),[x,O]=Object(s.useState)(),z=Object(u.c)(),A=Object(u.d)(e=>e.reports),U=A&&o()(A).length;Object(s.useEffect)(()=>{if(U){const e=o()(A),t=A[e[0]];j({type:I.fetched,payload:t})}else j({type:I.reset})},[A]);const $=()=>{t()},L=Object(v.jsx)(R,null,Object(v.jsx)(b.a.Calendar,null),Object(v.jsx)("span",{className:"text"},U?Object(c.e)("Edit Email Report"):Object(c.e)("New Email Report"))),V=Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(E,{key:"back",onClick:$},Object(c.e)("Cancel")),Object(v.jsx)(E,{key:"submit",buttonStyle:"primary",onClick:async()=>{var t;const n={crontab:null==g?void 0:g.crontab,dashboard:r.props.dashboardId,chart:null==(t=r.props.chart)?void 0:t.id,description:null==g?void 0:g.description,name:null==g?void 0:g.name,owners:[r.props.userId],recipients:[{recipient_config_json:{target:r.props.userEmail},type:"Email"}],type:"Report",creation_method:r.props.creationMethod,active:!0,report_format:null==g?void 0:g.report_format};U?await z(Object(h.f)(null==g?void 0:g.id,n)):await z(Object(h.d)(n)),e&&e(),$()},disabled:!(null!=g&&g.name)},U?Object(c.e)("Save"):Object(c.e)("Add"))),H=Object(v.jsx)(l.a.Fragment,null,Object(v.jsx)(M,null,Object(v.jsx)("h4",null,Object(c.e)("Message Content"))),Object(v.jsx)("div",{className:"inline-container"},Object(v.jsx)(P,{onChange:e=>{y(I.inputChange,{name:"report_format",value:e.target.value})},value:(null==g?void 0:g.report_format)||"TEXT"},i()(N).call(N,m)&&Object(v.jsx)(D,{value:"TEXT"},Object(c.e)("Text embedded in email")),Object(v.jsx)(D,{value:"PNG"},Object(c.e)("Image (PNG) embedded in email")),Object(v.jsx)(D,{value:"CSV"},Object(c.e)("Formatted CSV attached in email")))));return Object(v.jsx)(C,{show:n,onHide:$,title:L,footer:V,width:"432",centered:!0},Object(v.jsx)(S,null,Object(v.jsx)(f.a,{id:"name",name:"name",value:(null==g?void 0:g.name)||"",placeholder:"Weekly Report",required:!0,validationMethods:{onChange:({target:e})=>y(I.inputChange,{name:e.name,value:e.value})},errorMessage:"error"===(null==g?void 0:g.name)?Object(c.e)("REPORT NAME ERROR"):"",label:"Report Name"}),Object(v.jsx)(f.a,{id:"description",name:"description",value:(null==g?void 0:g.description)||"",validationMethods:{onChange:({target:e})=>y(I.inputChange,{name:e.name,value:e.value})},errorMessage:"error"===(null==g?void 0:g.description)?Object(c.e)("DESCRIPTION ERROR"):"",label:"Description",placeholder:"Include a description that will be sent with your report",css:F})),Object(v.jsx)(w,null,Object(v.jsx)(k,null,Object(v.jsx)("h4",{css:e=>(e=>v.css`
  margin: ${3*e.gridUnit}px 0;
  font-weight: ${e.typography.weights.bold};
`)(e)},Object(c.e)("Schedule")),Object(v.jsx)("p",null,Object(c.e)("Scheduled reports will be sent to your email as a PNG"))),Object(v.jsx)(T,{clearButton:!1,value:(null==g?void 0:g.crontab)||"0 12 * * 1",setValue:e=>{y(I.inputChange,{name:"crontab",value:e})},onError:O}),Object(v.jsx)(_,null,x),Object(v.jsx)("div",{className:"control-label",css:e=>(e=>v.css`
  margin: ${3*e.gridUnit}px 0 ${2*e.gridUnit}px;
`)(e)},Object(c.e)("Timezone")),Object(v.jsx)(p.a,{onTimezoneChange:e=>{j({type:I.inputChange,payload:{name:"timezone",value:e}})},timezone:null==g?void 0:g.timezone}),r.props.chart&&H))}))},2210:function(e,t,n){"use strict";var r=n(8);t.__esModule=!0,t.default=function(e){if((!i&&0!==i||e)&&a.default){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),i=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return i};var i,a=r(n(2294));e.exports=t.default},2287:function(e,t){e.exports=function(e){const t={begin:"<",end:">",subLanguage:"xml",relevance:0},n={begin:"\\[.+?\\][\\(\\[].*?[\\)\\]]",returnBegin:!0,contains:[{className:"string",begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0,relevance:0},{className:"link",begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}],relevance:10},r={className:"strong",contains:[],variants:[{begin:/_{2}/,end:/_{2}/},{begin:/\*{2}/,end:/\*{2}/}]},i={className:"emphasis",contains:[],variants:[{begin:/\*(?!\*)/,end:/\*/},{begin:/_(?!_)/,end:/_/,relevance:0}]};r.contains.push(i),i.contains.push(r);var a=[t,n];return r.contains=r.contains.concat(a),i.contains=i.contains.concat(a),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:a=a.concat(r,i)},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:a}]}]},t,{className:"bullet",begin:"^[ \t]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},r,i,{className:"quote",begin:"^>\\s+",contains:a,end:"$"},{className:"code",variants:[{begin:"(`{3,})(.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})(.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},n,{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]}]}}},2288:function(e,t){function n(...e){return e.map(e=>{return(t=e)?"string"==typeof t?t:t.source:null;var t}).join("")}e.exports=function(e){const t=function(e){const t={"builtin-name":["action","bindattr","collection","component","concat","debugger","each","each-in","get","hash","if","in","input","link-to","loc","log","lookup","mut","outlet","partial","query-params","render","template","textarea","unbound","unless","view","with","yield"].join(" ")},r={literal:["true","false","undefined","null"].join(" ")},i=/\[.*?\]/,a=/[^\s!"#%&'()*+,.\/;<=>@\[\\\]^`{|}~]+/,o=n("(",/'.*?'/,"|",/".*?"/,"|",i,"|",a,"|",/\.|\//,")+"),s=n("(",i,"|",a,")(?==)"),l={begin:o,lexemes:/[\w.\/]+/},c=e.inherit(l,{keywords:r}),d={begin:/\(/,end:/\)/},u={className:"attr",begin:s,relevance:0,starts:{begin:/=/,end:/=/,starts:{contains:[e.NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,c,d]}}},h={contains:[e.NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{begin:/as\s+\|/,keywords:{keyword:"as"},end:/\|/,contains:[{begin:/\w+/}]},u,c,d],returnEnd:!0},p=e.inherit(l,{className:"name",keywords:t,starts:e.inherit(h,{end:/\)/})});d.contains=[p];const f=e.inherit(l,{keywords:t,className:"name",starts:e.inherit(h,{end:/}}/})}),b=e.inherit(l,{keywords:t,className:"name"}),m=e.inherit(l,{className:"name",keywords:t,starts:e.inherit(h,{end:/}}/})});return{name:"Handlebars",aliases:["hbs","html.hbs","html.handlebars","htmlbars"],case_insensitive:!0,subLanguage:"xml",contains:[{begin:/\\\{\{/,skip:!0},{begin:/\\\\(?=\{\{)/,skip:!0},e.COMMENT(/\{\{!--/,/--\}\}/),e.COMMENT(/\{\{!/,/\}\}/),{className:"template-tag",begin:/\{\{\{\{(?!\/)/,end:/\}\}\}\}/,contains:[f],starts:{end:/\{\{\{\{\//,returnEnd:!0,subLanguage:"xml"}},{className:"template-tag",begin:/\{\{\{\{\//,end:/\}\}\}\}/,contains:[b]},{className:"template-tag",begin:/\{\{#/,end:/\}\}/,contains:[f]},{className:"template-tag",begin:/\{\{(?=else\}\})/,end:/\}\}/,keywords:"else"},{className:"template-tag",begin:/\{\{(?=else if)/,end:/\}\}/,keywords:"else if"},{className:"template-tag",begin:/\{\{\//,end:/\}\}/,contains:[b]},{className:"template-variable",begin:/\{\{\{/,end:/\}\}\}/,contains:[m]},{className:"template-variable",begin:/\{\{/,end:/\}\}/,contains:[m]}]}}(e);return t.name="HTMLbars",e.getLanguage("handlebars")&&(t.disableAutodetect=!0),t}},2289:function(e,t){e.exports=function(e){var t={literal:"true false null"},n=[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],r=[e.QUOTE_STRING_MODE,e.C_NUMBER_MODE],i={end:",",endsWithParent:!0,excludeEnd:!0,contains:r,keywords:t},a={begin:"{",end:"}",contains:[{className:"attr",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE],illegal:"\\n"},e.inherit(i,{begin:/:/})].concat(n),illegal:"\\S"},o={begin:"\\[",end:"\\]",contains:[e.inherit(i)],illegal:"\\S"};return r.push(a,o),n.forEach((function(e){r.push(e)})),{name:"JSON",contains:r,keywords:t,illegal:"\\S"}}},2294:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=!("undefined"==typeof window||!window.document||!window.document.createElement);t.default=r,e.exports=t.default},4758:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(1289),i=n(0);function a(e){var t=Object(i.useState)(e),n=t[1];return[t[0],Object(i.useCallback)((function(e){n(Object(r.a)(e))}),[])]}function o(e,t,n){var a=Object(i.useMemo)((function(){return Object(r.a)(e)}),[e]);return Object(i.useReducer)(a,t,n)}},4828:function(e,t,n){var r;window,e.exports=(r=n(0),function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){e.exports=n(96)()},function(e,t){e.exports=r},function(e,t,n){var r=n(16),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();e.exports=a},function(e,t,n){var r=n(41),i=n(47);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(31),i=n(32),a=n(33),o=n(34),s=n(35);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,n){var r=n(14);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(12),i=n(43),a=n(44),o=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):a(e)}},function(e,t,n){var r=n(3)(Object,"create");e.exports=r},function(e,t,n){var r=n(56);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var o=i.apply(null,r);o&&e.push(o)}else if("object"===a)for(var s in r)n.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r=n(3)(n(2),"Map");e.exports=r},function(e,t,n){var r=n(2).Symbol;e.exports=r},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(6),i=n(17);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(42))},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(48),i=n(55),a=n(57),o=n(58),s=n(59);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,n){var r=n(60),i=n(63),a=n(64);e.exports=function(e,t,n,o,s,l){var c=1&n,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var h=l.get(e);if(h&&l.get(t))return h==t;var p=-1,f=!0,b=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++p<d;){var m=e[p],g=t[p];if(o)var v=c?o(g,m,p,t,e,l):o(m,g,p,e,t,l);if(void 0!==v){if(v)continue;f=!1;break}if(b){if(!i(t,(function(e,t){if(!a(b,t)&&(m===e||s(m,e,n,o,l)))return b.push(t)}))){f=!1;break}}else if(m!==g&&!s(m,g,n,o,l)){f=!1;break}}return l.delete(e),l.delete(t),f}},function(e,t,n){(function(e){var r=n(2),i=n(81),a=t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;e.exports=l}).call(this,n(22)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(83),i=n(84),a=n(85),o=a&&a.isTypedArray,s=o?i(o):r;e.exports=s},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){var r=n(28);e.exports=function(e,t){return r(e,t)}},function(e,t,n){var r=self.crypto||self.msCrypto;e.exports=function(e){e=e||21;for(var t="",n=r.getRandomValues(new Uint8Array(e));0<e--;)t+="Uint8ArdomValuesObj012345679BCDEFGHIJKLMNPQRSTWXYZ_cfghkpqvwxyz-"[63&n[e]];return t}},function(e,t,n){e.exports=n(98).default},function(e,t,n){var r=n(29),i=n(9);e.exports=function e(t,n,a,o,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,a,o,e,s))}},function(e,t,n){var r=n(30),i=n(20),a=n(65),o=n(69),s=n(91),l=n(13),c=n(21),d=n(23),u="[object Arguments]",h="[object Array]",p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,b,m,g){var v=l(e),j=l(t),y=v?h:s(e),x=j?h:s(t),O=(y=y==u?p:y)==p,C=(x=x==u?p:x)==p,S=y==x;if(S&&c(e)){if(!c(t))return!1;v=!0,O=!1}if(S&&!O)return g||(g=new r),v||d(e)?i(e,t,n,b,m,g):a(e,t,y,n,b,m,g);if(!(1&n)){var w=O&&f.call(e,"__wrapped__"),R=C&&f.call(t,"__wrapped__");if(w||R){var k=w?e.value():e,T=R?t.value():t;return g||(g=new r),m(k,T,n,b,g)}}return!!S&&(g||(g=new r),o(e,t,n,b,m,g))}},function(e,t,n){var r=n(4),i=n(36),a=n(37),o=n(38),s=n(39),l=n(40);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=a,c.prototype.get=o,c.prototype.has=s,c.prototype.set=l,e.exports=c},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(5),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():i.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(5);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(5);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(5);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(4);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(4),i=n(11),a=n(19);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!i||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(o)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(15),i=n(45),a=n(17),o=n(18),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,h=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(r(e)?h:s).test(o(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(12),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=o.call(e);return r&&(t?e[s]=n:delete e[s]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,i=n(46),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},function(e,t,n){var r=n(2)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(49),i=n(4),a=n(11);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},function(e,t,n){var r=n(50),i=n(51),a=n(52),o=n(53),s=n(54);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,n){var r=n(7);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(7),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(7),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(7);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(8);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(8);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(8);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(8);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(19),i=n(61),a=n(62);function o(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(12),i=n(66),a=n(14),o=n(20),s=n(67),l=n(68),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,u,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var f=1&r;if(p||(p=l),e.size!=t.size&&!f)return!1;var b=h.get(e);if(b)return b==t;r|=2,h.set(e,t);var m=o(p(e),p(t),r,c,u,h);return h.delete(e),m;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},function(e,t,n){var r=n(2).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(70),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,o,s){var l=1&n,c=r(e),d=c.length;if(d!=r(t).length&&!l)return!1;for(var u=d;u--;){var h=c[u];if(!(l?h in t:i.call(t,h)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var f=!0;s.set(e,t),s.set(t,e);for(var b=l;++u<d;){var m=e[h=c[u]],g=t[h];if(a)var v=l?a(g,m,h,t,e,s):a(m,g,h,e,t,s);if(!(void 0===v?m===g||o(m,g,n,a,s):v)){f=!1;break}b||(b="constructor"==h)}if(f&&!b){var j=e.constructor,y=t.constructor;j!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof j&&j instanceof j&&"function"==typeof y&&y instanceof y)&&(f=!1)}return s.delete(e),s.delete(t),f}},function(e,t,n){var r=n(71),i=n(73),a=n(76);e.exports=function(e){return r(e,a,i)}},function(e,t,n){var r=n(72),i=n(13);e.exports=function(e,t,n){var a=t(e);return i(e)?a:r(a,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(74),i=n(75),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),r(o(e),(function(t){return a.call(e,t)})))}:i;e.exports=s},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(77),i=n(86),a=n(90);e.exports=function(e){return a(e)?r(e):i(e)}},function(e,t,n){var r=n(78),i=n(79),a=n(13),o=n(21),s=n(82),l=n(23),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),d=!n&&i(e),u=!n&&!d&&o(e),h=!n&&!d&&!u&&l(e),p=n||d||u||h,f=p?r(e.length,String):[],b=f.length;for(var m in e)!t&&!c.call(e,m)||p&&("length"==m||u&&("offset"==m||"parent"==m)||h&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,b))||f.push(m);return f}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(80),i=n(9),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},function(e,t,n){var r=n(6),i=n(9);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(6),i=n(24),a=n(9),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(16),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&r.process,s=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s}).call(this,n(22)(e))},function(e,t,n){var r=n(87),i=n(88),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(89)(Object.keys,Object);e.exports=r},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(15),i=n(24);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){var r=n(92),i=n(11),a=n(93),o=n(94),s=n(95),l=n(6),c=n(18),d=c(r),u=c(i),h=c(a),p=c(o),f=c(s),b=l;(r&&"[object DataView]"!=b(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=b(new i)||a&&"[object Promise]"!=b(a.resolve())||o&&"[object Set]"!=b(new o)||s&&"[object WeakMap]"!=b(new s))&&(b=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case d:return"[object DataView]";case u:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case f:return"[object WeakMap]"}return t}),e.exports=b},function(e,t,n){var r=n(3)(n(2),"DataView");e.exports=r},function(e,t,n){var r=n(3)(n(2),"Promise");e.exports=r},function(e,t,n){var r=n(3)(n(2),"Set");e.exports=r},function(e,t,n){var r=n(3)(n(2),"WeakMap");e.exports=r},function(e,t,n){"use strict";var r=n(97);function i(){}e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=i,n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n.r(t);var r=n(10),i=n.n(r),a=n(25),o=n.n(a),s=n(26),l=n.n(s),c=n(0),d=n.n(c),u=n(1),h=n.n(u);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),m(this,g(t).apply(this,arguments))}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,h.a.PureComponent),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,["children","title"]);return h.a.createElement("button",f({"aria-label":n,title:n,type:"button"},r),t)}}])&&b(n.prototype,r),t}();j(y,"propTypes",{children:d.a.node.isRequired,title:d.a.string}),j(y,"defaultProps",{title:null});var x=y;function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=t,this.flatNodes=n}var t,n;return t=e,(n=[{key:"setProps",value:function(e){this.props=e}},{key:"clone",value:function(){var t=this,n={};return Object.keys(this.flatNodes).forEach((function(e){var r=t.flatNodes[e];n[e]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){O(e,t,n[t])}))}return e}({},r)})),new e(this.props,n)}},{key:"getNode",value:function(e){return this.flatNodes[e]}},{key:"flattenNodes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(Array.isArray(e)&&0!==e.length){var i=this.props,a=i.disabled,o=i.noCascade;e.forEach((function(e,i){var s=t.nodeHasChildren(e);t.flatNodes[e.value]={label:e.label,value:e.value,children:e.children,parent:n,isParent:s,isLeaf:!s,showCheckbox:void 0===e.showCheckbox||e.showCheckbox,disabled:t.getDisabledState(e,n,a,o),treeDepth:r,index:i},t.flattenNodes(e.children,e,r+1)}))}}},{key:"nodeHasChildren",value:function(e){return Array.isArray(e.children)&&e.children.length>0}},{key:"getDisabledState",value:function(e,t,n,r){return!!n||!(r||!t.disabled)||Boolean(e.disabled)}},{key:"deserializeLists",value:function(e){var t=this,n=["checked","expanded"];Object.keys(this.flatNodes).forEach((function(e){n.forEach((function(n){t.flatNodes[e][n]=!1}))})),n.forEach((function(n){e[n].forEach((function(e){void 0!==t.flatNodes[e]&&(t.flatNodes[e][n]=!0)}))}))}},{key:"serializeList",value:function(e){var t=this,n=[];return Object.keys(this.flatNodes).forEach((function(r){t.flatNodes[r][e]&&n.push(r)})),n}},{key:"expandAllNodes",value:function(e){var t=this;return Object.keys(this.flatNodes).forEach((function(n){t.flatNodes[n].isParent&&(t.flatNodes[n].expanded=e)})),this}},{key:"toggleChecked",value:function(e,t,n){var r=this,i=this.flatNodes[e.value];if(i.isLeaf||n){if(e.disabled)return this;this.toggleNode(e.value,"checked",t)}else i.children.forEach((function(e){r.toggleChecked(e,t,n)}));return this}},{key:"toggleNode",value:function(e,t,n){return this.flatNodes[e][t]=n,this}}])&&C(t.prototype,n),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),T(this,_(t).apply(this,arguments))}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,h.a.PureComponent),n=t,(r=[{key:"componentDidMount",value:function(){this.updateDeterminateProperty()}},{key:"componentDidUpdate",value:function(){this.updateDeterminateProperty()}},{key:"updateDeterminateProperty",value:function(){var e=this.props.indeterminate;this.checkbox.indeterminate=e}},{key:"render",value:function(){var e=this,t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){E(e,t,n[t])}))}return e}({},this.props);return delete t.indeterminate,h.a.createElement("input",R({},t,{ref:function(t){e.checkbox=t},type:"checkbox"}))}}])&&k(n.prototype,r),t}();E(M,"propTypes",{indeterminate:d.a.bool}),E(M,"defaultProps",{indeterminate:!1});var D=M,P=d.a.shape({check:d.a.node,uncheck:d.a.node,halfCheck:d.a.node,expandClose:d.a.node,expandOpen:d.a.node,expandAll:d.a.node,collapseAll:d.a.node,parentClose:d.a.node,parentOpen:d.a.node,leaf:d.a.node}),I=d.a.shape({collapseAll:d.a.string.isRequired,expandAll:d.a.string.isRequired,toggle:d.a.string.isRequired});function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){function t(e){var n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=!(r=z(t).call(this,e))||"object"!==N(r)&&"function"!=typeof r?U(this):r).onCheck=n.onCheck.bind(U(U(n))),n.onClick=n.onClick.bind(U(U(n))),n.onExpand=n.onExpand.bind(U(U(n))),n}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,h.a.Component),n=t,(r=[{key:"onCheck",value:function(){var e=this.props,t=e.value;(0,e.onCheck)({value:t,checked:this.getCheckState({toggle:!0})})}},{key:"onClick",value:function(){var e=this.props,t=e.expandOnClick,n=e.isParent,r=e.value,i=e.onClick;n&&t&&this.onExpand(),i({value:r,checked:this.getCheckState({toggle:!1})})}},{key:"onExpand",value:function(){var e=this.props,t=e.expanded,n=e.value;(0,e.onExpand)({value:n,expanded:!t})}},{key:"getCheckState",value:function(e){var t=e.toggle,n=this.props,r=n.checked,i=n.optimisticToggle;return!(0!==r||!t)||1===r&&!t||2===r&&i}},{key:"renderCollapseButton",value:function(){var e=this.props,t=e.expandDisabled,n=e.isLeaf,r=e.lang;return n?h.a.createElement("span",{className:"rct-collapse"},h.a.createElement("span",{className:"rct-icon"})):h.a.createElement(x,{className:"rct-collapse rct-collapse-btn",disabled:t,title:r.toggle,onClick:this.onExpand},this.renderCollapseIcon())}},{key:"renderCollapseIcon",value:function(){var e=this.props,t=e.expanded,n=e.icons,r=n.expandClose,i=n.expandOpen;return t?i:r}},{key:"renderCheckboxIcon",value:function(){var e=this.props,t=e.checked,n=e.icons,r=n.uncheck,i=n.check,a=n.halfCheck;return 0===t?r:1===t?i:a}},{key:"renderNodeIcon",value:function(){var e=this.props,t=e.expanded,n=e.icon,r=e.icons,i=r.leaf,a=r.parentClose,o=r.parentOpen,s=e.isLeaf;return null!==n?n:s?i:t?o:a}},{key:"renderBareLabel",value:function(e){var t=this.props,n=t.onClick,r=t.title,i=null!==n;return h.a.createElement("span",{className:"rct-bare-label",title:r},i?h.a.createElement("span",{className:"rct-node-clickable",onClick:this.onClick,onKeyPress:this.onClick,role:"button",tabIndex:0},e):e)}},{key:"renderCheckboxLabel",value:function(e){var t=this.props,n=t.checked,r=t.disabled,i=t.title,a=t.treeId,o=t.value,s=null!==t.onClick,l="".concat(a,"-").concat(String(o).split(" ").join("_")),c=[h.a.createElement("label",{key:0,htmlFor:l,title:i},h.a.createElement(D,{checked:1===n,disabled:r,id:l,indeterminate:2===n,onClick:this.onCheck,onChange:function(){}}),h.a.createElement("span",{className:"rct-checkbox"},this.renderCheckboxIcon()),s?null:e)];return s&&c.push(h.a.createElement("span",{key:1,className:"rct-node-clickable",onClick:this.onClick,onKeyPress:this.onClick,role:"link",tabIndex:0},e)),c}},{key:"renderLabel",value:function(){var e=this.props,t=e.label,n=e.showCheckbox,r=[e.showNodeIcon?h.a.createElement("span",{key:0,className:"rct-node-icon"},this.renderNodeIcon()):null,h.a.createElement("span",{key:1,className:"rct-title"},t)];return n?this.renderCheckboxLabel(r):this.renderBareLabel(r)}},{key:"renderChildren",value:function(){return this.props.expanded?this.props.children:null}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.disabled,r=e.expanded,a=e.isLeaf,o=i()({"rct-node":!0,"rct-node-leaf":a,"rct-node-parent":!a,"rct-node-expanded":!a&&r,"rct-node-collapsed":!a&&!r,"rct-disabled":n},t);return h.a.createElement("li",{className:o},h.a.createElement("span",{className:"rct-text"},this.renderCollapseButton(),this.renderLabel()),this.renderChildren())}}])&&q(n.prototype,r),t}();$(L,"propTypes",{checked:d.a.number.isRequired,disabled:d.a.bool.isRequired,expandDisabled:d.a.bool.isRequired,expanded:d.a.bool.isRequired,icons:P.isRequired,isLeaf:d.a.bool.isRequired,isParent:d.a.bool.isRequired,label:d.a.node.isRequired,lang:I.isRequired,optimisticToggle:d.a.bool.isRequired,showNodeIcon:d.a.bool.isRequired,treeId:d.a.string.isRequired,value:d.a.oneOfType([d.a.string,d.a.number]).isRequired,onCheck:d.a.func.isRequired,onExpand:d.a.func.isRequired,children:d.a.node,className:d.a.string,expandOnClick:d.a.bool,icon:d.a.node,showCheckbox:d.a.bool,title:d.a.string,onClick:d.a.func}),$(L,"defaultProps",{children:null,className:null,expandOnClick:!1,icon:null,showCheckbox:!0,title:null,onClick:function(){}});var V=L,H=d.a.oneOfType([d.a.arrayOf(d.a.string),d.a.arrayOf(d.a.number)]);function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W={label:d.a.node.isRequired,value:d.a.oneOfType([d.a.string,d.a.number]).isRequired,disabled:d.a.bool,icon:d.a.node,showCheckbox:d.a.bool,title:d.a.string},G=d.a.oneOfType([d.a.shape(W),d.a.shape(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){B(e,t,n[t])}))}return e}({},W,{children:d.a.arrayOf(W).isRequired}))]);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ee(e,t,n[t])}))}return e}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=function(e){function t(e){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=!(r=X(t).call(this,e))||"object"!==K(r)&&"function"!=typeof r?Z(this):r;var i=new S(e);return i.flattenNodes(e.nodes),i.deserializeLists({checked:e.checked,expanded:e.expanded}),n.state={id:e.id||"rct-".concat(l()(7)),model:i,prevProps:e},n.onCheck=n.onCheck.bind(Z(Z(n))),n.onExpand=n.onExpand.bind(Z(Z(n))),n.onNodeClick=n.onNodeClick.bind(Z(Z(n))),n.onExpandAll=n.onExpandAll.bind(Z(Z(n))),n.onCollapseAll=n.onCollapseAll.bind(Z(Z(n))),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,h.a.Component),n=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.model,r=t.prevProps,i=e.disabled,a=e.id,s=e.nodes,l=Q({},t,{prevProps:e});return n.setProps(e),o()(r.nodes,s)&&r.disabled===i||n.flattenNodes(s),null!==a&&(l=Q({},l,{id:a})),n.deserializeLists({checked:e.checked,expanded:e.expanded}),l}}],(r=[{key:"onCheck",value:function(e){var t=this.props,n=t.noCascade,r=t.onCheck,i=this.state.model.clone(),a=i.getNode(e.value);i.toggleChecked(e,e.checked,n),r(i.serializeList("checked"),Q({},a,e))}},{key:"onExpand",value:function(e){var t=this.props.onExpand,n=this.state.model.clone(),r=n.getNode(e.value);n.toggleNode(e.value,"expanded",e.expanded),t(n.serializeList("expanded"),Q({},r,e))}},{key:"onNodeClick",value:function(e){(0,this.props.onClick)(Q({},this.state.model.getNode(e.value),e))}},{key:"onExpandAll",value:function(){this.expandAllNodes()}},{key:"onCollapseAll",value:function(){this.expandAllNodes(!1)}},{key:"expandAllNodes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,this.props.onExpand)(this.state.model.clone().expandAllNodes(e).serializeList("expanded"))}},{key:"determineShallowCheckState",value:function(e,t){var n=this.state.model.getNode(e.value);return n.isLeaf||t?n.checked?1:0:this.isEveryChildChecked(e)?1:this.isSomeChildChecked(e)?2:0}},{key:"isEveryChildChecked",value:function(e){var t=this;return e.children.every((function(e){return 1===t.state.model.getNode(e.value).checkState}))}},{key:"isSomeChildChecked",value:function(e){var t=this;return e.children.some((function(e){return t.state.model.getNode(e.value).checkState>0}))}},{key:"renderTreeNodes",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.props,a=i.expandDisabled,o=i.expandOnClick,s=i.icons,l=i.lang,c=i.noCascade,d=i.onClick,u=i.onlyLeafCheckboxes,p=i.optimisticToggle,f=i.showNodeTitle,b=i.showNodeIcon,m=this.state,g=m.id,v=m.model,j=t.defaultProps.icons,y=e.map((function(e){var t=e.value,i=v.getNode(e.value),m=i.isParent?n.renderTreeNodes(e.children,e):null;i.checkState=n.determineShallowCheckState(e,c);var y=u?i.isLeaf:i.showCheckbox;return!r.value||v.getNode(r.value).expanded?h.a.createElement(V,{key:t,checked:i.checkState,className:e.className,disabled:i.disabled,expandDisabled:a,expandOnClick:o,expanded:i.expanded,icon:e.icon,icons:Q({},j,s),label:e.label,lang:l,optimisticToggle:p,isLeaf:i.isLeaf,isParent:i.isParent,showCheckbox:y,showNodeIcon:b,title:f?e.title||e.label:e.title,treeId:g,value:e.value,onCheck:n.onCheck,onClick:d&&n.onNodeClick,onExpand:n.onExpand},m):null}));return h.a.createElement("ol",null,y)}},{key:"renderExpandAll",value:function(){var e=this.props,t=e.icons,n=t.expandAll,r=t.collapseAll,i=e.lang;return e.showExpandAll?h.a.createElement("div",{className:"rct-options"},h.a.createElement(x,{className:"rct-option rct-option-expand-all",title:i.expandAll,onClick:this.onExpandAll},n),h.a.createElement(x,{className:"rct-option rct-option-collapse-all",title:i.collapseAll,onClick:this.onCollapseAll},r)):null}},{key:"renderHiddenInput",value:function(){var e=this.props,t=e.name,n=e.nameAsArray;return void 0===t?null:n?this.renderArrayHiddenInput():this.renderJoinedHiddenInput()}},{key:"renderArrayHiddenInput",value:function(){var e=this.props,t=e.checked,n=e.name;return t.map((function(e){var t="".concat(n,"[]");return h.a.createElement("input",{key:e,name:t,type:"hidden",value:e})}))}},{key:"renderJoinedHiddenInput",value:function(){var e=this.props,t=e.checked,n=e.name,r=t.join(",");return h.a.createElement("input",{name:n,type:"hidden",value:r})}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.nodes,r=e.nativeCheckboxes,a=this.renderTreeNodes(n),o=i()({"react-checkbox-tree":!0,"rct-disabled":t,"rct-native-display":r});return h.a.createElement("div",{className:o},this.renderExpandAll(),this.renderHiddenInput(),a)}}])&&Y(n.prototype,r),a&&Y(n,a),t}();ee(te,"propTypes",{nodes:d.a.arrayOf(G).isRequired,checked:H,disabled:d.a.bool,expandDisabled:d.a.bool,expandOnClick:d.a.bool,expanded:H,icons:P,id:d.a.string,lang:I,name:d.a.string,nameAsArray:d.a.bool,nativeCheckboxes:d.a.bool,noCascade:d.a.bool,onlyLeafCheckboxes:d.a.bool,optimisticToggle:d.a.bool,showExpandAll:d.a.bool,showNodeIcon:d.a.bool,showNodeTitle:d.a.bool,onCheck:d.a.func,onClick:d.a.func,onExpand:d.a.func}),ee(te,"defaultProps",{checked:[],disabled:!1,expandDisabled:!1,expandOnClick:!1,expanded:[],icons:{check:h.a.createElement("span",{className:"rct-icon rct-icon-check"}),uncheck:h.a.createElement("span",{className:"rct-icon rct-icon-uncheck"}),halfCheck:h.a.createElement("span",{className:"rct-icon rct-icon-half-check"}),expandClose:h.a.createElement("span",{className:"rct-icon rct-icon-expand-close"}),expandOpen:h.a.createElement("span",{className:"rct-icon rct-icon-expand-open"}),expandAll:h.a.createElement("span",{className:"rct-icon rct-icon-expand-all"}),collapseAll:h.a.createElement("span",{className:"rct-icon rct-icon-collapse-all"}),parentClose:h.a.createElement("span",{className:"rct-icon rct-icon-parent-close"}),parentOpen:h.a.createElement("span",{className:"rct-icon rct-icon-parent-open"}),leaf:h.a.createElement("span",{className:"rct-icon rct-icon-leaf"})},id:null,lang:{collapseAll:"Collapse all",expandAll:"Expand all",toggle:"Toggle"},name:void 0,nameAsArray:!1,nativeCheckboxes:!1,noCascade:!1,onlyLeafCheckboxes:!1,optimisticToggle:!0,showExpandAll:!1,showNodeIcon:!0,showNodeTitle:!1,onCheck:function(){},onClick:null,onExpand:function(){}}),t.default=te}]))},4969:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StickyContainer=t.Sticky=void 0;var r=a(n(4970)),i=a(n(4971));function a(e){return e&&e.__esModule?e:{default:e}}t.Sticky=r.default,t.StickyContainer=i.default,t.default=r.default},4970:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=l(i),o=l(n(29)),s=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e){function t(){var e,n,r;c(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={isSticky:!1,wasSticky:!1,style:{}},r.handleContainerEvent=function(e){var t=e.distanceFromTop,n=e.distanceFromBottom,i=e.eventSource,a=r.context.getParent(),o=!1;r.props.relative&&(o=i!==a,t=-(i.scrollTop+i.offsetTop)+r.placeholder.offsetTop);var s=r.placeholder.getBoundingClientRect(),l=r.content.getBoundingClientRect().height,c=n-r.props.bottomOffset-l,d=!!r.state.isSticky,u=o?d:t<=-r.props.topOffset&&n>-r.props.bottomOffset;n=(r.props.relative?a.scrollHeight-a.scrollTop:n)-l;var h=u?{position:"fixed",top:c>0?r.props.relative?a.offsetTop-a.offsetParent.scrollTop:0:c,left:s.left,width:s.width}:{};r.props.disableHardwareAcceleration||(h.transform="translateZ(0)"),r.setState({isSticky:u,wasSticky:d,distanceFromTop:t,distanceFromBottom:n,calculatedHeight:l,style:h})},d(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentWillMount",value:function(){if(!this.context.subscribe)throw new TypeError("Expected Sticky to be mounted within StickyContainer");this.context.subscribe(this.handleContainerEvent)}},{key:"componentWillUnmount",value:function(){this.context.unsubscribe(this.handleContainerEvent)}},{key:"componentDidUpdate",value:function(){this.placeholder.style.paddingBottom=this.props.disableCompensation?0:(this.state.isSticky?this.state.calculatedHeight:0)+"px"}},{key:"render",value:function(){var e=this,t=a.default.cloneElement(this.props.children({isSticky:this.state.isSticky,wasSticky:this.state.wasSticky,distanceFromTop:this.state.distanceFromTop,distanceFromBottom:this.state.distanceFromBottom,calculatedHeight:this.state.calculatedHeight,style:this.state.style}),{ref:function(t){e.content=o.default.findDOMNode(t)}});return a.default.createElement("div",null,a.default.createElement("div",{ref:function(t){return e.placeholder=t}}),t)}}]),t}(i.Component);u.propTypes={topOffset:s.default.number,bottomOffset:s.default.number,relative:s.default.bool,children:s.default.func.isRequired},u.defaultProps={relative:!1,topOffset:0,bottomOffset:0,disableCompensation:!1,disableHardwareAcceleration:!1},u.contextTypes={subscribe:s.default.func,unsubscribe:s.default.func,getParent:s.default.func},t.default=u},4971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),o=c(a),s=c(n(2)),l=c(n(4972));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){var e,n,r;d(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.events=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],r.subscribers=[],r.rafHandle=null,r.subscribe=function(e){r.subscribers=r.subscribers.concat(e)},r.unsubscribe=function(e){r.subscribers=r.subscribers.filter((function(t){return t!==e}))},r.notifySubscribers=function(e){if(!r.framePending){var t=e.currentTarget;r.rafHandle=(0,l.default)((function(){r.framePending=!1;var e=r.node.getBoundingClientRect(),n=e.top,i=e.bottom;r.subscribers.forEach((function(e){return e({distanceFromTop:n,distanceFromBottom:i,eventSource:t===window?document.body:r.node})}))})),r.framePending=!0}},r.getParent=function(){return r.node},u(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getChildContext",value:function(){return{subscribe:this.subscribe,unsubscribe:this.unsubscribe,getParent:this.getParent}}},{key:"componentDidMount",value:function(){var e=this;this.events.forEach((function(t){return window.addEventListener(t,e.notifySubscribers)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.rafHandle&&(l.default.cancel(this.rafHandle),this.rafHandle=null),this.events.forEach((function(t){return window.removeEventListener(t,e.notifySubscribers)}))}},{key:"render",value:function(){var e=this;return o.default.createElement("div",r({},this.props,{ref:function(t){return e.node=t},onScroll:this.notifySubscribers,onTouchStart:this.notifySubscribers,onTouchMove:this.notifySubscribers,onTouchEnd:this.notifySubscribers}))}}]),t}(a.PureComponent);h.childContextTypes={subscribe:s.default.func,unsubscribe:s.default.func,getParent:s.default.func},t.default=h},4972:function(e,t,n){(function(t){for(var r=n(4973),i="undefined"==typeof window?t:window,a=["moz","webkit"],o="AnimationFrame",s=i["request"+o],l=i["cancel"+o]||i["cancelRequest"+o],c=0;!s&&c<a.length;c++)s=i[a[c]+"Request"+o],l=i[a[c]+"Cancel"+o]||i[a[c]+"CancelRequest"+o];if(!s||!l){var d=0,u=0,h=[];s=function(e){if(0===h.length){var t=r(),n=Math.max(0,1e3/60-(t-d));d=n+t,setTimeout((function(){var e=h.slice(0);h.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(d)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return h.push({handle:++u,callback:e,cancelled:!1}),u},l=function(e){for(var t=0;t<h.length;t++)h[t].handle===e&&(h[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){l.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=l}}).call(this,n(179))},4973:function(e,t,n){(function(t){(function(){var n,r,i,a,o,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-o)/1e6},r=t.hrtime,a=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),s=1e9*t.uptime(),o=a-s):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,n(408))},4974:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFilter=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(0),a=l(i),o=l(n(2)),s=n(4975);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={searchTerm:n.props.value||""},n.updateSearch=n.updateSearch.bind(n),n.filter=n.filter.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentWillReceiveProps",value:function(e){if(void 0!==e.value&&e.value!==this.props.value){var t={target:{value:e.value}};this.updateSearch(t)}}},{key:"render",value:function(){var e=this.props,t=e.className,n=(e.onChange,e.caseSensitive,e.sortResults,e.throttle,e.filterKeys,e.value,e.fuzzy,e.inputClassName),r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["className","onChange","caseSensitive","sortResults","throttle","filterKeys","value","fuzzy","inputClassName"]);return r.type=r.type||"search",r.value=this.state.searchTerm,r.onChange=this.updateSearch,r.className=n,r.placeholder=r.placeholder||"Search",a.default.createElement("div",{className:t},a.default.createElement("input",r))}},{key:"updateSearch",value:function(e){var t=this,n=e.target.value;this.setState({searchTerm:n},(function(){t._throttleTimeout&&clearTimeout(t._throttleTimeout),t._throttleTimeout=setTimeout((function(){return t.props.onChange(n)}),t.props.throttle)}))}},{key:"filter",value:function(e){var t=this.props,n=t.filterKeys,r=t.caseSensitive,i=t.fuzzy,a=t.sortResults;return(0,s.createFilter)(this.state.searchTerm,e||n,{caseSensitive:r,fuzzy:i,sortResults:a})}}]),t}(i.Component);c.defaultProps={className:"",onChange:function(){},caseSensitive:!1,fuzzy:!1,throttle:200},c.propTypes={className:o.default.string,inputClassName:o.default.string,onChange:o.default.func,caseSensitive:o.default.bool,sortResults:o.default.bool,fuzzy:o.default.bool,throttle:o.default.number,filterKeys:o.default.oneOf([o.default.string,o.default.arrayOf(o.default.string)]),value:o.default.string},t.default=c,t.createFilter=s.createFilter},4975:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValuesForKey=o,t.searchStrings=s,t.createFilter=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(""===e)return!0;n.caseSensitive||(e=e.toLowerCase());var i=e.split(" ");return t?("string"==typeof t&&(t=[t]),i.every((function(e){var i=void 0;if(-1!==e.indexOf(":")){var a=e.split(":")[0];e=e.split(":")[1],i=t.filter((function(e){return e.toLowerCase().indexOf(a)>-1}))}else i=t;return i.some((function(t){return s(o(t,r),e,n)}))}))):i.every((function(e){return s([r],e,n)}))}};var r,i=n(4976),a=(r=i)&&r.__esModule?r:{default:r};function o(e,t){var n=e.split("."),r=[t];return n.forEach((function(e){var t=[];r.forEach((function(n){if(n)if(n instanceof Array){var r=parseInt(e,10);if(!isNaN(r))return t.push(n[r]);n.forEach((function(n){t.push(n[e])}))}else n&&"function"==typeof n.get?t.push(n.get(e)):t.push(n[e])})),r=t})),(r=function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])}(r=r.map((function(e){return e&&e.push&&e.toArray?e.toArray():e})))).filter((function(e){return"string"==typeof e||"number"==typeof e}))}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.caseSensitive,i=n.fuzzy,o=n.sortResults,s=n.exactMatch;e=e.map((function(e){return e.toString()}));try{if(i){"function"==typeof e.toJS&&(e=e.toJS());var l=new a.default(e.map((function(e){return{id:e}})),{keys:["id"],id:"id",caseSensitive:r,shouldSort:o});return l.search(t).length}return e.some((function(e){try{return r||(e=e.toLowerCase()),s&&(t=new RegExp("^"+t+"$","i")),!(!e||-1===e.search(t))}catch(e){return!1}}))}catch(e){return!1}}},4976:function(e,t,n){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=n(1),o=n(7),s=o.get,l=(o.deepValue,o.isArray),c=function(){function e(t,n){var r=n.location,i=void 0===r?0:r,a=n.distance,o=void 0===a?100:a,l=n.threshold,c=void 0===l?.6:l,d=n.maxPatternLength,u=void 0===d?32:d,h=n.caseSensitive,p=void 0!==h&&h,f=n.tokenSeparator,b=void 0===f?/ +/g:f,m=n.findAllMatches,g=void 0!==m&&m,v=n.minMatchCharLength,j=void 0===v?1:v,y=n.id,x=void 0===y?null:y,O=n.keys,C=void 0===O?[]:O,S=n.shouldSort,w=void 0===S||S,R=n.getFn,k=void 0===R?s:R,T=n.sortFn,_=void 0===T?function(e,t){return e.score-t.score}:T,F=n.tokenize,E=void 0!==F&&F,M=n.matchAllTokens,D=void 0!==M&&M,P=n.includeMatches,I=void 0!==P&&P,N=n.includeScore,q=void 0!==N&&N,z=n.verbose,A=void 0!==z&&z;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:i,distance:o,threshold:c,maxPatternLength:u,isCaseSensitive:p,tokenSeparator:b,findAllMatches:g,minMatchCharLength:j,id:x,keys:C,includeMatches:I,includeScore:q,shouldSort:w,getFn:k,sortFn:_,verbose:A,tokenize:E,matchAllTokens:D},this.setCollection(t),this._processKeys(C)}var t,n;return t=e,(n=[{key:"setCollection",value:function(e){return this.list=e,e}},{key:"_processKeys",value:function(e){if(this._keyWeights={},this._keyNames=[],e.length&&"string"==typeof e[0])for(var t=0,n=e.length;t<n;t+=1){var r=e[t];this._keyWeights[r]=1,this._keyNames.push(r)}else{for(var i=null,a=null,o=0,s=0,l=e.length;s<l;s+=1){var c=e[s];if(!c.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var d=c.name;if(this._keyNames.push(d),!c.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var u=c.weight;if(u<0||u>1)throw new Error('"weight" property in key must bein the range of [0, 1)');a=null==a?u:Math.max(a,u),i=null==i?u:Math.min(i,u),this._keyWeights[d]=u,o+=u}if(o>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(e,'"'));var n=this._prepareSearchers(e),r=n.tokenSearchers,i=n.fullSearcher,a=this._search(r,i);return this._computeScore(a),this.options.shouldSort&&this._sort(a),t.limit&&"number"==typeof t.limit&&(a=a.slice(0,t.limit)),this._format(a)}},{key:"_prepareSearchers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),r=0,i=n.length;r<i;r+=1)t.push(new a(n[r],this.options));return{tokenSearchers:t,fullSearcher:new a(e,this.options)}}},{key:"_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,r={},i=[];if("string"==typeof n[0]){for(var a=0,o=n.length;a<o;a+=1)this._analyze({key:"",value:n[a],record:a,index:a},{resultMap:r,results:i,tokenSearchers:e,fullSearcher:t});return i}for(var s=0,l=n.length;s<l;s+=1)for(var c=n[s],d=0,u=this._keyNames.length;d<u;d+=1){var h=this._keyNames[d];this._analyze({key:h,value:this.options.getFn(c,h),record:c,index:s},{resultMap:r,results:i,tokenSearchers:e,fullSearcher:t})}return i}},{key:"_analyze",value:function(e,t){var n=this,r=e.key,i=e.arrayIndex,a=void 0===i?-1:i,o=e.value,s=e.record,c=e.index,d=t.tokenSearchers,u=void 0===d?[]:d,h=t.fullSearcher,p=t.resultMap,f=void 0===p?{}:p,b=t.results,m=void 0===b?[]:b;!function e(t,i,a,o){if(null!=i)if("string"==typeof i){var s=!1,c=-1,d=0;n._log("\nKey: ".concat(""===r?"--":r));var p=h.search(i);if(n._log('Full text: "'.concat(i,'", score: ').concat(p.score)),n.options.tokenize){for(var b=i.split(n.options.tokenSeparator),g=b.length,v=[],j=0,y=u.length;j<y;j+=1){var x=u[j];n._log('\nPattern: "'.concat(x.pattern,'"'));for(var O=!1,C=0;C<g;C+=1){var S=b[C],w=x.search(S),R={};w.isMatch?(R[S]=w.score,s=!0,O=!0,v.push(w.score)):(R[S]=1,n.options.matchAllTokens||v.push(1)),n._log('Token: "'.concat(S,'", score: ').concat(R[S]))}O&&(d+=1)}c=v[0];for(var k=v.length,T=1;T<k;T+=1)c+=v[T];c/=k,n._log("Token score average:",c)}var _=p.score;c>-1&&(_=(_+c)/2),n._log("Score average:",_);var F=!n.options.tokenize||!n.options.matchAllTokens||d>=u.length;if(n._log("\nCheck Matches: ".concat(F)),(s||p.isMatch)&&F){var E={key:r,arrayIndex:t,value:i,score:_};n.options.includeMatches&&(E.matchedIndices=p.matchedIndices);var M=f[o];M?M.output.push(E):(f[o]={item:a,output:[E]},m.push(f[o]))}}else if(l(i))for(var D=0,P=i.length;D<P;D+=1)e(D,i[D],a,o)}(a,o,s,c)}},{key:"_computeScore",value:function(e){this._log("\n\nComputing score:\n");for(var t=this._keyWeights,n=!!Object.keys(t).length,r=0,i=e.length;r<i;r+=1){for(var a=e[r],o=a.output,s=o.length,l=1,c=0;c<s;c+=1){var d=o[c],u=d.key,h=n?t[u]:1,p=0===d.score&&t&&t[u]>0?Number.EPSILON:d.score;l*=Math.pow(p,h)}a.score=l,this._log(a)}}},{key:"_sort",value:function(e){this._log("\n\nSorting...."),e.sort(this.options.sortFn)}},{key:"_format",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log("\n\nOutput:\n\n",JSON.stringify(e,(function(e,t){if("object"===r(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}),2)),n=null}var i=[];this.options.includeMatches&&i.push((function(e,t){var n=e.output;t.matches=[];for(var r=0,i=n.length;r<i;r+=1){var a=n[r];if(0!==a.matchedIndices.length){var o={indices:a.matchedIndices,value:a.value};a.key&&(o.key=a.key),a.hasOwnProperty("arrayIndex")&&a.arrayIndex>-1&&(o.arrayIndex=a.arrayIndex),t.matches.push(o)}}})),this.options.includeScore&&i.push((function(e,t){t.score=e.score}));for(var a=0,o=e.length;a<o;a+=1){var s=e[a];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),i.length){for(var l={item:s.item},c=0,d=i.length;c<d;c+=1)i[c](s,l);t.push(l)}else t.push(s.item)}return t}},{key:"_log",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&i(t.prototype,n),e}();e.exports=c},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(2),a=n(3),o=n(6),s=function(){function e(t,n){var r=n.location,i=void 0===r?0:r,a=n.distance,s=void 0===a?100:a,l=n.threshold,c=void 0===l?.6:l,d=n.maxPatternLength,u=void 0===d?32:d,h=n.isCaseSensitive,p=void 0!==h&&h,f=n.tokenSeparator,b=void 0===f?/ +/g:f,m=n.findAllMatches,g=void 0!==m&&m,v=n.minMatchCharLength,j=void 0===v?1:v,y=n.includeMatches,x=void 0!==y&&y;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={location:i,distance:s,threshold:c,maxPatternLength:u,isCaseSensitive:p,tokenSeparator:b,findAllMatches:g,includeMatches:x,minMatchCharLength:j},this.pattern=p?t:t.toLowerCase(),this.pattern.length<=u&&(this.patternAlphabet=o(this.pattern))}var t,n;return t=e,(n=[{key:"search",value:function(e){var t=this.options,n=t.isCaseSensitive,r=t.includeMatches;if(n||(e=e.toLowerCase()),this.pattern===e){var o={isMatch:!0,score:0};return r&&(o.matchedIndices=[[0,e.length-1]]),o}var s=this.options,l=s.maxPatternLength,c=s.tokenSeparator;if(this.pattern.length>l)return i(e,this.pattern,c);var d=this.options,u=d.location,h=d.distance,p=d.threshold,f=d.findAllMatches,b=d.minMatchCharLength;return a(e,this.pattern,this.patternAlphabet,{location:u,distance:h,threshold:p,findAllMatches:f,minMatchCharLength:b,includeMatches:r})}}])&&r(t.prototype,n),e}();e.exports=s},function(e,t){var n=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;e.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,i=new RegExp(t.replace(n,"\\$&").replace(r,"|")),a=e.match(i),o=!!a,s=[];if(o)for(var l=0,c=a.length;l<c;l+=1){var d=a[l];s.push([e.indexOf(d),d.length-1])}return{score:o?.5:1,isMatch:o,matchedIndices:s}}},function(e,t,n){var r=n(4),i=n(5);e.exports=function(e,t,n,a){for(var o=a.location,s=void 0===o?0:o,l=a.distance,c=void 0===l?100:l,d=a.threshold,u=void 0===d?.6:d,h=a.findAllMatches,p=void 0!==h&&h,f=a.minMatchCharLength,b=void 0===f?1:f,m=a.includeMatches,g=void 0!==m&&m,v=s,j=e.length,y=u,x=e.indexOf(t,v),O=t.length,C=[],S=0;S<j;S+=1)C[S]=0;if(-1!==x){var w=r(t,{errors:0,currentLocation:x,expectedLocation:v,distance:c});if(y=Math.min(w,y),-1!==(x=e.lastIndexOf(t,v+O))){var R=r(t,{errors:0,currentLocation:x,expectedLocation:v,distance:c});y=Math.min(R,y)}}x=-1;for(var k=[],T=1,_=O+j,F=1<<(O<=31?O-1:30),E=0;E<O;E+=1){for(var M=0,D=_;M<D;)r(t,{errors:E,currentLocation:v+D,expectedLocation:v,distance:c})<=y?M=D:_=D,D=Math.floor((_-M)/2+M);_=D;var P=Math.max(1,v-D+1),I=p?j:Math.min(v+D,j)+O,N=Array(I+2);N[I+1]=(1<<E)-1;for(var q=I;q>=P;q-=1){var z=q-1,A=n[e.charAt(z)];if(A&&(C[z]=1),N[q]=(N[q+1]<<1|1)&A,0!==E&&(N[q]|=(k[q+1]|k[q])<<1|1|k[q+1]),N[q]&F&&(T=r(t,{errors:E,currentLocation:z,expectedLocation:v,distance:c}))<=y){if(y=T,(x=z)<=v)break;P=Math.max(1,2*v-x)}}if(r(t,{errors:E+1,currentLocation:v,expectedLocation:v,distance:c})>y)break;k=N}var U={isMatch:x>=0,score:0===T?.001:T};return g&&(U.matchedIndices=i(C,b)),U}},function(e,t){e.exports=function(e,t){var n=t.errors,r=void 0===n?0:n,i=t.currentLocation,a=void 0===i?0:i,o=t.expectedLocation,s=void 0===o?0:o,l=t.distance,c=void 0===l?100:l,d=r/e.length,u=Math.abs(s-a);return c?d+u/c:u?1:d}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,i=-1,a=0,o=e.length;a<o;a+=1){var s=e[a];s&&-1===r?r=a:s||-1===r||((i=a-1)-r+1>=t&&n.push([r,i]),r=-1)}return e[a-1]&&a-r>=t&&n.push([r,a-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,r=0;r<n;r+=1)t[e.charAt(r)]=0;for(var i=0;i<n;i+=1)t[e.charAt(i)]|=1<<n-i-1;return t}},function(e,t){var n=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},r=function(e){return null==e?"":function(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)},i=function(e){return"string"==typeof e},a=function(e){return"number"==typeof e};e.exports={get:function(e,t){var o=[];return function e(t,s){if(s){var l=s.indexOf("."),c=s,d=null;-1!==l&&(c=s.slice(0,l),d=s.slice(l+1));var u=t[c];if(null!=u)if(d||!i(u)&&!a(u))if(n(u))for(var h=0,p=u.length;h<p;h+=1)e(u[h],d);else d&&e(u,d);else o.push(r(u))}else o.push(t)}(e,t),o},isArray:n,isString:i,isNum:a,toString:r}}])},4977:function(e,t,n){e.exports={default:n(4978),__esModule:!0}},4978:function(e,t,n){n(4979);var r=n(258).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},4979:function(e,t,n){var r=n(1155),i=n(1968).f;n(1744)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},4980:function(e,t,n){var r=n(2290),i=n(409);e.exports=function(e,t){return r(i(e,t),1)}},4981:function(e,t,n){},4982:function(e,t,n){var r=n(2290),i=n(409);e.exports=function(e,t){return r(i(e,t),1/0)}},4983:function(e,t,n){var r=n(4613);e.exports=function(e){return e&&e.length?r(e):[]}},4984:function(e,t,n){var r=n(2297),i=n(669),a=n(1298),o=Math.max,s=Math.min;e.exports=function(e,t,n){var l=null==e?0:e.length;if(!l)return-1;var c=l-1;return void 0!==n&&(c=a(n),c=n<0?o(l+c,0):s(c,l-1)),r(e,i(t,3),c,!0)}},4985:function(e,t,n){var r=n(4613);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?r(e,void 0,t):[]}},4986:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4987),i=n(0),a="#000",o="#ddd",s="#eee",l="#fff",c=13,d=38,u=40,h={borderColor:o,borderStyle:"solid",borderWidth:1,boxSizing:"border-box",fontSize:24,height:50,lineHeight:"24px",outline:0,paddingLeft:15,paddingRight:15,width:"100%"},p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.style,n=r.__rest(e,["style"]);return i.createElement("input",r.__assign({type:"text",style:r.__assign({},h,t)},n))},t}(i.PureComponent),f={borderBottomWidth:1,borderColor:o,borderLeftWidth:1,borderRightWidth:1,borderStyle:"solid",borderTopWidth:0,boxSizing:"border-box",color:a,display:"block",fontSize:24,height:50,lineHeight:"50px",paddingLeft:15,paddingRight:15,textDecoration:"none"};function b(e){var t=e.item,n=e.isSelected,a=e.isHighlighted,l=e.style,c=r.__rest(e,["item","isSelected","isHighlighted","style"]),d=r.__assign({},f,l);return n&&(d.backgroundColor=s),a&&(d.backgroundColor=o),i.createElement("a",r.__assign({href:t.url,style:d},c),t.title)}var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHighlighted:!1},t.handleMouseEnter=function(e){t.setState({isHighlighted:!0}),t.props.onMouseEnter&&t.props.onMouseEnter(e)},t.handleMouseLeave=function(e){t.setState({isHighlighted:!1}),t.props.onMouseLeave&&t.props.onMouseLeave(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.item;return(this.props.children?this.props.children:b)({style:this.props.style,item:e,isSelected:this.props.isSelected,isHighlighted:this.state.isHighlighted,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.props.onClickItem})},t.defaultProps={isSelected:!1},t}(i.PureComponent),g={position:"absolute",width:"100%",zIndex:2,listStyleType:"none",margin:0,padding:0,backgroundColor:l};function v(e){var t=r.__assign({},g,e.style);function n(e,t){return e.bind(this,t)}return e.maxHeight&&(t.maxHeight=e.maxHeight,t.borderBottomWidth=1,t.borderBottomColor=s,t.borderBottomStyle="solid",t.overflow="auto"),i.createElement("ul",{style:t,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},e.items.map((function(t,r){return i.createElement(m,{key:r,children:e.children,item:t,isSelected:e.selectedIndex===r,onMouseEnter:e.onMouseEnterItem&&n(e.onMouseEnterItem,r),onMouseLeave:e.onMouseLeaveItem&&n(e.onMouseLeaveItem,r),onClickItem:e.onClickItem})})))}function j(e){e.url&&(window.location.href=e.url)}var y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={displayResults:!1,hoveredIndex:-1,results:[],selectedIndex:0},n.query=function(e){n.props.extensions.length>0&&function(e,t){for(var n=[],r=0,i=t;r<i.length;r++){var a=i[r];"function"==typeof a&&n.push(a.call(null,e))}return Promise.all(n).then((function(e){return e.reduce((function(e,t){return e.concat(t)}),[])}))}(e,n.props.extensions).then((function(e){n.setState({results:n.props.maxResults>0?e.slice(0,n.props.maxResults):e,displayResults:e.length>0}),n.props.onQuery&&n.props.onQuery(e)}))},n.prev=function(){n.setState((function(e){var t=e.selectedIndex-1;if(t>=0)return{selectedIndex:t}}))},n.next=function(){n.setState((function(e){var t=e.selectedIndex+1;if(t<e.results.length)return{selectedIndex:t}}))},n.action=function(){var e=n.state.hoveredIndex>-1?n.state.hoveredIndex:n.state.selectedIndex,t=n.state.results[e];(n.props.onAction||j).call(null,t)},n.handleChange=function(e){var t=e.target.value;t?n.query(t):n.reset()},n.handleKeyDown=function(e){switch(e.keyCode){case d:n.prev();break;case u:n.next();break;case c:n.action()}},n.handleMouseEnterItem=function(e){n.setState({hoveredIndex:e})},n.handleMouseLeave=function(){n.setState({hoveredIndex:-1})},n.handleBlur=function(){setTimeout((function(){return n.setState({displayResults:!1})}),200)},n.handleFocus=function(){n.setState({displayResults:!0})},n.handleClickItem=function(e){e.preventDefault(),n.state.hoveredIndex>-1&&n.action()},n.query=function(e,t){var n=this,r=null;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=n,s=function(){r=null,e.apply(o,i)};clearTimeout(r),r=setTimeout(s,t)}}(n.query,n.props.inputDelay),n}return r.__extends(t,e),t.prototype.reset=function(){this.setState({results:[],displayResults:!1})},t.prototype.render=function(){var e=this.props,t=e.children,n=e.render,a=(e.maxResults,e.maxViewableResults),o=(e.extensions,e.inputDelay,e.rootStyle),s=e.resultStyle,l=(e.onQuery,e.onAction,r.__rest(e,["children","render","maxResults","maxViewableResults","extensions","inputDelay","rootStyle","resultStyle","onQuery","onAction"])),c=a?50*a:null;return n||(n=t),i.createElement("div",{style:o},i.createElement(p,r.__assign({},l,{onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown})),this.state.displayResults&&i.createElement(v,{children:n,items:this.state.results,maxHeight:c,onClickItem:this.handleClickItem,onMouseEnterItem:this.handleMouseEnterItem,onMouseLeave:this.handleMouseLeave,selectedIndex:this.state.selectedIndex,style:s}))},t.defaultProps={children:null,extensions:[],inputDelay:100,maxResults:null,maxViewableResults:null,render:null,resultStyle:{},rootStyle:{position:"relative"}},t}(i.PureComponent);function x(e){var t=e.active?"#000":"#ccc";return i.createElement("svg",{width:e.width,height:e.height,fill:t,x:"0px",y:"0px",viewBox:"0 0 490.9 490.9"},i.createElement("g",null,i.createElement("g",null,i.createElement("path",{d:"M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5C149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5c0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"}),i.createElement("path",{d:"M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3s5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8c0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9C106.6,220,101.2,214.5,94.4,214.5z"}))),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null),i.createElement("g",null))}t.default=y,t.command=function(e,t){var n=new RegExp("^"+t+"\\s","i");return function(r){var i=t.toLowerCase(),a=r.toLowerCase();return i===a?[]:a.startsWith(i+" ")?e(r.replace(n,"").trim()):[]}},t.compose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(void 0,n))}}))},t.withExtensions=function(e){return function(t){return function(n){function a(){return null!==n&&n.apply(this,arguments)||this}return r.__extends(a,n),a.prototype.render=function(){return i.createElement(t,r.__assign({extensions:e},this.props))},a}(i.Component)}},t.withVoice=function(e){return function(t){function n(e){var n=t.call(this,e)||this;return n.state={value:"",isSpeaking:!1},n.recognition=null,n.speak=function(){n.recognition.lang="en-US",n.setState({isSpeaking:!0}),n.recognition.start()},n.recognition=null,n}return r.__extends(n,t),n.prototype.componentDidMount=function(){var e=this;if("webkitSpeechRecognition"in window){var t=new webkitSpeechRecognition;t.continuous=!0,t.onresult=function(t){for(var n=t.resultIndex;n<t.results.length;++n)e.setState({value:t.results[n][0].transcript})},this.recognition=t}},n.prototype.render=function(){var t={position:"absolute",right:0,top:0,border:0,backgroundColor:"transparent",lineHeight:"50px",fontSize:24,paddingRight:15,paddingTop:0,paddingBottom:0,paddingLeft:15},n=this.props.style||{};return this.state.isSpeaking&&(n.backgroundColor="rgba(0, 255, 0, 0.075)"),i.createElement("div",{style:{position:"relative"}},i.createElement(e,r.__assign({},this.props,{value:this.state.value,style:n})),i.createElement("button",{onClick:this.speak,style:t},i.createElement(x,{width:24,height:24,active:this.state.isSpeaking})))},n}(i.Component)}},4987:function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return a})),n.d(t,"__rest",(function(){return o})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return l})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return d})),n.d(t,"__generator",(function(){return u})),n.d(t,"__exportStar",(function(){return h})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return f})),n.d(t,"__spread",(function(){return b})),n.d(t,"__spreadArrays",(function(){return m})),n.d(t,"__await",(function(){return g})),n.d(t,"__asyncGenerator",(function(){return v})),n.d(t,"__asyncDelegator",(function(){return j})),n.d(t,"__asyncValues",(function(){return y})),n.d(t,"__makeTemplateObject",(function(){return x})),n.d(t,"__importStar",(function(){return O})),n.d(t,"__importDefault",(function(){return C})),n.d(t,"__classPrivateFieldGet",(function(){return S})),n.d(t,"__classPrivateFieldSet",(function(){return w}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function h(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e}function m(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function v(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof g?Promise.resolve(n.value.v).then(l,c):d(a[0][2],n)}catch(e){d(a[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function j(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:g(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function y(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function C(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function w(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},4988:function(e,t,n){},4989:function(e,t,n){"use strict";n.r(t);var r=n(77),i=n(91),a=(n(41),n(108)),o=n.n(a),s=n(32),l=n.n(s),c=n(62),d=n.n(c),u=n(68),h=n.n(u),p=n(39),f=n.n(p),b=n(71),m=n.n(b),g=n(26),v=n.n(g),j=n(57),y=n.n(j),x=n(35),O=n.n(x),C=n(23),S=n.n(C),w=n(0),R=n.n(w),k=n(2),T=n.n(k),_=n(13),F=n(155),E=n(268),M=n(171),D=n(50),P=n.n(D),I=n(70);function N(e){var t;return P()(t=m()(e)).call(t,(e,t)=>(t&&t.type===I.a&&t.meta&&t.meta.chartId&&e.push(t.meta.chartId),e),[])}var q=n(54),z=n.n(q);var A=n(5),U=n.n(A),$=n(40),L=n(1),V=n(380),H=n(169),B=n(4969),W=n(97),G=n.n(W),K=n(136);function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J=function(e){var t,n;function r(t){var n;return X(Y(n=e.call(this,t)||this),"animationFrameID",void 0),X(Y(n),"resizeObserver",void 0),X(Y(n),"target",null),X(Y(n),"resize",(function(e){var t=e.width,r=e.height,i=e.top,a=e.left;n.setState((function(){return{width:t,height:r,top:i,left:a}}))})),X(Y(n),"setTarget",(function(e){n.target=e})),n.state={width:0,height:0,top:0,left:0},n.resize=G()(n.resize,t.debounceTime),n.animationFrameID=null,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.componentDidMount=function(){var e=this;this.resizeObserver=new K.default((function(t){void 0===t&&(t=[]),t.forEach((function(t){var n=t.contentRect,r=n.left,i=n.top,a=n.width,o=n.height;e.animationFrameID=window.requestAnimationFrame((function(){e.resize({width:a,height:o,top:i,left:r})}))}))})),this.target&&this.resizeObserver.observe(this.target)},i.componentWillUnmount=function(){this.animationFrameID&&window.cancelAnimationFrame(this.animationFrameID),this.resizeObserver&&this.resizeObserver.disconnect()},i.render=function(){var e=this.props,t=e.className,n=e.children,r=(e.debounceTime,e.parentSizeStyles),i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,["className","children","debounceTime","parentSizeStyles"]);return R.a.createElement("div",Q({style:r,ref:this.setTarget,className:t},i),n(Q({},this.state,{ref:this.target,resize:this.resize})))},r}(R.a.Component);X(J,"propTypes",{className:T.a.string,debounceTime:T.a.number,children:T.a.func.isRequired}),X(J,"defaultProps",{debounceTime:300,parentSizeStyles:{width:"100%",height:"100%"}});var Z=n(58),ee=n(1745),te=n(56);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e){return"function"==typeof e}function ie(){}function ae(e){if(!function(e){return"object"===ne(e)&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function oe(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t}function se(e){return(t=e)&&t.prototype&&"function"==typeof t.prototype.render||function(e){var t,n=e;return"Symbol(react.forward_ref)"===(null==n?void 0:null===(t=n.$$typeof)||void 0===t?void 0:t.toString())}(e);var t}var le=n(441),ce=n(200),de=n.n(ce),ue=n(597);function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t,n){return t&&pe(e.prototype,t),n&&pe(e,n),e}var be,me=((be=function(){function e(t){he(this,e),this.isDisposed=!1,this.action=re(t)?t:ie}return fe(e,[{key:"dispose",value:function(){this.isDisposed||(this.action(),this.isDisposed=!0)}}],[{key:"isDisposable",value:function(e){return Boolean(e&&re(e.dispose))}},{key:"_fixup",value:function(t){return e.isDisposable(t)?t:e.empty}},{key:"create",value:function(t){return new e(t)}}]),e}()).empty={dispose:ie},be),ge=function(){function e(){he(this,e),this.isDisposed=!1;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.disposables=n}return fe(e,[{key:"add",value:function(e){this.isDisposed?e.dispose():this.disposables.push(e)}},{key:"remove",value:function(e){var t=!1;if(!this.isDisposed){var n=this.disposables.indexOf(e);-1!==n&&(t=!0,this.disposables.splice(n,1),e.dispose())}return t}},{key:"clear",value:function(){if(!this.isDisposed){for(var e=this.disposables.length,t=new Array(e),n=0;n<e;n++)t[n]=this.disposables[n];this.disposables=[];for(var r=0;r<e;r++)t[r].dispose()}}},{key:"dispose",value:function(){if(!this.isDisposed){this.isDisposed=!0;for(var e=this.disposables.length,t=new Array(e),n=0;n<e;n++)t[n]=this.disposables[n];this.disposables=[];for(var r=0;r<e;r++)t[r].dispose()}}}]),e}(),ve=function(){function e(){he(this,e),this.isDisposed=!1}return fe(e,[{key:"getDisposable",value:function(){return this.current}},{key:"setDisposable",value:function(e){var t=this.isDisposed;if(!t){var n=this.current;this.current=e,n&&n.dispose()}t&&e&&e.dispose()}},{key:"dispose",value:function(){if(!this.isDisposed){this.isDisposed=!0;var e=this.current;this.current=void 0,e&&e.dispose()}}}]),e}();function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Re(e);if(t){var i=Re(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return we(this,n)}}function we(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ke(e){var t=e.DecoratedComponent,n=e.createHandler,r=e.createMonitor,i=e.createConnector,a=e.registerHandler,o=e.containerDisplayName,s=e.getType,l=e.collect,c=e.options.arePropsEqual,d=void 0===c?le.a:c,u=t,h=t.displayName||t.name||"Component",p=function(){var e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(f,e);var t,o,c,p=Se(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=p.call(this,e)).decoratedRef=w.createRef(),t.handleChange=function(){var e=t.getCurrentState();Object(le.a)(e,t.state)||t.setState(e)},t.disposable=new ve,t.receiveProps(e),t.dispose(),t}return t=f,(o=[{key:"getHandlerId",value:function(){return this.handlerId}},{key:"getDecoratedComponentInstance",value:function(){return Object(te.a)(this.decoratedRef.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.decoratedRef.current}},{key:"shouldComponentUpdate",value:function(e,t){return!d(e,this.props)||!Object(le.a)(t,this.state)}},{key:"componentDidMount",value:function(){this.disposable=new ve,this.currentType=void 0,this.receiveProps(this.props),this.handleChange()}},{key:"componentDidUpdate",value:function(e){d(this.props,e)||(this.receiveProps(this.props),this.handleChange())}},{key:"componentWillUnmount",value:function(){this.dispose()}},{key:"receiveProps",value:function(e){this.handler&&(this.handler.receiveProps(e),this.receiveType(s(e)))}},{key:"receiveType",value:function(e){if(this.handlerMonitor&&this.manager&&this.handlerConnector&&e!==this.currentType){this.currentType=e;var t=ye(a(e,this.handler,this.manager),2),n=t[0],r=t[1];this.handlerId=n,this.handlerMonitor.receiveHandlerId(n),this.handlerConnector.receiveHandlerId(n);var i=this.manager.getMonitor().subscribeToStateChange(this.handleChange,{handlerIds:[n]});this.disposable.setDisposable(new ge(new me(i),new me(r)))}}},{key:"dispose",value:function(){this.disposable.dispose(),this.handlerConnector&&this.handlerConnector.receiveHandlerId(null)}},{key:"getCurrentState",value:function(){return this.handlerConnector?l(this.handlerConnector.hooks,this.handlerMonitor,this.props):{}}},{key:"render",value:function(){var e=this;return w.createElement(ue.a.Consumer,null,(function(t){var n=t.dragDropManager;return e.receiveDragDropManager(n),"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame((function(){var t;return null===(t=e.handlerConnector)||void 0===t?void 0:t.reconnect()})),w.createElement(u,Object.assign({},e.props,e.getCurrentState(),{ref:se(u)?e.decoratedRef:null}))}))}},{key:"receiveDragDropManager",value:function(e){void 0===this.manager&&(Object(te.a)(void 0!==e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",h,h),void 0!==e&&(this.manager=e,this.handlerMonitor=r(e),this.handlerConnector=i(e.getBackend()),this.handler=n(this.handlerMonitor,this.decoratedRef)))}}])&&Oe(t.prototype,o),c&&Oe(t,c),f}(w.Component);return e.DecoratedComponent=t,e.displayName="".concat(o,"(").concat(h,")"),e}();return de()(p,t)}var Te=n(670),_e=n(1301),Fe=n(1302);function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){return"string"==typeof e||"symbol"===Ee(e)||!!t&&Array.isArray(e)&&e.every((function(e){return Me(e,!1)}))}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pe=["canDrag","beginDrag","isDragging","endDrag"],Ie=["beginDrag"],Ne=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=null,this.beginDrag=function(){if(i.props)return i.spec.beginDrag(i.props,i.monitor,i.ref.current)},this.spec=t,this.monitor=n,this.ref=r}var t,n,r;return t=e,(n=[{key:"receiveProps",value:function(e){this.props=e}},{key:"canDrag",value:function(){return!!this.props&&(!this.spec.canDrag||this.spec.canDrag(this.props,this.monitor))}},{key:"isDragging",value:function(e,t){return!!this.props&&(this.spec.isDragging?this.spec.isDragging(this.props,this.monitor):t===e.getSourceId())}},{key:"endDrag",value:function(){this.props&&this.spec.endDrag&&this.spec.endDrag(this.props,this.monitor,oe(this.ref))}}])&&De(t.prototype,n),r&&De(t,r),e}();function qe(e){return Object.keys(e).forEach((function(t){Object(te.a)(Pe.indexOf(t)>-1,'Expected the drag source specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',Pe.join(", "),t),Object(te.a)("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])})),Ie.forEach((function(t){Object(te.a)("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])})),function(t,n){return new Ne(e,t,n)}}var ze=n(1300),Ae=n(1299);function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=["canDrop","hover","drop"],Le=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props=null,this.spec=t,this.monitor=n,this.ref=r}var t,n,r;return t=e,(n=[{key:"receiveProps",value:function(e){this.props=e}},{key:"receiveMonitor",value:function(e){this.monitor=e}},{key:"canDrop",value:function(){return!this.spec.canDrop||this.spec.canDrop(this.props,this.monitor)}},{key:"hover",value:function(){this.spec.hover&&this.props&&this.spec.hover(this.props,this.monitor,oe(this.ref))}},{key:"drop",value:function(){if(this.spec.drop)return this.spec.drop(this.props,this.monitor,this.ref.current)}}])&&Ue(t.prototype,n),r&&Ue(t,r),e}();function Ve(e){return Object.keys(e).forEach((function(t){Object(te.a)($e.indexOf(t)>-1,'Expected the drop target specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',$e.join(", "),t),Object(te.a)("function"==typeof e[t],"Expected %s in the drop target specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target",t,t,e[t])})),function(t,n){return new Le(e,t,n)}}var He=n(1150),Be=n(1173),We=n.n(Be),Ge=n(519),Ke=n.n(Ge);const Qe=Z.g+1,Ye=Z.g+2,Xe=Z.g+3,Je=Z.g+4,Ze=Z.g+5,et={[I.e]:{[I.k]:Z.g,[I.c]:Z.g},[I.c]:{[I.a]:Qe,[I.h]:Qe,[I.b]:Qe,[I.f]:Qe,[I.g]:Qe,[I.j]:Qe,[I.k]:Qe},[I.j]:{[I.a]:Je,[I.h]:Je,[I.b]:Je},[I.k]:{[I.l]:Ye},[I.l]:{[I.a]:Ye,[I.h]:Ye,[I.b]:Ye,[I.f]:Ye,[I.g]:Ye,[I.j]:Ye,[I.k]:Ye},[I.b]:{[I.a]:Ze,[I.g]:Ze,[I.h]:Ze,[I.j]:Xe,[I.f]:Xe},[I.a]:{},[I.f]:{},[I.g]:{},[I.h]:{}};function tt(e){const{parentType:t,childType:n,parentDepth:r}=e;if(!t||!n||"number"!=typeof r)return!1;const i=(et[t]||{})[n];return"number"==typeof i&&r<=i}let nt={};function rt(e,t){var n;const{depth:r,parentComponent:i,component:a,orientation:o,isDraggingOverShallow:s}=t.props,l=e.getItem();if(!l||l.id===a.id)return null;if(l.type===I.k&&a.type===I.l&&2===r)return null;const c=tt({parentType:a.type,parentDepth:r,childType:l.type}),d=i&&i.type,u=tt({parentType:d,parentDepth:r+(d===I.l||d===I.k?0:-1),childType:l.type});if(!c&&!u)return null;const h=(a.children||[]).length>0,p="row"===o?"vertical":"horizontal",f="row"===o?"horizontal":"vertical";if(s&&c&&!u)return"vertical"===p?h?"DROP_RIGHT":"DROP_LEFT":h?"DROP_BOTTOM":"DROP_TOP";const b=t.ref.getBoundingClientRect(),m=e.getClientOffset()||nt[a.id];if(!m||!b)return null;nt[a.id]=m;const g=Math.abs(m.y-b.top),v=Math.abs(m.y-b.bottom),j=Math.abs(m.x-b.left),y=Math.abs(m.x-b.right);if(!s&&Ke()(n=[g,v,j,y]).call(n,e=>e>20))return null;if(u&&!c){if("vertical"===f){const e=b.left+(b.right-b.left)/2;return m.x<e?"DROP_LEFT":"DROP_RIGHT"}const e=b.top+(b.bottom-b.top)/2;return m.y<e?"DROP_TOP":"DROP_BOTTOM"}if(u&&c){if("vertical"===f){if(j<20)return"DROP_LEFT";if(y<20)return"DROP_RIGHT"}else{if(g<20)return"DROP_TOP";if(v<20)return"DROP_BOTTOM"}return"vertical"===p?h?"DROP_RIGHT":"DROP_LEFT":h?"DROP_BOTTOM":"DROP_TOP"}return null}var it=n(1174),at=n.n(it);let ot;var st=We()((function(e,t,n){var r,i;if(!n.mounted)return;const a=rt(t,n);!function(e){const t="SCROLL_TOP"===e&&!ot&&0!==document.documentElement.scrollTop,n=ot&&("SCROLL_TOP"!==e||0===document.documentElement.scrollTop);t?ot=at()(()=>{if(0===document.documentElement.scrollTop)return clearInterval(ot),void(ot=null);let e=document.documentElement.scrollTop-120;e<0&&(e=0),window.scroll({top:e,behavior:"smooth"})},50):n&&(clearInterval(ot),ot=null)}((null==n?void 0:null==(r=n.props)?void 0:null==(i=r.component)?void 0:i.type)===I.e?"SCROLL_TOP":null),a?n.setState(()=>({dropIndicator:a})):n.setState(()=>({dropIndicator:null}))}),100);function lt(e,t,n){if(!n.mounted)return;n.setState(()=>({dropIndicator:null}));const r=rt(t,n);if(!r)return;const{parentComponent:i,component:a,index:o,onDrop:s,orientation:l}=n.props,c=t.getItem(),d="row"===l&&("DROP_TOP"===r||"DROP_BOTTOM"===r)||"column"===l&&("DROP_LEFT"===r||"DROP_RIGHT"===r)?"sibling":"child",u={source:{id:c.parentId,type:c.parentType,index:c.index},dragging:{id:c.id,type:c.type,meta:c.meta}};if("child"===d)u.destination={id:a.id,type:a.type,index:a.children.length};else{let e=i&&c.parentId===i.id&&c.index<o?o-1:o;"DROP_BOTTOM"!==r&&"DROP_RIGHT"!==r||(e+=1),u.destination={id:i.id,type:i.type,index:e}}return s(u),nt={},u}const ct="DRAG_DROPPABLE",dt=[ct,{canDrag:e=>!e.disableDragDrop,beginDrag(e){const{component:t,index:n,parentComponent:r={}}=e;return{type:t.type,id:t.id,meta:t.meta,index:n,parentId:r.id,parentType:r.type}}},function(e,t){return{dragSourceRef:e.dragSource(),dragPreviewRef:e.dragPreview(),isDragging:t.isDragging()}}],ut=[ct,{canDrop:e=>!e.disableDragDrop,hover(e,t,n){n&&n.mounted&&st(e,t,n)},drop(e,t,n){const r=t.getDropResult();if((!r||!r.destination)&&n.mounted)return lt(0,t,n)}},function(e,t){return{droppableRef:e.dropTarget(),isDraggingOver:t.isOver(),isDraggingOverShallow:t.isOver({shallow:!0})}}],ht={children:T.a.func,className:T.a.string,component:He.b.isRequired,parentComponent:He.b,depth:T.a.number.isRequired,disableDragDrop:T.a.bool,orientation:T.a.oneOf(["row","column"]),index:T.a.number.isRequired,style:T.a.object,onDrop:T.a.func,editMode:T.a.bool.isRequired,useEmptyDragPreview:T.a.bool,isDragging:T.a.bool.isRequired,isDraggingOver:T.a.bool.isRequired,isDraggingOverShallow:T.a.bool.isRequired,droppableRef:T.a.func.isRequired,dragSourceRef:T.a.func.isRequired,dragPreviewRef:T.a.func.isRequired},pt={className:null,style:null,parentComponent:null,disableDragDrop:!1,children(){},onDrop(){},orientation:"row",useEmptyDragPreview:!1};class ft extends R.a.Component{constructor(e){var t;super(e),this.state={dropIndicator:null},this.setRef=S()(t=this.setRef).call(t,this)}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}setRef(e){this.ref=e,this.props.useEmptyDragPreview?this.props.dragPreviewRef(Object(ee.a)(),{captureDraggingState:!0}):this.props.dragPreviewRef(e),this.props.droppableRef(e)}render(){const{children:e,className:t,orientation:n,dragSourceRef:r,disableDragDrop:i,isDragging:a,isDraggingOver:o,style:s,editMode:l}=this.props,{dropIndicator:c}=this.state,d=o&&c&&!i?{className:U()("drop-indicator","DROP_TOP"===c&&"drop-indicator--top","DROP_BOTTOM"===c&&"drop-indicator--bottom","DROP_LEFT"===c&&"drop-indicator--left","DROP_RIGHT"===c&&"drop-indicator--right")}:null,u=l?{dragSourceRef:r,dropIndicatorProps:d}:{};return Object(L.jsx)("div",{style:s,ref:this.setRef,className:U()("dragdroppable","row"===n&&"dragdroppable-row","column"===n&&"dragdroppable-column",a&&"dragdroppable--dragging",t)},e(u))}}ft.propTypes=ht,ft.defaultProps=pt;var bt=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e;"function"!=typeof e&&(Object(te.a)(Me(e),'Expected "type" provided as the first argument to DragSource to be a string, or a function that returns a string given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',e),i=function(){return e}),Object(te.a)(ae(t),'Expected "spec" provided as the second argument to DragSource to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',t);var a=qe(t);return Object(te.a)("function"==typeof n,'Expected "collect" provided as the third argument to DragSource to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',n),Object(te.a)(ae(r),'Expected "options" provided as the fourth argument to DragSource to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',n),function(e){return ke({containerDisplayName:"DragSource",createHandler:a,registerHandler:Te.a,createConnector:function(e){return new Fe.a(e)},createMonitor:function(e){return new _e.a(e)},DecoratedComponent:e,getType:i,collect:n,options:r})}}(...dt)(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e;"function"!=typeof e&&(Object(te.a)(Me(e,!0),'Expected "type" provided as the first argument to DropTarget to be a string, an array of strings, or a function that returns either given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',e),i=function(){return e}),Object(te.a)(ae(t),'Expected "spec" provided as the second argument to DropTarget to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',t);var a=Ve(t);return Object(te.a)("function"==typeof n,'Expected "collect" provided as the third argument to DropTarget to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',n),Object(te.a)(ae(r),'Expected "options" provided as the fourth argument to DropTarget to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',n),function(e){return ke({containerDisplayName:"DropTarget",createHandler:a,registerHandler:Te.b,createMonitor:function(e){return new Ae.a(e)},createConnector:function(e){return new ze.a(e)},DecoratedComponent:e,getType:i,collect:n,options:r})}}(...ut)(ft));const mt={id:T.a.string.isRequired,type:T.a.string.isRequired,label:T.a.string.isRequired,className:T.a.string};class gt extends R.a.PureComponent{render(){const{label:e,id:t,type:n,className:r}=this.props;return Object(L.jsx)(bt,{component:{type:n,id:t},parentComponent:{id:Z.v,type:I.i},index:0,depth:0,editMode:!0},({dragSourceRef:t})=>Object(L.jsx)("div",{ref:t,className:"new-component"},Object(L.jsx)("div",{className:U()("new-component-placeholder",r)}),e))}}function vt(){return Object(L.jsx)(gt,{id:Z.u,type:I.b,label:Object(_.e)("Column"),className:"fa fa-long-arrow-down"})}function jt(){return Object(L.jsx)(gt,{id:Z.w,type:I.f,label:Object(_.e)("Divider"),className:"divider-placeholder"})}function yt(){return Object(L.jsx)(gt,{id:Z.x,type:I.g,label:Object(_.e)("Header"),className:"fa fa-header"})}function xt(){return Object(L.jsx)(gt,{id:Z.z,type:I.j,label:Object(_.e)("Row"),className:"fa fa-long-arrow-right"})}function Ot(){return Object(L.jsx)(gt,{id:Z.A,type:I.k,label:Object(_.e)("Tabs"),className:"fa fa-window-restore"})}function Ct(){return Object(L.jsx)(gt,{id:Z.y,type:I.h,label:"Markdown",className:"fa fa-code"})}gt.propTypes=mt,gt.defaultProps={className:null};var St=n(713),wt=n(86),Rt=n.n(wt),kt=n(11),Tt=n.n(kt),_t=n(161),Ft=n.n(_t),Et=n(90),Mt=n.n(Et),Dt=n(4977),Pt=n.n(Dt),It=n(300),Nt=n.n(It),qt=n(217),zt=n.n(qt),At=n(265),Ut=n.n(At),$t=n(255),Lt=n.n($t),Vt=n(256),Ht=n.n(Vt),Bt=n(4630),Wt=n(4628),Gt=function(e){function t(){var e,n,r,i;zt()(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=Lt()(this,(e=t.__proto__||Nt()(t)).call.apply(e,[this].concat(o))),r._cellRenderer=function(e){var t=e.parent,n=e.rowIndex,i=e.style,a=e.isScrolling,o=e.isVisible,s=e.key,l=r.props.rowRenderer;return Pt()(i,"width").writable&&(i.width="100%"),l({index:n,style:i,isScrolling:a,isVisible:o,key:s,parent:t})},r._setRef=function(e){r.Grid=e},r._onScroll=function(e){var t=e.clientHeight,n=e.scrollHeight,i=e.scrollTop;(0,r.props.onScroll)({clientHeight:t,scrollHeight:n,scrollTop:i})},r._onSectionRendered=function(e){var t=e.rowOverscanStartIndex,n=e.rowOverscanStopIndex,i=e.rowStartIndex,a=e.rowStopIndex;(0,r.props.onRowsRendered)({overscanStartIndex:t,overscanStopIndex:n,startIndex:i,stopIndex:a})},i=n,Lt()(r,i)}return Ht()(t,e),Ut()(t,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(e){var t=e.alignment,n=e.index;return this.Grid?this.Grid.getOffsetForCell({alignment:t,rowIndex:n,columnIndex:0}).scrollTop:0}},{key:"invalidateCellSizeAfterRender",value:function(e){var t=e.columnIndex,n=e.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:n,columnIndex:t})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.columnIndex,n=void 0===t?0:t,r=e.rowIndex,i=void 0===r?0:r;this.Grid&&this.Grid.recomputeGridSize({rowIndex:i,columnIndex:n})}},{key:"recomputeRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:e,columnIndex:0})}},{key:"scrollToPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:e})}},{key:"scrollToRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:e})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.noRowsRenderer,r=e.scrollToIndex,i=e.width,a=U()("ReactVirtualized__List",t);return w.createElement(Bt.a,Mt()({},this.props,{autoContainerWidth:!0,cellRenderer:this._cellRenderer,className:a,columnWidth:i,columnCount:1,noContentRenderer:n,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,scrollToRow:r}))}}]),t}(w.PureComponent);Gt.defaultProps={autoHeight:!1,estimatedRowSize:30,onScroll:function(){},noRowsRenderer:function(){return null},onRowsRendered:function(){},overscanIndicesGetter:Wt.a,overscanRowCount:10,scrollToAlignment:"auto",scrollToIndex:-1,style:{}},Gt.propTypes=null;var Kt=Gt,Qt=n(4974),Yt=n(19),Xt=n(212);const Jt={datasourceUrl:T.a.string,datasourceName:T.a.string,innerRef:T.a.func,isSelected:T.a.bool,lastModified:T.a.string,sliceName:T.a.string.isRequired,style:T.a.object,visType:T.a.string.isRequired},Zt=$.g.div`
  ${({theme:e})=>`\n    .chart-card {\n      border: 1px solid ${e.colors.grayscale.light2};\n      border-radius: ${e.gridUnit}px;\n      background: ${e.colors.grayscale.light5};\n      font-weight: ${e.typography.weights.light};\n      padding: ${2*e.gridUnit}px;\n      margin: 0 ${3*e.gridUnit}px\n        ${3*e.gridUnit}px\n        ${3*e.gridUnit}px;\n      position: relative;\n      cursor: move;\n      white-space: nowrap;\n      overflow: hidden;\n\n      &:hover {\n        background: ${e.colors.grayscale.light4};\n      }\n    }\n\n    .chart-card.is-selected {\n      cursor: not-allowed;\n      opacity: 0.4;\n    }\n\n    .card-title {\n      margin-right: 60px;\n      margin-bottom: ${2*e.gridUnit}px;\n      font-weight: ${e.typography.weights.bold};\n    }\n\n    .card-body {\n      display: flex;\n      flex-direction: column;\n\n      .item {\n        span {\n          word-break: break-all;\n\n          &:first-child {\n            font-weight: ${e.typography.weights.normal};\n          }\n        }\n      }\n    }\n\n    .is-added-label {\n      background: ${e.colors.grayscale.base};\n      border-radius: ${e.gridUnit}px;\n      color: ${e.colors.grayscale.light5};\n      font-size: ${e.typography.sizes.s}px;\n      text-transform: uppercase;\n      position: absolute;\n      padding: ${e.gridUnit}px\n        ${2*e.gridUnit}px;\n      top: ${8*e.gridUnit}px;\n      right: ${8*e.gridUnit}px;\n      pointer-events: none;\n    }\n  `}
`;function en({datasourceUrl:e,datasourceName:t,innerRef:n,isSelected:r,lastModified:i,sliceName:a,style:o,visType:s}){return Object(L.jsx)(Zt,{ref:n,style:o},Object(L.jsx)("div",{className:U()("chart-card",r&&"is-selected")},Object(L.jsx)("div",{className:"card-title"},a),Object(L.jsx)("div",{className:"card-body"},Object(L.jsx)("div",{className:"item"},Object(L.jsx)("span",null,Object(_.e)("Modified")," "),Object(L.jsx)("span",null,i)),Object(L.jsx)("div",{className:"item"},Object(L.jsx)("span",null,Object(_.e)("Visualization")," "),Object(L.jsx)("span",null,s)),Object(L.jsx)("div",{className:"item"},Object(L.jsx)("span",null,Object(_.e)("Data source")," "),Object(L.jsx)("a",{href:e},t)))),r&&Object(L.jsx)("div",{className:"is-added-label"},Object(_.e)("Added")))}en.propTypes=Jt,en.defaultProps={datasourceUrl:null,datasourceName:"-",innerRef:null,isSelected:!1,style:null,lastModified:null};var tn=en;function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function on(e,t,n){return t&&an(e.prototype,t),n&&an(e,n),e}function sn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ln(e,t)}function ln(e,t){return(ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=un(e);if(t){var i=un(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dn(this,n)}}function dn(e,t){return!t||"object"!==nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const hn={position:"fixed",pointerEvents:"none",top:0,left:0,zIndex:101,width:344},pn={dragItem:T.a.shape({index:T.a.number.isRequired}),slices:T.a.arrayOf(He.g),isDragging:T.a.bool.isRequired,currentOffset:T.a.shape({x:T.a.number.isRequired,y:T.a.number.isRequired})};function fn({dragItem:e,slices:t,isDragging:n,currentOffset:r}){if(!(n&&r&&e&&t))return null;const i=t[e.index];return i&&e.parentType===I.i&&e.type===I.a?Object(L.jsx)(tn,{style:{...hn,transform:`translate(${r.x}px, ${r.y}px)`},sliceName:i.slice_name,lastModified:i.changed_on_humanized,visType:i.viz_type,datasourceUrl:i.datasource_url,datasourceName:i.datasource_name}):null}fn.propTypes=pn,fn.defaultProps={currentOffset:null,dragItem:null,slices:null};var bn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(te.a)("function"==typeof e,'Expected "collect" provided as the first argument to DragLayer to be a function that collects props to inject into the component. ',"Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer",e),Object(te.a)(ae(t),'Expected "options" provided as the second argument to DragLayer to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer',t),function(n){var r=n,i=t.arePropsEqual,a=void 0===i?le.a:i,o=r.displayName||r.name||"Component",s=function(){var t=function(t){sn(i,t);var n=cn(i);function i(){var e;return rn(this,i),(e=n.apply(this,arguments)).isCurrentlyMounted=!1,e.ref=w.createRef(),e.handleChange=function(){if(e.isCurrentlyMounted){var t=e.getCurrentState();Object(le.a)(t,e.state)||e.setState(t)}},e}return on(i,[{key:"getDecoratedComponentInstance",value:function(){return Object(te.a)(this.ref.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.ref.current}},{key:"shouldComponentUpdate",value:function(e,t){return!a(e,this.props)||!Object(le.a)(t,this.state)}},{key:"componentDidMount",value:function(){this.isCurrentlyMounted=!0,this.handleChange()}},{key:"componentWillUnmount",value:function(){this.isCurrentlyMounted=!1,this.unsubscribeFromOffsetChange&&(this.unsubscribeFromOffsetChange(),this.unsubscribeFromOffsetChange=void 0),this.unsubscribeFromStateChange&&(this.unsubscribeFromStateChange(),this.unsubscribeFromStateChange=void 0)}},{key:"render",value:function(){var e=this;return w.createElement(ue.a.Consumer,null,(function(t){var n=t.dragDropManager;return void 0===n?null:(e.receiveDragDropManager(n),e.isCurrentlyMounted?w.createElement(r,Object.assign({},e.props,e.state,{ref:se(r)?e.ref:null})):null)}))}},{key:"receiveDragDropManager",value:function(e){if(void 0===this.manager){this.manager=e,Object(te.a)("object"===nn(e),"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",o,o);var t=this.manager.getMonitor();this.unsubscribeFromOffsetChange=t.subscribeToOffsetChange(this.handleChange),this.unsubscribeFromStateChange=t.subscribeToStateChange(this.handleChange)}}},{key:"getCurrentState",value:function(){if(!this.manager)return{};var t=this.manager.getMonitor();return e(t,this.props)}}]),i}(w.Component);return t.displayName="DragLayer(".concat(o,")"),t.DecoratedComponent=n,t}();return de()(s,n)}}(e=>({dragItem:e.getItem(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}))(fn);const mn={fetchAllSlices:T.a.func.isRequired,isLoading:T.a.bool.isRequired,slices:T.a.objectOf(He.g).isRequired,lastUpdated:T.a.number.isRequired,errorMessage:T.a.string,userId:T.a.string.isRequired,selectedSliceIds:T.a.arrayOf(T.a.number),editMode:T.a.bool,height:T.a.number},gn={selectedSliceIds:[],editMode:!1,errorMessage:"",height:window.innerHeight},vn=["slice_name","viz_type","datasource_name"],jn={slice_name:"Name",viz_type:"Vis type",datasource_name:"Dataset",changed_on:"Recent"},yn=$.g.div`
  display: flex;
  flex-direction: row;
  padding: ${({theme:e})=>3*e.gridUnit}px;
`,xn=Object($.g)(Xt.a)`
  margin-left: ${({theme:e})=>2*e.gridUnit}px;
  min-width: 150px;
`;class On extends R.a.Component{static sortByComparator(e){const t="changed_on"===e?-1:1;return(n,r)=>n[e]<r[e]?-1*t:n[e]>r[e]?1*t:0}constructor(e){var t,n,r,i,a;super(e),this.state={filteredSlices:[],searchTerm:"",sortBy:"changed_on",selectedSliceIdsSet:new h.a(e.selectedSliceIds)},this.rowRenderer=S()(t=this.rowRenderer).call(t,this),this.searchUpdated=S()(n=this.searchUpdated).call(n,this),this.handleKeyPress=S()(r=this.handleKeyPress).call(r,this),this.handleChange=S()(i=this.handleChange).call(i,this),this.handleSelect=S()(a=this.handleSelect).call(a,this)}componentDidMount(){this.slicesRequest=this.props.fetchAllSlices(this.props.userId)}UNSAFE_componentWillReceiveProps(e){const t={};var n,r;e.lastUpdated!==this.props.lastUpdated&&(t.filteredSlices=Ft()(n=O()(r=m()(e.slices)).call(r,Object(Qt.createFilter)(this.state.searchTerm,vn))).call(n,On.sortByComparator(this.state.sortBy)));e.selectedSliceIds!==this.props.selectedSliceIds&&(t.selectedSliceIdsSet=new h.a(e.selectedSliceIds)),f()(t).length&&this.setState(t)}componentWillUnmount(){this.slicesRequest&&this.slicesRequest.abort&&this.slicesRequest.abort()}getFilteredSortedSlices(e,t){var n,r;return Ft()(n=O()(r=m()(this.props.slices)).call(r,Object(Qt.createFilter)(e,vn))).call(n,On.sortByComparator(t))}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.searchUpdated(e.target.value))}handleChange(e){this.searchUpdated(e.target.value)}searchUpdated(e){this.setState(t=>({searchTerm:e,filteredSlices:this.getFilteredSortedSlices(e,t.sortBy)}))}handleSelect(e){this.setState(t=>({sortBy:e,filteredSlices:this.getFilteredSortedSlices(t.searchTerm,e)}))}rowRenderer({key:e,index:t,style:n}){const{filteredSlices:r,selectedSliceIdsSet:i}=this.state,a=r[t],o=i.has(a.slice_id),s=I.a,l=Z.t,c={chartId:a.slice_id,sliceName:a.slice_name};return Object(L.jsx)(bt,{key:e,component:{type:s,id:l,meta:c},parentComponent:{id:Z.v,type:I.i},index:t,depth:0,disableDragDrop:o,editMode:this.props.editMode,useEmptyDragPreview:!0,style:{}},({dragSourceRef:e})=>Object(L.jsx)(tn,{innerRef:e,style:n,sliceName:a.slice_name,lastModified:a.changed_on_humanized,visType:a.viz_type,datasourceUrl:a.datasource_url,datasourceName:a.datasource_name,isSelected:o}))}render(){var e;const t=this.props.height-30-64-16;return Object(L.jsx)("div",{className:"slice-adder-container"},Object(L.jsx)(yn,null,Object(L.jsx)(Yt.m,{placeholder:Object(_.e)("Filter your charts"),className:"search-input",onChange:this.handleChange,onKeyPress:this.handleKeyPress}),Object(L.jsx)(xn,{id:"slice-adder-sortby",value:this.state.sortBy,onChange:this.handleSelect,options:Tt()(e=Rt()(jn)).call(e,([e,t])=>({label:`${Object(_.e)("Sort by")} ${t}`,value:e})),placeholder:Object(_.e)("Sort by")})),this.props.isLoading&&Object(L.jsx)(M.a,null),!this.props.isLoading&&this.state.filteredSlices.length>0&&Object(L.jsx)(Kt,{width:376,height:t,rowCount:this.state.filteredSlices.length,rowHeight:112,rowRenderer:this.rowRenderer,searchTerm:this.state.searchTerm,sortBy:this.state.sortBy,selectedSliceIds:this.props.selectedSliceIds}),this.props.errorMessage&&Object(L.jsx)("div",{className:"error-message"},this.props.errorMessage),Object(L.jsx)(bn,{slices:this.state.filteredSlices}))}}On.propTypes=mn,On.defaultProps=gn;var Cn=On;var Sn=Object(i.b)((function({sliceEntities:e,dashboardInfo:t,dashboardState:n}){return{userId:t.userId,selectedSliceIds:n.sliceIds,slices:e.slices,isLoading:e.isLoading,errorMessage:e.errorMessage,lastUpdated:e.lastUpdated,editMode:n.editMode}}),(function(e){return Object(r.b)({fetchAllSlices:St.d},e)}))(Cn);const wn=Object($.g)(H.c)`
  line-height: inherit;
  margin-top: ${({theme:e})=>2*e.gridUnit}px;
`;var Rn=({topOffset:e=0})=>Object(L.jsx)("div",{className:"dashboard-builder-sidepane",style:{height:`calc(100vh - ${e+59}px)`}},Object(L.jsx)(J,null,({height:t})=>Object(L.jsx)(B.StickyContainer,null,Object(L.jsx)(B.Sticky,{topOffset:-e,bottomOffset:1/0},({style:n,isSticky:r})=>Object(L.jsx)("div",{className:"viewport",style:r?{...n,top:e}:null},Object(L.jsx)(wn,{id:"tabs",className:"tabs-components"},Object(L.jsx)(H.c.TabPane,{key:1,tab:Object(_.e)("Components")},Object(L.jsx)(Ot,null),Object(L.jsx)(xt,null),Object(L.jsx)(vt,null),Object(L.jsx)(yt,null),Object(L.jsx)(Ct,null),Object(L.jsx)(jt,null)),Object(L.jsx)(H.c.TabPane,{key:2,tab:Object(_.e)("Charts"),className:"tab-charts"},Object(L.jsx)(Sn,{height:t+(r?59:0)})))))))),kn=n(313),Tn=n(168),_n=n.n(Tn),Fn=n(2163),En=n.n(Fn),Mn=n(37),Dn=n.n(Mn),Pn=n(917),In=n(1128),Nn=n(214),qn=n(42),zn=n(31),An=n(45),Un=n(1929),$n=n(1110),Ln=n(243),Vn=(n(183),n(66)),Hn=n(104),Bn=n(25),Wn=n.n(Bn),Gn=n(1964),Kn=n(326);var Qn=e=>{const{url:t,copyMenuItemTitle:n,emailMenuItemTitle:r,emailSubject:i,emailBody:a,addDangerToast:o,addSuccessToast:s,...l}=e,c=Object(Gn.a)(t);return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Yt.q.Item,Wn()({key:"copy-url"},l),Object(L.jsx)("div",{onClick:async function(){try{const e=await c();await Object(Kn.a)(e),s(Object(_.e)("Copied to clipboard!"))}catch(e){o(Object(_.e)("Sorry, your browser does not support copying."))}},role:"button",tabIndex:0},n)),Object(L.jsx)(Yt.q.Item,Wn()({key:"share-by-email"},l),Object(L.jsx)("div",{onClick:async function(){try{const e=await c(),t=`${a}${e}`;window.location.href=`mailto:?Subject=${i}%20&Body=${t}`}catch(e){o(Object(_.e)("Sorry, something went wrong. Try again later."))}},role:"button",tabIndex:0},r)))},Yn=n(69),Xn=n(249),Jn=n(310);const Zn={initialCss:T.a.string,triggerNode:T.a.node.isRequired,onChange:T.a.func,templates:T.a.array};class er extends R.a.PureComponent{constructor(e){var t,n;super(e),this.state={css:e.initialCss},this.changeCss=S()(t=this.changeCss).call(t,this),this.changeCssTemplate=S()(n=this.changeCssTemplate).call(n,this)}componentDidMount(){Jn.b.preload()}changeCss(e){this.setState({css:e},()=>{this.props.onChange(e)})}changeCssTemplate(e){this.changeCss(e.css)}renderTemplateSelector(){return this.props.templates?Object(L.jsx)("div",{style:{zIndex:10}},Object(L.jsx)("h5",null,Object(_.e)("Load a template")),Object(L.jsx)(Yn.i,{options:this.props.templates,placeholder:Object(_.e)("Load a CSS template"),onChange:this.changeCssTemplate})):null}render(){return Object(L.jsx)(Xn.a,{triggerNode:this.props.triggerNode,modalTitle:Object(_.e)("CSS"),modalBody:Object(L.jsx)("div",null,this.renderTemplateSelector(),Object(L.jsx)("div",{style:{zIndex:1}},Object(L.jsx)("h5",null,Object(_.e)("Live CSS editor")),Object(L.jsx)("div",{style:{border:"solid 1px grey"}},Object(L.jsx)(Jn.b,{minLines:12,maxLines:30,onChange:this.changeCss,height:"200px",width:"100%",editorProps:{$blockScrolling:!0},enableLiveAutocompletion:!0,value:this.state.css||""}))))})}}er.propTypes=Zn,er.defaultProps={initialCss:"",onChange:()=>{}};var tr,nr=er,rr=n(213),ir=n(74);const ar=Tt()(tr=[[0,Object(_.e)("Don't refresh")],[10,Object(_.e)("10 seconds")],[30,Object(_.e)("30 seconds")],[60,Object(_.e)("1 minute")],[300,Object(_.e)("5 minutes")],[1800,Object(_.e)("30 minutes")],[3600,Object(_.e)("1 hour")],[21600,Object(_.e)("6 hours")],[43200,Object(_.e)("12 hours")],[86400,Object(_.e)("24 hours")]]).call(tr,e=>({value:e[0],label:e[1]})),or=Object($.g)(Xn.a)`
  .ant-modal-body {
    overflow: visible;
  }
`,sr=$.g.div`
  margin-top: ${({theme:e})=>6*e.gridUnit}px;
`;class lr extends R.a.PureComponent{constructor(e){var t,n,r;super(e),this.modalRef=void 0,this.modalRef=R.a.createRef(),this.state={refreshFrequency:e.refreshFrequency},this.handleFrequencyChange=S()(t=this.handleFrequencyChange).call(t,this),this.onSave=S()(n=this.onSave).call(n,this),this.onCancel=S()(r=this.onCancel).call(r,this)}onSave(){var e;this.props.onChange(this.state.refreshFrequency,this.props.editMode),null==(e=this.modalRef.current)||e.close()}onCancel(){var e;this.setState({refreshFrequency:this.props.refreshFrequency}),null==(e=this.modalRef.current)||e.close()}handleFrequencyChange(e){const t=e?e.value:ar[0].value;this.setState({refreshFrequency:t})}render(){const{refreshLimit:e=0,refreshWarning:t,editMode:n}=this.props,{refreshFrequency:r=0}=this.state,i=!!r&&!!t&&r<e;return Object(L.jsx)(or,{ref:this.modalRef,triggerNode:this.props.triggerNode,modalTitle:Object(_.e)("Refresh interval"),modalBody:Object(L.jsx)("div",null,Object(L.jsx)(ir.c,null,Object(_.e)("Refresh frequency")),Object(L.jsx)(Yn.i,{options:ar,value:{value:r},onChange:this.handleFrequencyChange,forceOverflow:!0}),i&&Object(L.jsx)(sr,null,Object(L.jsx)(rr.a,{type:"warning",message:Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)("div",null,t),Object(L.jsx)("br",null),Object(L.jsx)("strong",null,Object(_.e)("Are you sure you want to proceed?")))}))),modalFooter:Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(An.a,{buttonStyle:"primary",buttonSize:"small",onClick:this.onSave},n?Object(_.e)("Save"):Object(_.e)("Save for this session")),Object(L.jsx)(An.a,{onClick:this.onCancel,buttonSize:"small"},Object(_.e)("Cancel")))})}}lr.defaultProps={refreshLimit:0,refreshWarning:null};var cr=lr,dr=n(199),ur=n(696);const hr={saveType:Z.D,colorNamespace:void 0,colorScheme:void 0,shouldPersistRefreshFrequency:!1};class pr extends R.a.PureComponent{constructor(e){var t,n,r,i,a,o;super(e),this.modal=void 0,this.onSave=void 0,this.state={saveType:e.saveType,newDashName:`${e.dashboardTitle} [copy]`,duplicateSlices:!1},this.modal=null,this.handleSaveTypeChange=S()(t=this.handleSaveTypeChange).call(t,this),this.handleNameChange=S()(n=this.handleNameChange).call(n,this),this.saveDashboard=S()(r=this.saveDashboard).call(r,this),this.setModalRef=S()(i=this.setModalRef).call(i,this),this.toggleDuplicateSlices=S()(a=this.toggleDuplicateSlices).call(a,this),this.onSave=S()(o=this.props.onSave).call(o,this)}setModalRef(e){this.modal=e}toggleDuplicateSlices(){this.setState(e=>({duplicateSlices:!e.duplicateSlices}))}handleSaveTypeChange(e){this.setState({saveType:e.target.value})}handleNameChange(e){this.setState({newDashName:e,saveType:Z.C})}saveDashboard(){var e;const{saveType:t,newDashName:n}=this.state,{dashboardTitle:r,dashboardInfo:i,layout:a,customCss:o,colorNamespace:s,colorScheme:l,expandedSlices:c,dashboardId:d,refreshFrequency:u,shouldPersistRefreshFrequency:h,lastModifiedTime:p}=this.props,f=Pn.b.getScale(l,s),b=l?f.getColorMap():{},m=h?u:null==(e=i.metadata)?void 0:e.refresh_frequency,g={positions:a,css:o,color_namespace:s,color_scheme:l,label_colors:b,expanded_slices:c,dashboard_title:t===Z.C?n:r,duplicate_slices:this.state.duplicateSlices,refresh_frequency:m,last_modified_time:p};var v;t!==Z.C||n?(this.onSave(g,d,t).then(e=>{t===Z.C&&e&&e.json&&e.json.id&&(window.location.href=`/superset/dashboard/${e.json.id}/`)}),null==(v=this.modal)||v.close()):this.props.addDangerToast(Object(_.e)("You must pick a name for the new dashboard"))}render(){return Object(L.jsx)(Xn.a,{ref:this.setModalRef,triggerNode:this.props.triggerNode,modalTitle:Object(_.e)("Save dashboard"),modalBody:Object(L.jsx)("div",null,Object(L.jsx)(dr.a,{value:Z.D,onChange:this.handleSaveTypeChange,checked:this.state.saveType===Z.D,disabled:!this.props.canOverwrite},Object(_.e)("Overwrite Dashboard [%s]",this.props.dashboardTitle)),Object(L.jsx)("hr",null),Object(L.jsx)(dr.a,{value:Z.C,onChange:this.handleSaveTypeChange,checked:this.state.saveType===Z.C},Object(_.e)("Save as:")),Object(L.jsx)(Yt.m,{type:"text",placeholder:Object(_.e)("[dashboard name]"),value:this.state.newDashName,onFocus:e=>this.handleNameChange(e.target.value),onChange:e=>this.handleNameChange(e.target.value)}),Object(L.jsx)("div",{className:"m-l-25 m-t-5"},Object(L.jsx)(ur.c,{checked:this.state.duplicateSlices,onChange:()=>this.toggleDuplicateSlices()}),Object(L.jsx)("span",{className:"m-l-5"},Object(_.e)("also copy (duplicate) charts")))),modalFooter:Object(L.jsx)("div",null,Object(L.jsx)(An.a,{buttonStyle:"primary",onClick:this.saveDashboard},Object(_.e)("Save")))})}}pr.defaultProps=hr;var fr=pr,br=n(4823),mr=n(246),gr=n(263),vr=n(330),jr=n.n(vr);const yr=[I.l,I.e];function xr({components:e={},filterFields:t=[],selectedChartId:n}){if(jr()(e))return[];return[{...function e({currentNode:t={},components:n={},filterFields:r=[],selectedChartId:i}){if(!t)return null;const{type:a}=t;if(I.a===a&&t&&t.meta&&t.meta.chartId){const e={value:t.meta.chartId,label:t.meta.sliceName||`${a} ${t.meta.chartId}`,type:a,showCheckbox:i!==t.meta.chartId};return{...e,children:Tt()(r).call(r,n=>({value:`${t.meta.chartId}:${n}`,label:`${e.label}`,type:"filter_box",showCheckbox:!1}))}}let o=[];var s;if(t.children&&t.children.length&&v()(s=t.children).call(s,t=>{const a=e({currentNode:n[t],components:n,filterFields:r,selectedChartId:i}),s=n[t].type;l()(yr).call(yr,s)?o.push(a):o=d()(o).call(o,a)}),l()(yr).call(yr,a)){let e=null;return e=a===I.e?Object(_.e)("All charts"):t.meta&&t.meta.text?t.meta.text:`${a} ${t.id}`,{value:t.id,label:e,type:a,children:o}}return o}({currentNode:e[Z.h],components:e,filterFields:t,selectedChartId:n})}]}function Or(e=[],t=-1){const n=[],r=(e,i)=>{var a;e&&(e.children&&(-1===t||i<t)&&(n.push(e.value),v()(a=e.children).call(a,e=>r(e,i+1))))};return e.length>0&&v()(e).call(e,e=>{r(e,0)}),n}function Cr({activeFilterField:e,checkedFilterFields:t}){return Object(Ln.a)(e?[e]:t)}var Sr=n(128),wr=n.n(Sr),Rr=n(496);function kr({activeFilterField:e,checkedFilterFields:t}){if(e)return Object(Rr.a)(e).chartId;if(t.length){const{chartId:e}=Object(Rr.a)(t[0]);return wr()(t).call(t,t=>Object(Rr.a)(t).chartId!==e)?null:e}return null}function Tr({checkedFilterFields:e=[],activeFilterField:t,filterScopeMap:n={},layout:r={}}){const i=Cr({checkedFilterFields:e,activeFilterField:t}),a=t?[t]:e,o=xr({components:r,filterFields:a,selectedChartId:kr({checkedFilterFields:e,activeFilterField:t})}),s=new h.a;v()(a).call(a,e=>{var t;v()(t=n[e].checked||[]).call(t,t=>{s.add(`${t}:${e}`)})});const l=[...s],c=n[i]?n[i].expanded:Or(o,1);return{[i]:{nodes:o,nodesFiltered:[...o],checked:l,expanded:c}}}var _r=n(4980),Fr=n.n(_r),Er=n(1637),Mr=n.n(Er),Dr=n(1632),Pr=n.n(Dr),Ir=n(1636),Nr=n.n(Ir);function qr({tabScopes:e,parentNodeValue:t,forceAggregate:n=!1,hasChartSiblings:r=!1,tabChildren:i=[],immuneChartSiblings:a=[]}){var o,s,c;if(n||!r&&Ke()(o=Rt()(e)).call(o,([e,{scope:t}])=>t&&t.length&&e===t[0])){const n=function({tabs:e=[],tabsInScope:t=[]}){const n=[];return v()(e).call(e,({value:e,children:r})=>{r&&!l()(t).call(t,e)&&v()(r).call(r,({value:e,children:r})=>{r&&!l()(t).call(t,e)&&n.push(...O()(r).call(r,({type:e})=>e===I.a))})}),Tt()(n).call(n,({value:e})=>e)}({tabs:i,tabsInScope:Fr()(e,({scope:e})=>e)}),r=Fr()(m()(e),({immune:e})=>e);return{scope:[t],immune:[...new h.a([...n,...r])]}}const u=O()(s=m()(e)).call(s,({scope:e})=>e&&e.length);return{scope:Fr()(u,({scope:e})=>e),immune:u.length?Fr()(u,({immune:e})=>e):d()(c=Fr()(m()(e),({immune:e})=>e)).call(c,a)}}function zr({filterKey:e,nodes:t=[],checkedChartIds:n=[]}){if(t.length){const{chartId:r}=Object(Rr.a)(e);return function e({currentNode:t={},filterId:n,checkedChartIds:r=[]}){var i;if(!t)return{};const{value:a,children:o}=t,s=O()(o).call(o,({type:e})=>e===I.a),c=O()(o).call(o,({type:e})=>e===I.l),u=Tt()(i=O()(s).call(s,({value:e})=>n!==e&&!l()(r).call(r,e))).call(i,({value:e})=>e),h=Nr()(Pr()(e=>e.value),Mr()(t=>e({currentNode:t,filterId:n,checkedChartIds:r})))(c);if(!jr()(s)&&wr()(s).call(s,({value:e})=>l()(r).call(r,e))){if(jr()(c))return{scope:[a],immune:u};const{scope:e,immune:t}=qr({tabScopes:h,parentNodeValue:a,forceAggregate:!0,tabChildren:c});return{scope:e,immune:d()(u).call(u,t)}}return c.length?qr({tabScopes:h,parentNodeValue:a,hasChartSiblings:!jr()(s),tabChildren:c,immuneChartSiblings:u}):{scope:[],immune:u}}({currentNode:t[0],filterId:r,checkedChartIds:n})}return{}}var Ar=n(138),Ur=n.n(Ar);var $r=n(376),Lr=n(4828),Vr=n.n(Lr);var Hr=()=>Object(L.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(L.jsx)("rect",{x:"0.5",y:"0.5",width:"17",height:"17",rx:"2.5",fill:"#EFF9F9",stroke:"#B3DADC"}),Object(L.jsx)("rect",{x:"8",y:"4",width:"2",height:"10",rx:"1",fill:"#B3DADC"}),Object(L.jsx)("rect",{x:"12",y:"10",width:"2",height:"4",rx:"1",fill:"#B3DADC"}),Object(L.jsx)("rect",{x:"4",y:"6",width:"2",height:"8",rx:"1",fill:"#B3DADC"}));function Br({nodes:e,selectedChartId:t}){return e?Tt()(e).call(e,e=>function e({currentNode:t={},selectedChartId:n}){if(!t)return null;const{label:r,value:i,type:a,children:o}=t;if(o&&o.length){const s=Tt()(o).call(o,t=>e({currentNode:t,selectedChartId:n}));return{...t,label:Object(L.jsx)("span",{className:U()(`filter-scope-type ${a.toLowerCase()}`,{"selected-filter":n===i})},a===I.a&&Object(L.jsx)("span",{className:"type-indicator"},Object(L.jsx)(Hr,null)),r),children:s}}return{...t,label:Object(L.jsx)("span",{className:U()(`filter-scope-type ${a.toLowerCase()}`,{"selected-filter":n===i})},r)}}({currentNode:e,selectedChartId:t})):[]}n(4981);var Wr=n(1286);var Gr={check:Object(L.jsx)(Wr.a,null),uncheck:Object(L.jsx)(Wr.c,null),halfCheck:Object(L.jsx)(Wr.b,null),expandClose:Object(L.jsx)("span",{className:"rct-icon rct-icon-expand-close"}),expandOpen:Object(L.jsx)("span",{className:"rct-icon rct-icon-expand-open"}),expandAll:Object(L.jsx)("span",{className:"rct-icon rct-icon-expand-all"},Object(_.e)("Expand all")),collapseAll:Object(L.jsx)("span",{className:"rct-icon rct-icon-collapse-all"},Object(_.e)("Collapse all")),parentClose:Object(L.jsx)("span",{className:"rct-icon rct-icon-parent-close"}),parentOpen:Object(L.jsx)("span",{className:"rct-icon rct-icon-parent-open"}),leaf:Object(L.jsx)("span",{className:"rct-icon rct-icon-leaf"})};const Kr={nodes:T.a.arrayOf(He.f).isRequired,checked:T.a.arrayOf(T.a.oneOfType([T.a.number,T.a.string])).isRequired,expanded:T.a.arrayOf(T.a.oneOfType([T.a.number,T.a.string])).isRequired,onCheck:T.a.func.isRequired,onExpand:T.a.func.isRequired,selectedChartId:T.a.number},Qr=()=>{};function Yr({nodes:e=[],checked:t=[],expanded:n=[],onCheck:r,onExpand:i,selectedChartId:a}){return Object(L.jsx)(Vr.a,{showExpandAll:!0,expandOnClick:!0,showNodeIcon:!1,nodes:Br({nodes:e,selectedChartId:a}),checked:t,expanded:n,onCheck:r,onExpand:i,onClick:Qr,icons:Gr})}Yr.propTypes=Kr,Yr.defaultProps={selectedChartId:null};const Xr={label:T.a.string.isRequired,isSelected:T.a.bool.isRequired};function Jr({label:e,isSelected:t}){return Object(L.jsx)("span",{className:U()("filter-field-item filter-container",{"is-selected":t})},Object(L.jsx)(ir.c,{htmlFor:e},e))}function Zr({nodes:e,activeKey:t}){if(!e)return[];const n=e[0],r=n.children,i=Tt()(r).call(r,e=>{var n;return{...e,children:Tt()(n=e.children).call(n,e=>{const{label:n,value:r}=e;return{...e,label:Object(L.jsx)(Jr,{isSelected:r===t,label:n})}})}});return[{...n,label:Object(L.jsx)("span",{className:"root"},n.label),children:i}]}Jr.propTypes=Xr;const ei={activeKey:T.a.string,nodes:T.a.arrayOf(He.f).isRequired,checked:T.a.arrayOf(T.a.oneOfType([T.a.number,T.a.string])).isRequired,expanded:T.a.arrayOf(T.a.oneOfType([T.a.number,T.a.string])).isRequired,onCheck:T.a.func.isRequired,onExpand:T.a.func.isRequired,onClick:T.a.func.isRequired};function ti({activeKey:e,nodes:t=[],checked:n=[],expanded:r=[],onClick:i,onCheck:a,onExpand:o}){return Object(L.jsx)(Vr.a,{showExpandAll:!0,showNodeIcon:!1,expandOnClick:!0,nodes:Zr({nodes:t,activeKey:e}),checked:n,expanded:r,onClick:i,onCheck:a,onExpand:o,icons:Gr})}ti.propTypes=ei,ti.defaultProps={activeKey:null};const ni={dashboardFilters:T.a.objectOf(He.c).isRequired,layout:T.a.object.isRequired,updateDashboardFiltersScope:T.a.func.isRequired,setUnsavedChanges:T.a.func.isRequired,onCloseModal:T.a.func.isRequired},ri=$.g.div`
  height: ${({theme:e})=>16*e.gridUnit}px;

  // TODO: replace hardcoded color with theme variable after refactoring filter-scope-selector.less to Emotion
  border-top: ${({theme:e})=>e.gridUnit/4}px solid #cfd8dc;
  padding: ${({theme:e})=>6*e.gridUnit}px;
  margin: 0 0 0 ${({theme:e})=>6*-e.gridUnit}px;
  text-align: right;

  .btn {
    margin-right: ${({theme:e})=>4*e.gridUnit}px;

    &:last-child {
      margin-right: 0;
    }
  }
`;class ii extends R.a.PureComponent{constructor(e){var t,n,r,i,a,o,s,l,c;super(e);const{dashboardFilters:u,layout:h}=e;if(f()(u).length>0){var p,b;const e=function({dashboardFilters:e={}}){var t;const n=Tt()(t=m()(e)).call(t,e=>{var t;const{chartId:n,filterName:r,columns:i,labels:a}=e,o=Tt()(t=f()(i)).call(t,e=>({value:Object(Rr.b)({chartId:n,column:e}),label:a[e]||e}));return{value:n,label:r,children:o,showCheckbox:!0}});return[{value:Z.a,type:I.e,label:Object(_.e)("All filters"),children:n}]}({dashboardFilters:u}),t=e[0].children;this.allfilterFields=[],v()(t).call(t,({children:e})=>{v()(e).call(e,e=>{this.allfilterFields.push(e.value)})}),this.defaultFilterKey=t[0].children[0].value;const n=P()(p=m()(u)).call(p,(e,{chartId:t,columns:n})=>{var r;return{...e,...P()(r=f()(n)).call(r,(e,n)=>{var r;const i=Object(Rr.b)({chartId:t,column:n}),a=xr({components:h,filterFields:[i],selectedChartId:t}),o=Or(a,1),s=O()(r=Object($r.d)({filterScope:u[t].scopes[n]})||[]).call(r,e=>e!==t);return{...e,[i]:{nodes:a,nodesFiltered:[...a],checked:s,expanded:o}}},{})}},{}),{chartId:r}=Object(Rr.a)(this.defaultFilterKey),i=[],a=this.defaultFilterKey,o=d()(b=[Z.a]).call(b,r),s=Tr({checkedFilterFields:i,activeFilterField:a,filterScopeMap:n,layout:h});this.state={showSelector:!0,activeFilterField:a,searchText:"",filterScopeMap:{...n,...s},filterFieldNodes:e,checkedFilterFields:i,expandedFilterIds:o}}else this.state={showSelector:!1};this.filterNodes=S()(t=this.filterNodes).call(t,this),this.onChangeFilterField=S()(n=this.onChangeFilterField).call(n,this),this.onCheckFilterScope=S()(r=this.onCheckFilterScope).call(r,this),this.onExpandFilterScope=S()(i=this.onExpandFilterScope).call(i,this),this.onSearchInputChange=S()(a=this.onSearchInputChange).call(a,this),this.onCheckFilterField=S()(o=this.onCheckFilterField).call(o,this),this.onExpandFilterField=S()(s=this.onExpandFilterField).call(s,this),this.onClose=S()(l=this.onClose).call(l,this),this.onSave=S()(c=this.onSave).call(c,this)}onCheckFilterScope(e=[]){const{activeFilterField:t,filterScopeMap:n,checkedFilterFields:r}=this.state,i=Cr({activeFilterField:t,checkedFilterFields:r}),a=t?[t]:r,o={...n[i],checked:e},s=function({checked:e=[],filterFields:t=[],filterScopeMap:n={}}){const r=P()(e).call(e,(e,t)=>{var n;const[r,i]=t.split(":");return{...e,[i]:d()(n=e[i]||[]).call(n,Ur()(r,10))}},{});return P()(t).call(t,(e,t)=>{var i;const{chartId:a}=Object(Rr.a)(t),o=O()(i=r[t]||[]).call(i,e=>e!==a);return{...e,[t]:{...n[t],checked:o}}},{})}({checked:e,filterFields:a,filterScopeMap:n});this.setState(()=>({filterScopeMap:{...n,...s,[i]:o}}))}onExpandFilterScope(e=[]){const{activeFilterField:t,checkedFilterFields:n,filterScopeMap:r}=this.state,i=Cr({activeFilterField:t,checkedFilterFields:n}),a={...r[i],expanded:e};this.setState(()=>({filterScopeMap:{...r,[i]:a}}))}onCheckFilterField(e=[]){const{layout:t}=this.props,{filterScopeMap:n}=this.state,r=Tr({checkedFilterFields:e,activeFilterField:null,filterScopeMap:n,layout:t});this.setState(()=>({activeFilterField:null,checkedFilterFields:e,filterScopeMap:{...n,...r}}))}onExpandFilterField(e=[]){this.setState(()=>({expandedFilterIds:e}))}onChangeFilterField(e={}){var t;const{layout:n}=this.props,r=e.value,{activeFilterField:i,checkedFilterFields:a,filterScopeMap:o}=this.state;if(r===i){const e=Tr({checkedFilterFields:a,activeFilterField:null,filterScopeMap:o,layout:n});this.setState({activeFilterField:null,filterScopeMap:{...o,...e}})}else if(l()(t=this.allfilterFields).call(t,r)){const e=Tr({checkedFilterFields:a,activeFilterField:r,filterScopeMap:o,layout:n});this.setState({activeFilterField:r,filterScopeMap:{...o,...e}})}}onSearchInputChange(e){this.setState({searchText:e.target.value},this.filterTree)}onClose(){this.props.onCloseModal()}onSave(){var e;const{filterScopeMap:t}=this.state,n=P()(e=this.allfilterFields).call(e,(e,n)=>{const{nodes:r}=t[n];return{...e,[n]:zr({filterKey:n,nodes:r,checkedChartIds:t[n].checked})}},{});this.props.updateDashboardFiltersScope(n),this.props.setUnsavedChanges(!0),this.props.onCloseModal()}filterTree(){if(this.state.searchText){const e=e=>{var t;const{activeFilterField:n,checkedFilterFields:r,filterScopeMap:i}=e,a=Cr({activeFilterField:n,checkedFilterFields:r}),o=P()(t=i[a].nodes).call(t,this.filterNodes,[]),s=Or([...o]),l={...i[a],nodesFiltered:o,expanded:s};return{filterScopeMap:{...i,[a]:l}}};this.setState(e)}else this.setState(e=>{const{activeFilterField:t,checkedFilterFields:n,filterScopeMap:r}=e,i=Cr({activeFilterField:t,checkedFilterFields:n}),a={...r[i],nodesFiltered:r[i].nodes};return{filterScopeMap:{...r,[i]:a}}})}filterNodes(e=[],t={}){var n,r;const{searchText:i}=this.state,a=P()(n=t.children||[]).call(n,this.filterNodes,[]);return(y()(r=t.label.toLocaleLowerCase()).call(r,i.toLocaleLowerCase())>-1||a.length)&&e.push({...t,children:a}),e}renderFilterFieldList(){const{activeFilterField:e,filterFieldNodes:t,checkedFilterFields:n,expandedFilterIds:r}=this.state;return Object(L.jsx)(ti,{activeKey:e,nodes:t,checked:n,expanded:r,onClick:this.onChangeFilterField,onCheck:this.onCheckFilterField,onExpand:this.onExpandFilterField})}renderFilterScopeTree(){const{filterScopeMap:e,activeFilterField:t,checkedFilterFields:n,searchText:r}=this.state,i=Cr({activeFilterField:t,checkedFilterFields:n}),a=kr({activeFilterField:t,checkedFilterFields:n});return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)("input",{className:"filter-text scope-search multi-edit-mode",placeholder:Object(_.e)("Search..."),type:"text",value:r,onChange:this.onSearchInputChange}),Object(L.jsx)(Yr,{nodes:e[i].nodesFiltered,checked:e[i].checked,expanded:e[i].expanded,onCheck:this.onCheckFilterScope,onExpand:this.onExpandFilterScope,selectedChartId:a}))}renderEditingFiltersName(){var e,t;const{dashboardFilters:n}=this.props,{activeFilterField:r,checkedFilterFields:i}=this.state,a=Tt()(e=d()(t=[]).call(t,r||i)).call(e,e=>{const{chartId:t,column:r}=Object(Rr.a)(e);return n[t].labels[r]||r});return Object(L.jsx)("div",{className:"selected-fields multi-edit-mode"},0===a.length&&Object(_.e)("No filter is selected."),1===a.length&&Object(_.e)("Editing 1 filter:"),a.length>1&&Object(_.e)("Batch editing %d filters:",a.length),Object(L.jsx)("span",{className:"selected-scopes"},a.join(", ")))}render(){const{showSelector:e}=this.state;return Object(L.jsx)("div",{className:"filter-scope-container"},Object(L.jsx)("div",{className:"filter-scope-header"},Object(L.jsx)("h4",null,Object(_.e)("Configure filter scopes")),e&&this.renderEditingFiltersName()),Object(L.jsx)("div",{className:"filter-scope-body"},e?Object(L.jsx)("div",{className:"filters-scope-selector"},Object(L.jsx)("div",{className:U()("filter-field-pane multi-edit-mode")},this.renderFilterFieldList()),Object(L.jsx)("div",{className:"filter-scope-pane multi-edit-mode"},this.renderFilterScopeTree())):Object(L.jsx)("div",{className:"warning-message"},Object(_.e)("There are no filters in this dashboard."))),Object(L.jsx)(ri,null,Object(L.jsx)(An.a,{buttonSize:"small",onClick:this.onClose},Object(_.e)("Close")),e&&Object(L.jsx)(An.a,{buttonSize:"small",buttonStyle:"primary",onClick:this.onSave},Object(_.e)("Save"))))}}ii.propTypes=ni;var ai=Object(i.b)((function({dashboardLayout:e,dashboardFilters:t}){return{dashboardFilters:t,layout:e.present}}),(function(e){return Object(r.b)({updateDashboardFiltersScope:mr.j,setUnsavedChanges:gr.N},e)}))(ii);const oi=$.g.div(({theme:{gridUnit:e}})=>({padding:2*e,paddingBottom:3*e}));class si extends R.a.PureComponent{constructor(e){var t;super(e),this.modal=void 0,this.modal=R.a.createRef(),this.handleCloseModal=S()(t=this.handleCloseModal).call(t,this)}handleCloseModal(){this.modal.current&&this.modal.current.close()}render(){const e={onCloseModal:this.handleCloseModal};return Object(L.jsx)(Xn.a,{ref:this.modal,triggerNode:this.props.triggerNode,modalBody:Object(L.jsx)(oi,null,Object(L.jsx)(ai,e)),width:"80%"})}}var li=n(1945),ci=n(64),di=n.n(ci),ui=n(1153),hi=n.n(ui),pi=n(111),fi=n.n(pi),bi=n(1941),mi=n.n(bi);function gi(e){return function e(t){var n;const r=t;return v()(n=f()(r)).call(n,t=>{void 0===r[t]?r[t]=null:null!==r[t]&&"object"==typeof r[t]&&(r[t]=e(r[t]))}),r}(mi()(e))}var vi=n(2188);function ji({pathname:e,filters:t={},hash:n="",standalone:r,dataMask:i}){const a=new hi.a;a.set(Hn.g.preselectFilters.name,di()(Object(vi.a)(t))),r&&a.set(Hn.g.standalone.name,r.toString()),i&&a.set(Hn.g.nativeFilters.name,fi.a.encode(gi(i)));const o=n?`#${n}`:"";return`${e}?${a.toString()}${o}`}var yi=n(325);const xi={addSuccessToast:T.a.func.isRequired,addDangerToast:T.a.func.isRequired,dashboardInfo:T.a.object.isRequired,dashboardId:T.a.number.isRequired,dashboardTitle:T.a.string.isRequired,dataMask:T.a.object.isRequired,customCss:T.a.string.isRequired,colorNamespace:T.a.string,colorScheme:T.a.string,onChange:T.a.func.isRequired,updateCss:T.a.func.isRequired,forceRefreshAllCharts:T.a.func.isRequired,refreshFrequency:T.a.number.isRequired,shouldPersistRefreshFrequency:T.a.bool.isRequired,setRefreshFrequency:T.a.func.isRequired,startPeriodicRender:T.a.func.isRequired,editMode:T.a.bool.isRequired,userCanEdit:T.a.bool.isRequired,userCanShare:T.a.bool.isRequired,userCanSave:T.a.bool.isRequired,isLoading:T.a.bool.isRequired,layout:T.a.object.isRequired,expandedSlices:T.a.object.isRequired,onSave:T.a.func.isRequired,showPropertiesModal:T.a.func.isRequired,refreshLimit:T.a.number,refreshWarning:T.a.string,lastModifiedTime:T.a.number.isRequired},Oi={colorNamespace:void 0,colorScheme:void 0,refreshLimit:0,refreshWarning:null},Ci="save-modal",Si="refresh-dashboard",wi="autorefresh-modal",Ri="set-filter-mapping",ki="edit-properties",Ti="edit-css",_i="download-as-image",Fi="toggle-fullscreen",Ei=$.g.div`
  margin-left: ${({theme:e})=>2.5*e.gridUnit}px;
  span {
    color: ${({theme:e})=>e.colors.grayscale.base};
  }
`;class Mi extends R.a.PureComponent{static discardChanges(){window.location.reload()}constructor(e){var t,n,r;super(e),this.state={css:e.customCss,cssTemplates:[]},this.changeCss=S()(t=this.changeCss).call(t,this),this.changeRefreshInterval=S()(n=this.changeRefreshInterval).call(n,this),this.handleMenuClick=S()(r=this.handleMenuClick).call(r,this)}UNSAFE_componentWillMount(){Object(br.a)(this.state.css),Vn.a.get({endpoint:"/csstemplateasyncmodelview/api/read"}).then(({json:e})=>{var t;const n=Tt()(t=e.result).call(t,e=>({value:e.template_name,css:e.css,label:e.template_name}));this.setState({cssTemplates:n})}).catch(()=>{this.props.addDangerToast(Object(_.e)("An error occurred while fetching available CSS templates"))})}changeCss(e){this.setState({css:e},()=>{Object(br.a)(e)}),this.props.onChange(),this.props.updateCss(e)}changeRefreshInterval(e,t){this.props.setRefreshFrequency(e,t),this.props.startPeriodicRender(1e3*e)}handleMenuClick({key:e,domEvent:t}){switch(e){case Si:this.props.forceRefreshAllCharts();break;case ki:this.props.showPropertiesModal();break;case _i:{const e=document.querySelector(".ant-dropdown:not(.ant-dropdown-hidden)");e.style.visibility="hidden",Object(li.a)(".dashboard",this.props.dashboardTitle,{},!0)(t).then(()=>{e.style.visibility="visible"});break}case Fi:{const e=ji({dataMask:this.props.dataMask,pathname:window.location.pathname,filters:Object($r.b)(),hash:window.location.hash,standalone:!Object(yi.b)(Hn.g.standalone)});window.location.replace(e);break}}}render(){const{dashboardTitle:e,dashboardId:t,dashboardInfo:n,dataMask:r,refreshFrequency:i,shouldPersistRefreshFrequency:a,editMode:o,customCss:s,colorNamespace:l,colorScheme:c,layout:d,expandedSlices:u,onSave:h,userCanEdit:p,userCanShare:f,userCanSave:b,isLoading:m,refreshLimit:g,refreshWarning:v,lastModifiedTime:j,addSuccessToast:y,addDangerToast:x}=this.props,O=`${Object(_.e)("Superset dashboard")} ${e}`,C=Object(_.e)("Check out this dashboard: "),S=ji({dataMask:r,pathname:window.location.pathname,filters:Object($r.b)(),hash:window.location.hash}),w=Object(L.jsx)(Yt.q,{onClick:this.handleMenuClick,selectable:!1},b&&Object(L.jsx)(Yt.q.Item,{key:Ci},Object(L.jsx)(fr,{addSuccessToast:this.props.addSuccessToast,addDangerToast:this.props.addDangerToast,dashboardId:t,dashboardTitle:e,dashboardInfo:n,saveType:Z.C,layout:d,expandedSlices:u,refreshFrequency:i,shouldPersistRefreshFrequency:a,lastModifiedTime:j,customCss:s,colorNamespace:l,colorScheme:c,onSave:h,triggerNode:Object(L.jsx)("span",null,Object(_.e)("Save as")),canOverwrite:p})),f&&Object(L.jsx)(Qn,{url:S,copyMenuItemTitle:Object(_.e)("Copy dashboard URL"),emailMenuItemTitle:Object(_.e)("Share dashboard by email"),emailSubject:O,emailBody:C,addSuccessToast:y,addDangerToast:x}),Object(L.jsx)(Yt.q.Item,{key:Si,disabled:m},Object(_.e)("Refresh dashboard")),Object(L.jsx)(Yt.q.Divider,null),Object(L.jsx)(Yt.q.Item,{key:wi},Object(L.jsx)(cr,{refreshFrequency:i,refreshLimit:g,refreshWarning:v,onChange:this.changeRefreshInterval,editMode:o,triggerNode:Object(L.jsx)("span",null,Object(_.e)("Set auto-refresh interval"))})),o&&Object(L.jsx)(Yt.q.Item,{key:Ri},Object(L.jsx)(si,{className:"m-r-5",triggerNode:Object(_.e)("Set filter mapping")})),o&&Object(L.jsx)(Yt.q.Item,{key:ki},Object(_.e)("Edit dashboard properties")),o&&Object(L.jsx)(Yt.q.Item,{key:Ti},Object(L.jsx)(nr,{triggerNode:Object(L.jsx)("span",null,Object(_.e)("Edit CSS")),initialCss:this.state.css,templates:this.state.cssTemplates,onChange:this.changeCss})),!o&&Object(L.jsx)(Yt.q.Item,{key:_i},Object(_.e)("Download as image")),!o&&Object(L.jsx)(Yt.q.Item,{key:Fi},Object(yi.b)(Hn.g.standalone)?Object(_.e)("Exit fullscreen"):Object(_.e)("Enter fullscreen")));return Object(L.jsx)(Yt.s,{overlay:w,trigger:["click"],getPopupContainer:e=>e.closest(".dashboard-header")},Object(L.jsx)(Ei,{id:"save-dash-split-button",role:"button"},Object(L.jsx)(zn.a.MoreHoriz,null)))}}Mi.propTypes=xi,Mi.defaultProps=Oi;var Di=Mi,Pi=n(1963),Ii=n(51),Ni=n(123);const qi={dashboardId:T.a.number.isRequired,isPublished:T.a.bool.isRequired,savePublished:T.a.func.isRequired,canEdit:T.a.bool.isRequired,canSave:T.a.bool.isRequired},zi=Object(_.e)("This dashboard is not published, it will not show up in the list of dashboards. Click here to publish this dashboard."),Ai=Object(_.e)("This dashboard is not published which means it will not show up in the list of dashboards. Favorite it to see it there or access it by using the URL directly."),Ui=Object(_.e)("This dashboard is published. Click to make it a draft.");class $i extends R.a.Component{componentDidMount(){var e;this.togglePublished=S()(e=this.togglePublished).call(e,this)}togglePublished(){this.props.savePublished(this.props.dashboardId,!this.props.isPublished)}render(){return this.props.isPublished?this.props.canEdit&&this.props.canSave?Object(L.jsx)(Ii.a,{id:"published-dashboard-tooltip",placement:"bottom",title:Ui},Object(L.jsx)(Ni.a,{onClick:()=>{this.togglePublished()}},Object(_.e)("Published"))):null:this.props.canEdit&&this.props.canSave?Object(L.jsx)(Ii.a,{id:"unpublished-dashboard-tooltip",placement:"bottom",title:zi},Object(L.jsx)(Ni.a,{onClick:()=>{this.togglePublished()}},Object(_.e)("Draft"))):Object(L.jsx)(Ii.a,{id:"unpublished-dashboard-tooltip",placement:"bottom",title:Ai},Object(L.jsx)(Ni.a,null,Object(_.e)("Draft")))}}$i.propTypes=qi;const Li={onUndo:T.a.func.isRequired,onRedo:T.a.func.isRequired};class Vi extends R.a.PureComponent{constructor(e){var t;super(e),this.handleKeydown=S()(t=this.handleKeydown).call(t,this)}componentDidMount(){document.addEventListener("keydown",this.handleKeydown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown)}handleKeydown(e){if(e.ctrlKey||e.metaKey){const t="z"===e.key||90===e.keyCode,n="y"===e.key||89===e.keyCode;if(!(document&&document.querySelector(".dashboard-markdown--editing"))&&(t||n)){e.preventDefault(),(t?this.props.onUndo:this.props.onRedo)()}}}render(){return null}}Vi.propTypes=Li;var Hi=Vi,Bi=n(1970),Wi=n(1971);const Gi=e=>{e&&clearInterval(e)};const Ki={addSuccessToast:T.a.func.isRequired,addDangerToast:T.a.func.isRequired,addWarningToast:T.a.func.isRequired,user:void 0,dashboardInfo:T.a.object.isRequired,dashboardTitle:T.a.string.isRequired,dataMask:T.a.object.isRequired,charts:T.a.objectOf(He.a).isRequired,layout:T.a.object.isRequired,expandedSlices:T.a.object.isRequired,customCss:T.a.string.isRequired,colorNamespace:T.a.string,colorScheme:T.a.string,setColorSchemeAndUnsavedChanges:T.a.func.isRequired,isStarred:T.a.bool.isRequired,isPublished:T.a.bool.isRequired,isLoading:T.a.bool.isRequired,onSave:T.a.func.isRequired,onChange:T.a.func.isRequired,fetchFaveStar:T.a.func.isRequired,fetchCharts:T.a.func.isRequired,fetchUISpecificReport:T.a.func.isRequired,saveFaveStar:T.a.func.isRequired,savePublished:T.a.func.isRequired,updateDashboardTitle:T.a.func.isRequired,editMode:T.a.bool.isRequired,setEditMode:T.a.func.isRequired,showBuilderPane:T.a.func.isRequired,updateCss:T.a.func.isRequired,logEvent:T.a.func.isRequired,hasUnsavedChanges:T.a.bool.isRequired,maxUndoHistoryExceeded:T.a.bool.isRequired,lastModifiedTime:T.a.number.isRequired,onRefresh:T.a.func.isRequired,onUndo:T.a.func.isRequired,onRedo:T.a.func.isRequired,undoLength:T.a.number.isRequired,redoLength:T.a.number.isRequired,setMaxUndoHistoryExceeded:T.a.func.isRequired,maxUndoHistoryToast:T.a.func.isRequired,refreshFrequency:T.a.number.isRequired,shouldPersistRefreshFrequency:T.a.bool.isRequired,setRefreshFrequency:T.a.func.isRequired,dashboardInfoChanged:T.a.func.isRequired,dashboardTitleChanged:T.a.func.isRequired},Qi={colorNamespace:void 0,colorScheme:void 0},Yi=$.g.div`
  background: ${({theme:e})=>e.colors.grayscale.light5};
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  padding: 0 ${({theme:e})=>6*e.gridUnit}px;
  border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};

  .action-button > span {
    color: ${({theme:e})=>e.colors.grayscale.base};
  }
  button,
  .fave-unfave-icon {
    margin-left: ${({theme:e})=>2*e.gridUnit}px;
  }
  .button-container {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    .action-button {
      font-size: ${({theme:e})=>e.typography.sizes.xl}px;
      margin-left: ${({theme:e})=>2.5*e.gridUnit}px;
    }
  }
`;class Xi extends R.a.PureComponent{static discardChanges(){const e=new En.a(window.location.href);e.searchParams.delete("edit"),window.location.assign(e)}constructor(e){var t,n,r,i,a,o,s,l,c,d,u,h;super(e),this.state={didNotifyMaxUndoHistoryToast:!1,emphasizeUndo:!1,showingPropertiesModal:!1,showingReportModal:!1},this.handleChangeText=S()(t=this.handleChangeText).call(t,this),this.handleCtrlZ=S()(n=this.handleCtrlZ).call(n,this),this.handleCtrlY=S()(r=this.handleCtrlY).call(r,this),this.toggleEditMode=S()(i=this.toggleEditMode).call(i,this),this.forceRefresh=S()(a=this.forceRefresh).call(a,this),this.startPeriodicRender=S()(o=this.startPeriodicRender).call(o,this),this.overwriteDashboard=S()(s=this.overwriteDashboard).call(s,this),this.showPropertiesModal=S()(l=this.showPropertiesModal).call(l,this),this.hidePropertiesModal=S()(c=this.hidePropertiesModal).call(c,this),this.showReportModal=S()(d=this.showReportModal).call(d,this),this.hideReportModal=S()(u=this.hideReportModal).call(u,this),this.renderReportModal=S()(h=this.renderReportModal).call(h,this)}componentDidMount(){const{refreshFrequency:e,user:t,dashboardInfo:n}=this.props;this.startPeriodicRender(1e3*e),this.canAddReports()&&this.props.fetchUISpecificReport(t.userId,"dashboard_id","dashboards",n.id,t.email)}UNSAFE_componentWillReceiveProps(e){const{user:t}=this.props;Z.F-e.undoLength<=0&&!this.state.didNotifyMaxUndoHistoryToast&&(this.setState(()=>({didNotifyMaxUndoHistoryToast:!0})),this.props.maxUndoHistoryToast()),e.undoLength>Z.F&&!this.props.maxUndoHistoryExceeded&&this.props.setMaxUndoHistoryExceeded(),this.canAddReports()&&e.dashboardInfo.id!==this.props.dashboardInfo.id&&this.props.fetchUISpecificReport(t.userId,"dashboard_id","dashboards",e.dashboardInfo.id,t.email)}componentWillUnmount(){Gi(this.refreshTimer),this.props.setRefreshFrequency(0),clearTimeout(this.ctrlYTimeout),clearTimeout(this.ctrlZTimeout)}handleChangeText(e){const{updateDashboardTitle:t,onChange:n}=this.props;e&&this.props.dashboardTitle!==e&&(t(e),n())}handleCtrlY(){this.props.onRedo(),this.setState({emphasizeRedo:!0},()=>{this.ctrlYTimeout&&clearTimeout(this.ctrlYTimeout),this.ctrlYTimeout=_n()(()=>{this.setState({emphasizeRedo:!1})},100)})}handleCtrlZ(){this.props.onUndo(),this.setState({emphasizeUndo:!0},()=>{this.ctrlZTimeout&&clearTimeout(this.ctrlZTimeout),this.ctrlZTimeout=_n()(()=>{this.setState({emphasizeUndo:!1})},100)})}forceRefresh(){if(!this.props.isLoading){const e=f()(this.props.charts);return this.props.logEvent(Nn.f,{force:!0,interval:0,chartCount:e.length}),this.props.onRefresh(e,!0,0,this.props.dashboardInfo.id)}return!1}startPeriodicRender(e){let t;if(e){const n=z()(ar).call(ar,t=>t.value===e/1e3);t=n?n.label:Dn.a.duration(e,"millisecond").humanize()}this.refreshTimer=function({interval:e=0,periodicRender:t,refreshTimer:n}){return Gi(n),e>0?at()(t,e):0}({interval:e,periodicRender:()=>{var n,r;const{fetchCharts:i,logEvent:a,charts:o,dashboardInfo:s}=this.props,{metadata:l}=s,c=l.timed_refresh_immune_slices||[],d=Tt()(n=O()(r=m()(o)).call(r,e=>-1===y()(c).call(c,e.id))).call(n,e=>e.id);return a(Nn.l,{interval:e,chartCount:d.length}),this.props.addWarningToast(Object(_.e)("This dashboard is currently force refreshing; the next force refresh will be in %s.",t)),i(d,!0,.2*e,s.id)},refreshTimer:this.refreshTimer})}toggleEditMode(){this.props.logEvent(Nn.o,{edit_mode:!this.props.editMode}),this.props.setEditMode(!this.props.editMode)}overwriteDashboard(){var e,t;const{dashboardTitle:n,layout:r,expandedSlices:i,customCss:a,colorNamespace:o,colorScheme:s,dashboardInfo:l,refreshFrequency:c,shouldPersistRefreshFrequency:d,lastModifiedTime:u}=this.props,h=Pn.b.getScale(s,o);let p=s?h.getColorMap():{};const f=null==(e=l.metadata)?void 0:e.label_colors;f&&(p={...p,...f});const b={positions:r,expanded_slices:i,css:a,color_namespace:o,color_scheme:s,label_colors:p,dashboard_title:n,refresh_frequency:d?c:null==(t=l.metadata)?void 0:t.refresh_frequency,last_modified_time:u},m=Object(Ln.a)(r).length,g=l.common.conf.SUPERSET_DASHBOARD_POSITION_DATA_LIMIT||Z.f;m>=g?this.props.addDangerToast(Object(_.e)("Your dashboard is too large. Please reduce its size before saving it.")):(m>=.9*g&&this.props.addWarningToast("Your dashboard is near the size limit."),this.props.onSave(b,l.id,Z.D))}showPropertiesModal(){this.setState({showingPropertiesModal:!0})}hidePropertiesModal(){this.setState({showingPropertiesModal:!1})}showReportModal(){this.setState({showingReportModal:!0})}hideReportModal(){this.setState({showingReportModal:!1})}renderReportModal(){return!!f()(this.props.reports).length?Object(L.jsx)(Pi.a,{showReportModal:this.showReportModal,toggleActive:this.props.toggleActive,deleteActiveReport:this.props.deleteActiveReport}):Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)("span",{role:"button",title:Object(_.e)("Schedule email report"),tabIndex:0,className:"action-button",onClick:this.showReportModal},Object(L.jsx)(zn.a.Calendar,null)))}canAddReports(){if(!Object(qn.c)(qn.a.ALERT_REPORTS))return!1;const{user:e}=this.props;if(!e)return!1;const t=f()(e.roles||[]);return Tt()(t).call(t,t=>{var n;return O()(n=e.roles[t]).call(n,e=>"menu_access"===e[0]&&"Manage"===e[1])})[0].length>0}render(){const{dashboardTitle:e,layout:t,expandedSlices:n,customCss:r,colorNamespace:i,dataMask:a,setColorSchemeAndUnsavedChanges:o,colorScheme:s,onUndo:l,onRedo:c,undoLength:d,redoLength:u,onChange:h,onSave:p,updateCss:f,editMode:b,isPublished:m,user:g,dashboardInfo:v,hasUnsavedChanges:j,isLoading:y,refreshFrequency:x,shouldPersistRefreshFrequency:O,setRefreshFrequency:C,lastModifiedTime:S}=this.props,w=v.dash_edit_perm,k=v.dash_share_perm,T=v.dash_save_perm,F=!b&&this.canAddReports(),E=v.common.conf.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_LIMIT,M=v.common.conf.SUPERSET_DASHBOARD_PERIODICAL_REFRESH_WARNING_MESSAGE;return Object(L.jsx)(Yi,{className:"dashboard-header","data-test-id":`${v.id}`},Object(L.jsx)("div",{className:"dashboard-component-header header-large"},Object(L.jsx)(Un.a,{title:e,canEdit:w&&b,onSaveTitle:this.handleChangeText,showTooltip:!1}),Object(L.jsx)($i,{dashboardId:v.id,isPublished:m,savePublished:this.props.savePublished,canEdit:w,canSave:T}),(null==g?void 0:g.userId)&&Object(L.jsx)($n.a,{itemId:v.id,fetchFaveStar:this.props.fetchFaveStar,saveFaveStar:this.props.saveFaveStar,isStarred:this.props.isStarred,showTooltip:!0})),Object(L.jsx)("div",{className:"button-container"},T&&Object(L.jsx)("div",{className:"button-container"},b&&Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(In.a,{className:"m-r-5"},Object(L.jsx)(An.a,{buttonSize:"small",onClick:l,disabled:d<1,buttonStyle:this.state.emphasizeUndo?"primary":void 0},Object(L.jsx)("i",{title:"Undo",className:"undo-action fa fa-reply"}),""),Object(L.jsx)(An.a,{buttonSize:"small",onClick:c,disabled:u<1,buttonStyle:this.state.emphasizeRedo?"primary":void 0},"",Object(L.jsx)("i",{title:"Redo",className:"redo-action fa fa-share"}))),Object(L.jsx)(An.a,{buttonSize:"small",className:"m-r-5",onClick:this.constructor.discardChanges,buttonStyle:"default"},Object(_.e)("Discard changes")),Object(L.jsx)(An.a,{buttonSize:"small",disabled:!j,buttonStyle:"primary",onClick:this.overwriteDashboard},Object(_.e)("Save")))),b&&Object(L.jsx)(Hi,{onUndo:this.handleCtrlZ,onRedo:this.handleCtrlY}),!b&&w&&Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)("span",{role:"button",title:Object(_.e)("Edit dashboard"),tabIndex:0,className:"action-button",onClick:this.toggleEditMode},Object(L.jsx)(zn.a.EditAlt,null))),F&&this.renderReportModal(),this.state.showingPropertiesModal&&Object(L.jsx)(Bi.a,{dashboardId:v.id,show:this.state.showingPropertiesModal,onHide:this.hidePropertiesModal,colorScheme:this.props.colorScheme,onSubmit:e=>{const{dashboardInfoChanged:t,dashboardTitleChanged:n}=this.props;t({slug:e.slug,metadata:JSON.parse(e.jsonMetadata)}),o(e.colorScheme),n(e.title),e.slug&&window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${e.slug}/`)}}),this.state.showingReportModal&&Object(L.jsx)(Wi.a,{show:this.state.showingReportModal,onHide:this.hideReportModal,props:{userId:g.userId,userEmail:g.email,dashboardId:v.id,creationMethod:"dashboards"}}),Object(L.jsx)(Di,{addSuccessToast:this.props.addSuccessToast,addDangerToast:this.props.addDangerToast,dashboardId:v.id,dashboardTitle:e,dashboardInfo:v,dataMask:a,layout:t,expandedSlices:n,customCss:r,colorNamespace:i,colorScheme:s,onSave:p,onChange:h,forceRefreshAllCharts:this.forceRefresh,startPeriodicRender:this.startPeriodicRender,refreshFrequency:x,shouldPersistRefreshFrequency:O,setRefreshFrequency:C,updateCss:f,editMode:b,hasUnsavedChanges:j,userCanEdit:w,userCanShare:k,userCanSave:T,isLoading:y,showPropertiesModal:this.showPropertiesModal,refreshLimit:E,refreshWarning:M,lastModifiedTime:S})))}}Xi.propTypes=Ki,Xi.defaultProps=Qi;var Ji=Xi;function Zi(e){var t;return wr()(t=m()(e)).call(t,e=>e.chartUpdateStartTime>(e.chartUpdateEndTime||0))}var ea=n(595),ta=n(340),na=n(63),ra=n(440),ia=n(372);var aa=Object(i.b)((function({dashboardLayout:e,dashboardState:t,reports:n,dashboardInfo:r,charts:i,dataMask:a,user:o}){return{dashboardInfo:r,undoLength:e.past.length,redoLength:e.future.length,layout:e.present,dashboardTitle:((e.present[Z.e]||{}).meta||{}).text,expandedSlices:t.expandedSlices,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:!!t.shouldPersistRefreshFrequency,customCss:t.css,colorNamespace:t.colorNamespace,colorScheme:t.colorScheme,charts:i,dataMask:a,user:o,isStarred:!!t.isStarred,isPublished:!!t.isPublished,isLoading:Zi(i),hasUnsavedChanges:!!t.hasUnsavedChanges,maxUndoHistoryExceeded:!!t.maxUndoHistoryExceeded,lastModifiedTime:Math.max(t.lastModifiedTime,r.last_modified_time),editMode:!!t.editMode,slug:r.slug,metadata:r.metadata,reports:n}}),(function(e){return Object(r.b)({addSuccessToast:na.e,addDangerToast:na.c,addWarningToast:na.g,onUndo:ta.r,onRedo:ta.p,setEditMode:gr.I,showBuilderPane:gr.O,setColorSchemeAndUnsavedChanges:gr.G,fetchFaveStar:gr.x,saveFaveStar:gr.D,savePublished:gr.E,fetchCharts:gr.w,updateDashboardTitle:ta.t,updateCss:gr.R,onChange:gr.z,onSave:gr.C,setMaxUndoHistoryExceeded:gr.L,maxUndoHistoryToast:gr.y,logEvent:ra.logEvent,setRefreshFrequency:gr.M,onRefresh:gr.A,dashboardInfoChanged:ea.b,dashboardTitleChanged:ta.l,updateDataMask:kn.h,fetchUISpecificReport:ia.g,toggleActive:ia.h,deleteActiveReport:ia.e},e)}))(Ji);const oa=$.g.div`
  display: flex;
  align-items: center;
  color: ${({theme:e})=>e.colors.grayscale.base};
  &:hover {
    color: ${({theme:e})=>e.colors.primary.base};
  }
`,sa=$.g.span`
  margin-left: ${({theme:e})=>2*e.gridUnit}px;
`;var la=({icon:e,label:t,onClick:n})=>Object(L.jsx)(oa,{tabIndex:0,role:"button",onClick:e=>{e.preventDefault(),n(e)}},e,t&&Object(L.jsx)(sa,null,t)),ca=n(125),da=n(156),ua=n.n(da),ha=n(636),pa=n(44),fa=n.n(pa);function ba(e){var t,n;return O()(t=Tt()(n=Rt()(e)).call(n,([e,t])=>({col:e,op:fa()(t)?"IN":"==",val:t}))).call(t,e=>null!==e.val)}const ma=({child:e,layout:t,scope:n,activeFilters:r,filterId:i,extraFormData:a})=>{var o,s,c;const d=null==(o=t[e])?void 0:null==(s=o.meta)?void 0:s.chartId;if(t[e].type===I.a){var u;if(l()(u=n.excluded).call(u,d))return;return r[i]||(r[i]={scope:[],values:a}),void r[i].scope.push(d)}v()(c=t[e].children).call(c,e=>ma({child:e,layout:t,scope:n,activeFilters:r,filterId:i,extraFormData:a}))},ga=(e,t)=>{var n,r;return P()(n=O()(r=m()(e)).call(r,e=>e[t])).call(n,(e,n)=>({...e,[n.id]:t?n[t]:n}),{})},va=({chartConfiguration:e,nativeFilters:t,dataMask:n,layout:r})=>{var i;const a={};return v()(i=m()(n)).call(i,({id:n,extraFormData:i})=>{var o,s,l,c,d,u;const h=null!=(o=null!=(s=null==t?void 0:null==(l=t[n])?void 0:l.scope)?s:null==e?void 0:null==(c=e[n])?void 0:null==(d=c.crossFilters)?void 0:d.scope)?o:{rootPath:[Z.h],excluded:[n]};v()(u=h.rootPath).call(u,e=>{var t,o;null==(t=r[e])||null==(o=t.children)||v()(o).call(o,e=>{ma({child:e,layout:r,scope:h,activeFilters:a,filterId:n,extraFormData:i})})})}),a},ja={},ya={};var xa,Oa=n(36),Ca=n.n(Oa),Sa=n(92),wa=n(1969),Ra=n(88),ka=n(194),Ta=n(287),_a=n(114),Fa=n(1287);!function(e){e[e.all=0]="all",e[e.specific=1]="specific"}(xa||(xa={}));const Ea=({type:e,meta:t},n)=>{var r,i;return!(e!==I.l&&e!==I.a&&e!==I.e||n&&"filter_box"===(null==(r=n[null==t?void 0:t.chartId])?void 0:null==(i=r.formData)?void 0:i.viz_type))},Ma=(e,t,n,r,i,a,o)=>{var s;let c=t;if(Ea(e,r)&&e.type!==I.e&&l()(i).call(i,e.id)){var d;const n=o(e.meta.sliceNameOverride||e.meta.sliceName||e.meta.text||e.meta.defaultText||e.id.toString(),l()(a).call(a,null==(d=e.meta)?void 0:d.chartId),Object(_.e)("This chart might be incompatible with the filter (datasets don't match)")),r={key:e.id,title:n,children:[]};t.children.push(r),c=r}v()(s=e.children).call(s,e=>Ma(n[e],c,n,r,i,a,o))},Da=(e,t,n,r)=>{v()(n).call(n,n=>{var i,a;Da(e,t,((e,t)=>{var n,r,i;return[...(null==(n=e[t])?void 0:n.children)||[],...Tt()(r=O()(i=m()(e)).call(i,n=>n.parents&&n.parents[n.parents.length-1]===t&&!Ea(e[n.parents[n.parents.length-1]]))).call(r,({id:e})=>e)]})(t,n),r),(null==(i=t[n])?void 0:i.type)!==I.a||l()(r).call(r,null==(a=t[n])?void 0:a.meta.chartId)||e.push(n)})},Pa=(e,t)=>{const n=[];return Da(n,t,[...e.rootPath],[...e.excluded]),[...new h.a(n)]},Ia=(e,t)=>{var n,r;if(!e.length)return{rootPath:[],excluded:[]};const i=Tt()(n=O()(e).call(e,e=>{var n;return(null==(n=t[e])?void 0:n.type)===I.a})).call(n,e=>{var n;const r=[Z.h,...(null==(n=t[e])?void 0:n.parents)||[]];return O()(r).call(r,e=>Ea(t[e]))});Ft()(i).call(i,(e,t)=>e.length-t.length);const a=Tt()(i).call(i,e=>e[i[0].length-1]),o=[];return v()(r=Rt()(t)).call(r,([t,n])=>{var r;const i=n.parents||[];n.type===I.a&&null!=(r=[Z.h,...i])&&z()(r).call(r,n=>((t,n)=>l()(a).call(a,t)&&!l()(e).call(e,n))(n,t))&&o.push(n.meta.chartId)}),{rootPath:[...new h.a(a)],excluded:o}},Na=(e,t=[])=>({rootPath:[Z.h],excluded:e?[e,...t]:t}),qa=(e,t)=>{var n;return!e||e.rootPath[0]===Z.h&&!O()(n=e.excluded).call(n,e=>e!==t).length};const za=(e,t,n)=>{let r=Object(L.jsx)("span",null,e);return t&&(r=Object(L.jsx)(R.a.Fragment,null,r,"",Object(L.jsx)(Ii.a,{title:n},Object(L.jsx)(zn.a.Info,{iconSize:"m"})))),r};var Aa=({formScope:e,initialScope:t,forceUpdate:n,updateFormValues:r,chartId:a,initiallyExcludedCharts:o=[]})=>{const[s,l]=Object(w.useState)([Z.h]),{treeData:c,layout:d}=function(e,t=[],n=(e=>e)){const r=Object(i.d)(({dashboardLayout:{present:e}})=>e),a=Object(i.d)(({charts:e})=>e),o={children:[],key:Z.h,type:I.e,title:Object(_.e)("All panels")},s=Object(w.useMemo)(()=>{var t;return P()(t=m()(r)).call(t,(t,n)=>{const{id:r,parents:i=[],type:a,meta:o}=n;return a===I.a&&e!==(null==o?void 0:o.chartId)?[...new h.a([...t,...i,r])]:t},[])},[r,e]);return Object(w.useMemo)(()=>{Ma(r[Z.h],o,r,a,s,t,n)},[r,o,a,t,n]),{treeData:[o],layout:r}}(a,o,za),[u,p]=Object(w.useState)(!0),f=Object(w.useMemo)(()=>Pa({...e||t},d),[e,t,d]);return Object(L.jsx)(Yt.D,{checkable:!0,selectable:!1,onExpand:e=>{l(e),p(!1)},expandedKeys:s,autoExpandParent:u,onCheck:e=>{n();const t=Ia(e,d);void 0!==a&&(t.excluded=[...new h.a([...t.excluded,a])]),r({scope:t})},checkedKeys:f,treeData:c})};const Ua=$.g.div`
  display: flex;
  flex-direction: column;
  & > * {
    margin-bottom: ${({theme:e})=>e.gridUnit}px;
  }
`,$a=Object($.g)(Yt.l.Item)`
  margin-bottom: 0;
`;var La=({pathToFormValue:e=[],formScopingType:t,formFilterScope:n,forceUpdate:r,filterScope:i,updateFormValues:a,chartId:o,initiallyExcludedCharts:s})=>{const[l]=Object(w.useState)(i||Na(o,s)),[c]=Object(w.useState)(qa(l,o)?xa.all:xa.specific),[d,u]=Object(w.useState)(!!i),h=Object(w.useCallback)(e=>{a(e),u(!0)},[a]),p=Object(w.useCallback)(()=>{if(i||d)return;const e=Na(o,s);a({scope:e,scoping:qa(e,o)?xa.all:xa.specific})},[o,i,d,s,a]);return Object(Fa.a)(p),Object(L.jsx)(Ua,null,Object(L.jsx)($a,{name:[...e,"scoping"],initialValue:c},Object(L.jsx)(dr.a.Group,{onChange:({target:{value:e}})=>{if(e===xa.all){const e=Na(o);a({scope:e})}u(!0),r()}},Object(L.jsx)(dr.a,{value:xa.all},Object(_.e)("Apply to all panels")),Object(L.jsx)(dr.a,{value:xa.specific},Object(_.e)("Apply to specific panels")))),Object(L.jsx)(Yt.E.Text,{type:"secondary"},(null!=t?t:c)===xa.specific?Object(_.e)("Only selected panels will be affected by this filter"):Object(_.e)("All panels with this column will be affected by this filter")),(null!=t?t:c)===xa.specific&&Object(L.jsx)(Aa,{updateFormValues:h,initialScope:l,formScope:n,forceUpdate:r,chartId:o,initiallyExcludedCharts:s}),Object(L.jsx)($a,{name:[...e,"scope"],hidden:!0,initialValue:l}))};var Va=n(593),Ha=n.n(Va),Ba=n(4982),Wa=n.n(Ba),Ga=n(227),Ka=n(230);const Qa={filter_time:[Ga.a.TEMPORAL],filter_timegrain:[Ga.a.TEMPORAL],filter_timecolumn:[Ga.a.TEMPORAL],filter_select:[Ga.a.BOOLEAN,Ga.a.STRING,Ga.a.NUMERIC,Ga.a.TEMPORAL],filter_range:[Ga.a.NUMERIC]},Ya=()=>{const[,e]=R.a.useState({});return R.a.useCallback(()=>e({}),[])},Xa=(e,t,n)=>{const r=e.getFieldValue("filters")||{};e.setFields([{name:"filters",value:{...r,[t]:{...r[t],...n}}}])},Ja=e=>({value:e.id,label:e.table_name}),Za=e=>{const t=Object(Ka.a)(null==e?void 0:e.column_types);return 0===t.length||l()(t).call(t,Ga.a.TEMPORAL)},eo=(e,t)=>{var n;return!t.type_generic||!(e in Qa)||(null==(n=Qa[e])?void 0:l()(n).call(n,t.type_generic))};var to=({form:e,scope:t,chartId:n})=>{const r=Ya(),i=e.getFieldValue("scope"),a=e.getFieldValue("scoping");return Object(L.jsx)(La,{updateFormValues:t=>{((e,t)=>{e.setFieldsValue({...t})})(e,{...t})},filterScope:t,chartId:n,formFilterScope:i,forceUpdate:r,formScopingType:a})},no=n(4983),ro=n.n(no),io=n(1294);const ao=[];function oo(){return Object(i.d)(e=>{var t,n;return(null==(t=e.dashboardInfo)?void 0:null==(n=t.metadata)?void 0:n.native_filter_configuration)||ao})}function so(){return Object(i.d)(e=>{var t;return null==(t=e.dashboardLayout)?void 0:t.present})}function lo(){const e=so();return Object(w.useMemo)(()=>{var t;return wr()(t=m()(e)).call(t,e=>e.type===I.l)},[e])}function co(){const e=Object(i.d)(e=>{var t;return null==(t=e.dashboardState)?void 0:t.activeTabs}),t=function(){const e=so();return t=>{var n,r;const i=z()(n=m()(e)).call(n,e=>{var n;return(null==(n=e.meta)?void 0:n.chartId)===t});return null==i?void 0:O()(r=i.parents).call(r,t=>e[t].type===I.l)}}();return n=>{var r;return null==(r=n.chartsInScope)?void 0:wr()(r).call(r,n=>{const r=t(n);return 0===(null==r?void 0:r.length)||(null==r?void 0:Ke()(r).call(r,t=>l()(e).call(e,t)))})}}var uo=n(1288);var ho={name:"ihui0v",styles:"text-align:left;& .ant-alert-action{align-self:center;}"},po={name:"zjik7",styles:"display:flex"};function fo({title:e,onConfirm:t,onDismiss:n,children:r}){return Object(L.jsx)(rr.a,{closable:!1,type:"warning",key:"alert",message:e,css:ho,description:r,action:Object(L.jsx)("div",{css:po},Object(L.jsx)(An.a,{key:"cancel",buttonSize:"small",buttonStyle:"secondary",onClick:n},Object(_.e)("Keep editing")),Object(L.jsx)(An.a,{key:"submit",buttonSize:"small",buttonStyle:"primary",onClick:t},Object(_.e)("Yes, cancel")))})}var bo=({onCancel:e,handleSave:t,onDismiss:n,onConfirmCancel:r,saveAlertVisible:i})=>i?Object(L.jsx)(fo,{key:"cancel-confirm",title:Object(_.e)("There are unsaved changes."),onConfirm:r,onDismiss:n},Object(_.e)("Are you sure you want to cancel?")):Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(An.a,{key:"cancel",buttonStyle:"secondary",onClick:e},Object(_.e)("Cancel")),Object(L.jsx)(An.a,{key:"submit",buttonStyle:"primary",onClick:t},Object(_.e)("Save"))),mo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},go=n(1583),vo=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:mo}))};vo.displayName="PlusOutlined";var jo=w.forwardRef(vo);const yo=$.g.span`
  cursor: pointer;
  color: ${({theme:e})=>e.colors.primary.dark1};
  &:hover {
    color: ${({theme:e})=>e.colors.primary.dark2};
  }
`,xo=$.g.span`
  width: ${180}px;
  white-space: normal;
  color: ${({theme:e})=>e.colors.grayscale.dark1};
`,Oo=$.g.div`
  color: ${({theme:e})=>e.colors.primary.dark1};
  padding: ${({theme:e})=>2*e.gridUnit}px;
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  cursor: pointer;

  &:hover {
    color: ${({theme:e})=>e.colors.primary.base};
  }
`,Co=Object($.g)(zn.a.Trash)`
  color: ${({theme:e})=>e.colors.grayscale.light3};
`,So=$.g.span`
  transition: color ${({theme:e})=>e.transitionTiming}s;
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-between;

  @keyframes tabTitleRemovalAnimation {
    0%,
    90% {
      opacity: 1;
    }
    95%,
    100% {
      opacity: 0;
    }
  }

  &.removed {
    color: ${({theme:e})=>e.colors.warning.dark1};
    transform-origin: top;
    animation-name: tabTitleRemovalAnimation;
    animation-duration: ${uo.b}s;
  }
`,wo=Object($.g)(H.b)`
  ${({theme:e})=>`\n    height: 100%;\n\n    & > .ant-tabs-content-holder {\n      border-left: 1px solid ${e.colors.grayscale.light2};\n      padding-right: ${4*e.gridUnit}px;\n      overflow-x: hidden;\n      overflow-y: auto;\n    }\n\n    & > .ant-tabs-content-holder ~ .ant-tabs-content-holder {\n      border: none;\n    }\n\n    &.ant-tabs-card > .ant-tabs-nav .ant-tabs-ink-bar {\n      visibility: hidden;\n    }\n\n    &.ant-tabs-left\n      > .ant-tabs-content-holder\n      > .ant-tabs-content\n      > .ant-tabs-tabpane {\n      padding-left: ${4*e.gridUnit}px;\n      margin-top: ${4*e.gridUnit}px;\n    }\n\n    .ant-tabs-nav-list {\n      overflow-x: hidden;\n      overflow-y: auto;\n      padding-top: ${2*e.gridUnit}px;\n      padding-right: ${e.gridUnit}px;\n      padding-bottom: ${3*e.gridUnit}px;\n      padding-left: ${3*e.gridUnit}px;\n      width: 270px;\n    }\n\n    // extra selector specificity:\n    &.ant-tabs-card > .ant-tabs-nav .ant-tabs-tab {\n      min-width: 180px;\n      margin: 0 ${2*e.gridUnit}px 0 0;\n      padding: ${e.gridUnit}px\n        ${2*e.gridUnit}px;\n      &:hover,\n      &-active {\n        color: ${e.colors.grayscale.dark1};\n        border-radius: ${e.borderRadius}px;\n        background-color: ${e.colors.secondary.light4};\n\n        .ant-tabs-tab-remove > span {\n          color: ${e.colors.grayscale.base};\n          transition: all 0.3s;\n        }\n      }\n    }\n\n    .ant-tabs-tab-btn {\n      text-align: left;\n      justify-content: space-between;\n      text-transform: unset;\n    }\n\n    .ant-tabs-nav-more {\n      display: none;\n    }\n\n    .ant-tabs-extra-content {\n      width: 100%;\n    }\n  `}
`,Ro=$.g.div`
  ${({theme:e})=>`\n    color: ${e.colors.grayscale.dark1};\n    font-size: ${e.typography.sizes.l}px;\n    padding-top: ${4*e.gridUnit}px;\n    padding-right: ${4*e.gridUnit}px;\n    padding-left: ${4*e.gridUnit}px;\n  `}
`;var ko=({onEdit:e,getFilterTitle:t,onChange:n,currentFilterId:r,filterIds:i=[],removedFilters:a=[],restoreFilter:o,children:s})=>Object(L.jsx)(wo,{id:"native-filters-tabs",type:"editable-card",tabPosition:"left",onChange:n,activeKey:r,onEdit:e,hideAdd:!0,tabBarExtraContent:{left:Object(L.jsx)(Ro,null,Object(_.e)("Filters")),right:Object(L.jsx)(Oo,{onClick:()=>{e("","add"),_n()(()=>{const e=document.getElementById("native-filters-tabs");if(e){const t=e.getElementsByClassName("ant-tabs-nav-list")[0];t.scrollTop=t.scrollHeight}},0)}},Object(L.jsx)(jo,null)," ",Object(L.jsx)("span",{"aria-label":"Add filter"},Object(_.e)("Add filter")))}},Tt()(i).call(i,e=>Object(L.jsx)(H.b.TabPane,{tab:Object(L.jsx)(So,{className:a[e]?"removed":""},Object(L.jsx)(xo,null,a[e]?Object(_.e)("(Removed)"):t(e)),a[e]&&Object(L.jsx)(yo,{role:"button",tabIndex:0,onClick:()=>o(e)},Object(_.e)("Undo?"))),key:e,closeIcon:a[e]?Object(L.jsx)(R.a.Fragment,null):Object(L.jsx)(Co,null)},s(e)))),To=n(55),_o=n.n(To),Fo=n(131);const Eo=(e,t,n=((...e)=>di()([...e])))=>(...r)=>{const i=n(...r);if(t.has(i))return t.get(i);const a=e(...r);return t.set(i,a),a};var Mo=n(1441),Do=n(671),Po=n(146),Io=n(1111);const No=$.g.div`
  display: flex;
  flex-direction: row;
  background-color: ${({level:e,theme:t})=>t.colors[e].light2};
  border-radius: ${({theme:e})=>e.borderRadius}px;
  border: 1px solid ${({level:e,theme:t})=>t.colors[e].base};
  color: ${({level:e,theme:t})=>t.colors[e].dark2};
  padding: ${({theme:e})=>2*e.gridUnit}px;
  margin-bottom: ${({theme:e})=>e.gridUnit}px;
  width: 100%;
`,qo=$.g.div`
  display: flex;
  flex-direction: column;
  margin-left: ${({theme:e})=>2*e.gridUnit}px;
`,zo=$.g.span`
  font-weight: ${({theme:e})=>e.typography.weights.bold};
`;function Ao({body:e,level:t,title:n}){return Object(L.jsx)(No,{level:t,role:"alert"},"error"===t?Object(L.jsx)(zn.a.ErrorSolid,{iconColor:$.h.colors[t].base}):Object(L.jsx)(zn.a.WarningSolid,{iconColor:$.h.colors[t].base}),Object(L.jsx)(qo,null,Object(L.jsx)(zo,null,n),Object(L.jsx)("p",null,e)))}var Uo=n(646);var $o=n(142),Lo=n(65);const Vo=new Ha.a,Ho=Eo(Vn.a.get,Vo,({endpoint:e})=>e||"");function Bo({allowClear:e=!1,filterValues:t=(()=>!0),form:n,formField:r="column",filterId:i,datasetId:a,value:o,onChange:s,mode:c}){var d;const[u,h]=Object(w.useState)(),{addDangerToast:p}=Object($o.b)(),f=Object(w.useCallback)(()=>{n.setFields([{name:["filters",i,r],touched:!1,value:null}])},[n,i,r]),b=Object(w.useMemo)(()=>{var e,n,r,i;return Tt()(e=Ft()(n=Tt()(r=O()(i=Object(Ka.a)(u)).call(i,t)).call(r,e=>e.column_name)).call(n,(e,t)=>e.localeCompare(t))).call(e,e=>({label:e,value:e}))},[u,t]),m=null==(d=n.getFieldValue("filters"))?void 0:d[i].filterType,g=Object(w.useMemo)(()=>null==u?void 0:z()(u).call(u,e=>e.column_name===o),[u,o]);return Object(w.useEffect)(()=>{g&&!eo(m,g)&&f()},[g,m,f]),function(e,t){const n=Object(Uo.a)(e);Object(w.useEffect)(()=>{e!==n&&t(n,e)},[e,n,t])}(a,e=>{null!=e&&f(),null!=a&&Ho({endpoint:`/api/v1/dataset/${a}`}).then(({json:{result:e}})=>{var t;const n=fa()(o)?o:[o];wr()(t=e.columns).call(t,e=>null==n?void 0:l()(n).call(n,e.column_name))||f(),h(e.columns)},async e=>{const{error:t,message:n}=await Object(Lo.a)(e);let r=n||t||Object(_.e)("An error has occurred");"Forbidden"===n&&(r=Object(_.e)("You do not have permission to edit this dashboard")),p(r)})}),Object(L.jsx)(Xt.a,{mode:c,value:"multiple"===c?o||[]:o,ariaLabel:Object(_.e)("Column select"),onChange:s,options:b,placeholder:Object(_.e)("Select a column"),notFoundContent:Object(_.e)("No compatible columns found"),showSearch:!0,allowClear:e})}var Wo=n(357);const Go=Object($.g)(ir.b)`
  margin-bottom: 0;
`;function Ko({datasetId:e,disabled:t,forceUpdate:n,form:r,filterId:i,filterType:a,filterToEdit:o,formFilter:s,removed:l}){var c,d,u;const h=null!=(c=((e={})=>{var t,n;return null!=(t=null==(n=Wa()(e.controlPanelSections))?void 0:P()(n).call(n,(e,{controlSetRows:t=[]})=>[...e,...Wa()(t)],[]))?t:[]})(Object(Wo.a)().get(a)))?c:[],p={},f={};return v()(d=O()(h).call(h,e=>"groupby"===(null==e?void 0:e.name))).call(d,t=>{var a,c,d,u,h,p,b,m,g;const v=null!=(a=null==o?void 0:null==(c=o.controlValues)?void 0:c[t.name])?a:null==t?void 0:null==(d=t.config)?void 0:d.default,j=null==o?void 0:null==(u=o.targets[0])?void 0:null==(h=u.column)?void 0:h.name,y=Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Go,{name:["filters",i,"requiredFirst",t.name],hidden:!0,initialValue:(null==t?void 0:null==(p=t.config)?void 0:p.requiredFirst)&&(null==o?void 0:o.requiredFirst)}),Object(L.jsx)(ls,{name:["filters",i,"column"],initialValue:j,label:Object(L.jsx)(us,null,Object(_.e)(`${null==(b=t.config)?void 0:b.label}`)||Object(_.e)("Column")),rules:[{required:(null==(m=t.config)?void 0:m.required)&&!l,message:Object(_.e)("Column is required")}]},Object(L.jsx)(Bo,{mode:(null==(g=t.config)?void 0:g.multiple)&&"multiple",form:r,filterId:i,datasetId:e,filterValues:e=>eo((null==s?void 0:s.filterType)||"",e),onChange:()=>{Xa(r,i,{defaultDataMask:null}),n()}})));f[t.name]={element:y,checked:v}}),v()(u=O()(h).call(h,e=>{var t;return(null==e?void 0:null==(t=e.config)?void 0:t.renderTrigger)&&"sortAscending"!==e.name})).call(u,e=>{var a,l,c,d;const u=null!=(a=null==o?void 0:null==(l=o.controlValues)?void 0:l[e.name])?a:null==e?void 0:null==(c=e.config)?void 0:c.default,h=Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Go,{name:["filters",i,"requiredFirst",e.name],hidden:!0,initialValue:(null==e?void 0:null==(d=e.config)?void 0:d.requiredFirst)&&(null==o?void 0:o.requiredFirst)}),Object(L.jsx)(Ii.a,{key:e.name,placement:"left",title:e.config.affectsDataMask&&t&&Object(_.e)('Populate "Default value" to enable this control')},Object(L.jsx)(cs,{key:e.name,name:["filters",i,"controlValues",e.name],initialValue:u,valuePropName:"checked",colon:!1},Object(L.jsx)(Yt.f,{disabled:e.config.affectsDataMask&&t,onChange:({target:{checked:t}})=>{e.config.requiredFirst&&Xa(r,i,{requiredFirst:{...null==s?void 0:s.requiredFirst,[e.name]:t}}),e.config.resetConfig&&Xa(r,i,{defaultDataMask:null}),n()}},e.config.label,"",e.config.description&&Object(L.jsx)(Fo.a,{placement:"top",label:e.config.name,tooltip:e.config.description})))));p[e.name]={element:h,checked:u}}),{controlItems:p,mainControlItems:f}}const Qo=$.g.div`
  display: flex;
  flex-direction: column;
  height: 400px; // arbitrary
  text-align: center;
  justify-content: center;
  align-items: center;
  color: ${({theme:e})=>e.colors.grayscale.base};
`;var Yo=({onClick:e})=>Object(L.jsx)(Qo,null,Object(L.jsx)("p",null,Object(_.e)("You have removed this filter.")),Object(L.jsx)("div",null,Object(L.jsx)(An.a,{buttonStyle:"primary",onClick:e},Object(_.e)("Restore Filter")))),Xo=n(918);var Jo=({hasDefaultValue:e,filterId:t,hasDataset:n,form:r,setDataMask:i,formData:a,enableNoResults:o})=>{var s,l;const c=(r.getFieldValue("filters")||{})[t],d=null==c?void 0:c.defaultValueQueriesData,u=n&&null===d,h=null==(s=c.defaultDataMask)?void 0:s.filterState.value,p=e&&null==h;return u?Object(L.jsx)(M.a,{position:"inline-centered"}):Object(L.jsx)(Xo.a,{height:32,width:"filter_time"===(null==c?void 0:c.filterType)?350:250,appSection:Ta.a.FILTER_CONFIG_MODAL,behaviors:[Ta.b.NATIVE_FILTER],formData:a,queriesData:n?null==c?void 0:c.defaultValueQueriesData:[{data:[{}]}],chartType:null==c?void 0:c.filterType,hooks:{setDataMask:i},enableNoResults:o,filterState:{...null==(l=c.defaultDataMask)?void 0:l.filterState,validateMessage:p&&Object(_.e)("Value is required"),validateStatus:p&&"error"}})};const Zo=$.g.div`
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  min-height: ${({theme:e})=>10*e.gridUnit}px;
  padding-top: ${({theme:e})=>2*e.gridUnit+2}px;

  .checkbox {
    margin-bottom: ${({theme:e,checked:t})=>t?e.gridUnit:0}px;
  }

  & > div {
    margin-bottom: ${({theme:e})=>2*e.gridUnit}px;
  }
`,es=e=>{const{checked:t,disabled:n,title:r,tooltip:i,children:a,onChange:o=(()=>{}),initialValue:s=!1}=e,[l,c]=Object(w.useState)(s);return Object(w.useEffect)(()=>{void 0!==t&&c(t)},[t]),Object(L.jsx)(Zo,{checked:l},Object(L.jsx)(Yt.f,{className:"checkbox",checked:l,disabled:n,onChange:e=>{const n=e.target.checked;void 0===t&&c(n),o(n)}},Object(L.jsx)(R.a.Fragment,null,r,"",i&&Object(L.jsx)(Fo.a,{placement:"top",tooltip:i}))),l&&a)},ts=new Ha.a,ns=Eo(Vn.a.get,ts,({endpoint:e})=>e||""),rs=({onChange:e,value:t})=>{const n=Object(w.useCallback)(({error:e,message:t})=>{let n=t||e||Object(_.e)("An error has occurred");return"Forbidden"===t&&(n=Object(_.e)("You do not have permission to edit this dashboard")),n},[]);return Object(L.jsx)(Xt.a,{ariaLabel:Object(_.e)("Dataset"),value:t,options:async(e,t,r)=>{const i=fi.a.encode({filters:[{col:"table_name",opr:"ct",value:e}],page:t,page_size:r,order_column:"table_name",order_direction:"asc"});return ns({endpoint:`/api/v1/dataset/?q=${i}`}).then(e=>{var t,n;return{data:Ft()(t=Tt()(n=e.json.result).call(n,Ja)).call(t,(e,t)=>e.label.localeCompare(t.label)),totalCount:e.json.count}}).catch(async e=>{const t=n(await Object(Lo.a)(e));throw new Error(t)})},onChange:e})};var is=e=>Object(w.useMemo)(()=>Object(L.jsx)(rs,e),[]);const{TabPane:as}=H.c,os=$.g.div`
  display: flex;
  flex-direction: row-reverse;
  justify-content: space-between;
`,ss=$.g.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  width: 100%;
`,ls=Object($.g)(ir.b)`
  width: 49%;
  margin-bottom: ${({theme:e})=>4*e.gridUnit}px;

  & .ant-form-item-label {
    padding-bottom: 0;
  }

  & .ant-form-item-control-input {
    min-height: ${({theme:e})=>10*e.gridUnit}px;
  }
`,cs=Object($.g)(ir.b)`
  margin-bottom: 0;
  padding-bottom: 0;
  min-width: 50%;

  & .ant-form-item-label {
    padding-bottom: 0;
  }

  .ant-form-item-control-input-content > div > div {
    height: auto;
  }

  & .ant-form-item-control-input {
    min-height: ${({theme:e})=>10*e.gridUnit}px;
  }
`,ds=Object($.g)(ir.b)`
  min-width: 50%;

  & .ant-form-item-label {
    padding-bottom: 0;
  }

  .ant-form-item {
    margin-bottom: 0;
  }

  .ant-form-item-control-input-content > div > div {
    height: auto;
  }

  .ant-form-item-extra {
    display: none;
  }

  & .ant-form-item-control-input {
    height: auto;
  }
`,us=$.g.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
  text-transform: uppercase;
`,hs=Object($.g)(ir.b)`
  margin-bottom: 0;
`,ps=$.g.div`
  display: flex;
  flex-direction: row;
  align-items: center;
`,fs=Object($.g)(zn.a.Refresh)`
  margin-left: ${({theme:e})=>2*e.gridUnit}px;
  color: ${({theme:e})=>e.colors.primary.base};
`,bs=Object($.g)(Po.a)`
  margin-left: ${({theme:e})=>-4*e.gridUnit-1}px;
  margin-right: ${({theme:e})=>-4*e.gridUnit}px;
  border-left: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  border-radius: 0;

  .ant-collapse-header {
    border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    border-top: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
    margin-top: -1px;
    border-radius: 0;
  }

  .ant-collapse-content {
    border: 0;
  }

  .ant-collapse-content-box {
    padding-top: ${({theme:e})=>2*e.gridUnit}px;
  }

  &.ant-collapse > .ant-collapse-item {
    border: 0;
    border-radius: 0;
  }
`,ms=Object($.g)(H.c)`
  .ant-tabs-nav {
    position: sticky;
    margin-left: ${({theme:e})=>-4*e.gridUnit}px;
    margin-right: ${({theme:e})=>-4*e.gridUnit}px;
    top: 0;
    background: white;
    z-index: 1;
  }

  .ant-tabs-nav-list {
    padding: 0;
  }

  .ant-form-item-label {
    padding-bottom: 0;
  }
`,gs=$.g.span`
  color: ${({theme:e})=>e.colors.error.base};
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
  margin-left: ${({theme:e})=>e.gridUnit-1}px;
  &:before {
    content: '*';
  }
`,vs={configuration:{key:"configuration",name:Object(_.e)("Configuration")},scoping:{key:"scoping",name:Object(_.e)("Scoping")}},js={basic:{key:"basic",name:Object(_.e)("Basic")},advanced:{key:"advanced",name:Object(_.e)("Advanced")}},ys=["filter_select","filter_range"],xs=["enableEmptyFilter","multiSelect"],Os={[Object(_.e)("Select filter")]:Object(_.e)("Value"),[Object(_.e)("Range filter")]:Object(_.e)("Numerical range"),[Object(_.e)("Time filter")]:Object(_.e)("Time range"),[Object(_.e)("Time column")]:Object(_.e)("Time column"),[Object(_.e)("Time grain")]:Object(_.e)("Time grain"),[Object(_.e)("Group By")]:Object(_.e)("Group by")},Cs=new Ha.a,Ss=Eo(Vn.a.get,Cs,({endpoint:e})=>e||""),ws=({filterId:e,filterToEdit:t,removed:n,restoreFilter:r,form:a,parentFilters:o},s)=>{var c,d,u,h,p,b,g,j,y,x,C,S,k,T,F,E,D,P,I,N,q,A,U,$,V,H;const[B,W]=Object(w.useState)(""),[G,K]=Object(w.useState)([]),[Q,Y]=Object(w.useState)(vs.configuration.key),[X,J]=Object(w.useState)(js.basic.key),Z=Ya(),[ee,te]=Object(w.useState)(),ne=Object(w.useMemo)(()=>({}),[]),re=(null==(c=a.getFieldValue("filters"))?void 0:c[e])||ne,ie=Object(ka.a)().items,ae=Tt()(d=O()(u=Rt()(ie)).call(u,([,{value:e}])=>{var t;return null==(t=e.behaviors)?void 0:l()(t).call(t,Ta.b.NATIVE_FILTER)})).call(d,([e])=>e),oe=Object(i.d)(({datasources:e})=>e),se=Object(i.d)(({charts:e})=>e),le=Object(w.useMemo)(()=>{var e;return wr()(e=m()(oe)).call(e,e=>Za(e))},[oe]),ce=Object(w.useMemo)(()=>{var e;const t=z()(e=m()(oe)).call(e,e=>{var t;return e.id===(null==(t=re.dataset)?void 0:t.value)});return!t||Za(t)},[null==(h=re.dataset)?void 0:h.value,oe]),de=!(null==(p=ie[null==re?void 0:re.filterType])||null==(b=p.value)||!b.datasourceCount),ue=null!=(g=null!=(j=null==re?void 0:null==(y=re.dataset)?void 0:y.value)?j:null==t?void 0:null==(x=t.targets[0])?void 0:x.datasetId)?g:((e,t)=>{var n,r;const i=new Ha.a;let a="",o=0;return v()(n=m()(t)).call(n,e=>{const{formData:t}=e;if(t){const{datasource:e}=t,n=(i.get(e)||0)+1;i.set(e,n),n>o&&(o=n,a=e)}}),null==(r=e[a])?void 0:r.id})(oe,se),{controlItems:he={},mainControlItems:pe={}}=re?Ko({datasetId:ue,disabled:!1,forceUpdate:Z,form:a,filterId:e,filterType:re.filterType,filterToEdit:t,formFilter:re,removed:n}):{},fe=!!pe.groupby,be=!(null==(S=(null!=(C=ie[null==re?void 0:re.filterType])?C:{}).value)||!S.enableNoResults);Object(w.useEffect)(()=>{ue&&Ss({endpoint:`/api/v1/dataset/${ue}`}).then(e=>{var t,n,r;K(null==(t=e.json)?void 0:null==(n=t.result)?void 0:n.metrics);const i=null==(r=e.json)?void 0:r.result;i.type=i.datasource_type,i.filter_select=!0,te(i)}).catch(e=>{Object(na.c)(e.message)})},[ue]),Object(w.useImperativeHandle)(s,()=>({changeTab(e){Y(e)}}));const me=fe&&!!G.length,ge=!de||ue&&((null==re?void 0:re.column)||!fe),ve=l()(ys).call(ys,null==re?void 0:re.filterType),je=l()(Ds).call(Ds,null==re?void 0:re.filterType),ye=null==(k=null==re?void 0:re.isDataDirty)||k;((e,t)=>{var n;const r=Ya(),i=(e.getFieldValue("filters")||{})[t];Object(w.useEffect)(()=>{Xa(e,t,{isDataDirty:!0,defaultValueQueriesData:null}),r()},[e,null==i?void 0:i.filterType,null==i?void 0:i.column,null==i?void 0:null==(n=i.dataset)?void 0:n.value,di()(null==i?void 0:i.adhoc_filters),null==i?void 0:i.time_range,r,t])})(a,e);const xe=t=>{Xa(a,e,t),W(""),Z()},Oe=Object(w.useCallback)((t=!1)=>{var n,r;if(!de||null==re||null==(n=re.dataset)||!n.value)return void Z();const i=Object(ha.c)({datasetId:null==re?void 0:null==(r=re.dataset)?void 0:r.value,groupby:null==re?void 0:re.column,...re});xe({defaultValueQueriesData:null,isDataDirty:!1}),Object(ca.getChartDataRequest)({formData:i,force:t,requestParams:{dashboardId:0}}).then(({response:e,json:t})=>{if(Object(qn.c)(qn.a.GLOBAL_ASYNC_QUERIES)){const n="result"in t?t.result[0]:t;if(200===e.status)xe({defaultValueQueriesData:[n]});else{if(202!==e.status)throw new Error(`Received unexpected response status (${e.status}) while fetching chart data`);Object(Io.a)(n).then(e=>{xe({defaultValueQueriesData:e})}).catch(e=>{W(e.message||e.error||Object(_.e)("Check configuration"))})}}else xe({defaultValueQueriesData:t.result})}).catch(t=>{t.json().then(n=>{(t=>{Xa(a,e,{defaultValueQueriesData:null}),W(t),Z()})(n.message||t.statusText||Object(_.e)("Check configuration"))})})},[e,Z,a,re,de]),Ce=Object(ha.c)({datasetId:ue,groupby:fe?null==re?void 0:re.column:void 0,...re}),[Se,we,Re,ke]=((e,t)=>{var n,r;const i=!(null==e||null==(n=e.controlValues)||!n.enableEmptyFilter),a=!(null==e||null==(r=e.controlValues)||!r.defaultToFirstItem),[o,s]=Object(w.useState)(!1),[l,c]=Object(w.useState)(i),[d,u]=Object(w.useState)(""),h=(e=!1)=>{const t=i&&!a;c(t),s(!!t||e)};return Object(w.useEffect)(()=>{var t,n;h(!a&&!(null==e||null==(t=e.defaultDataMask)||null==(n=t.filterState)||!n.value))},[a,i]),Object(w.useEffect)(()=>{var e,n;h(!a&&!(null==t||null==(e=t.defaultDataMask)||null==(n=e.filterState)||!n.value))},[]),Object(w.useEffect)(()=>{let e="";a?e=Object(_.e)('Default value set automatically when "Default to first item" is checked'):l?e=Object(_.e)('Default value must be set when "Required" is checked'):o&&(e=Object(_.e)('Default value must be set when "Filter has default value" is checked')),u(e)},[o,l,a]),[o,l,d,h]})(re,t),Te=!ue||ee||(null==re?void 0:null==(T=re.dataset)?void 0:T.label);Object(w.useEffect)(()=>{de&&ge&&Se&&ye&&Oe()},[de,ge,Se,re,ye,Oe,Te]);const _e=Object(w.useCallback)(()=>{a.setFields([{name:"changed",value:!0}])},[a]),Fe=Object(w.useCallback)(t=>{Xa(a,e,t),_e()},[e,a,_e]),Ee=Tt()(o).call(o,e=>({value:e.id,label:e.title})),Me=z()(Ee).call(Ee,({value:e})=>e===(null==t?void 0:t.cascadeParentIds[0])),De=!!Me,Pe=!(null==t||!t.adhoc_filters)||!(null==t||!t.time_range),Ie="boolean"==typeof(null==t?void 0:null==(F=t.controlValues)?void 0:F.sortAscending);let Ne=null==t?void 0:null==(E=t.controlValues)?void 0:E.sortAscending;"boolean"==typeof(null==re?void 0:null==(D=re.controlValues)?void 0:D.sortAscending)&&(Ne=re.controlValues.sortAscending);const qe=!de||!ye&&ge||!pe.groupby,ze=t=>{var n;const r=null==(n=a.getFieldValue("filters"))?void 0:n[e].controlValues;Xa(a,e,{controlValues:{...r,sortAscending:t}}),Z()},Ae=()=>_n()(()=>a.validateFields([["filters",e,"adhoc_filters"],["filters",e,"time_range"]]),0),Ue=(null==re?void 0:re.time_range)&&"No filter"!==re.time_range,$e=(null==re?void 0:null==(P=re.adhoc_filters)?void 0:P.length)>0,Le=null==re?void 0:null==(I=re.controlValues)?void 0:I.defaultToFirstItem,Ve="filter_select"===(null==re?void 0:re.filterType)||"filter_range"===(null==re?void 0:re.filterType),He=re.filterType===(null==t?void 0:t.filterType)?null==t?void 0:t.defaultDataMask:null,Be=()=>Ue||$e?_o.a.resolve():_o.a.reject(new Error(Object(_.e)("Pre-filter is required")));let We=De||Pe||Ie;var Ge,Ke;We||(We=wr()(Ge=O()(Ke=f()(he)).call(Ke,e=>!l()(xs).call(xs,e))).call(Ge,e=>he[e].checked));Object(w.useEffect)(()=>{const e=[js.basic.key];We&&e.push(js.advanced.key),J(e)},[We]);const Qe=Object(w.useMemo)(()=>{var e,t;const n=[];return void 0===(null==re?void 0:null==(e=re.dataset)?void 0:e.value)?[]:(v()(t=m()(se)).call(t,e=>{var t,r,i;const a=null==(t=e.formData)?void 0:t.datasource;void 0!==a&&(null==(r=oe[a])?void 0:r.id)!==(null==re?void 0:null==(i=re.dataset)?void 0:i.value)&&n.push(e.id)}),n)},[di()(se),null==re?void 0:null==(N=re.dataset)?void 0:N.value,di()(oe)]);return n?Object(L.jsx)(Yo,{onClick:()=>r(e)}):Object(L.jsx)(ms,{activeKey:Q,onChange:e=>Y(e),centered:!0},Object(L.jsx)(as,{tab:vs.configuration.name,key:vs.configuration.key,forceRender:!0},Object(L.jsx)(os,null,Object(L.jsx)(ls,{name:["filters",e,"name"],label:Object(L.jsx)(us,null,Object(_.e)("Filter name")),initialValue:null==t?void 0:t.name,rules:[{required:!n,message:Object(_.e)("Name is required")}]},Object(L.jsx)(Yt.m,Ms("name-input"))),Object(L.jsx)(ls,Wn()({name:["filters",e,"filterType"],rules:[{required:!n,message:Object(_.e)("Name is required")}],initialValue:(null==t?void 0:t.filterType)||"filter_select",label:Object(L.jsx)(us,null,Object(_.e)("Filter Type"))},Ms("filter-type")),Object(L.jsx)(Xt.a,{ariaLabel:Object(_.e)("Filter type"),options:Tt()(ae).call(ae,e=>{var t,n,r;const i=null==(t=ie[e])?void 0:t.value.name,a=i?Os[i]:void 0,o=1===(null==(n=Qa[e])?void 0:n.length)&&(null==(r=Qa[e])?void 0:l()(r).call(r,Ga.a.TEMPORAL))&&!le;return{value:e,label:o?Object(L.jsx)(Ii.a,{title:Object(_.e)("Datasets do not contain a temporal column")},a||i):a||i,disabled:o}}),onChange:t=>{Xa(a,e,{filterType:t,defaultDataMask:null,column:null}),Z()}}))),de&&Object(L.jsx)(ss,null,Te?Object(L.jsx)(ls,Wn()({name:["filters",e,"dataset"],label:Object(L.jsx)(us,null,Object(_.e)("Dataset")),initialValue:ee?{label:ee.table_name,value:ee.id}:void 0,rules:[{required:!n,message:Object(_.e)("Dataset is required")}]},Ms("datasource-input")),Object(L.jsx)(is,{onChange:t=>{t.value!==ue&&Xa(a,e,{dataset:t,defaultDataMask:null,column:null}),Z()}})):Object(L.jsx)(ls,{label:Object(L.jsx)(us,null,Object(_.e)("Dataset"))},Object(L.jsx)(M.a,{position:"inline-centered"})),de&&Tt()(q=f()(pe)).call(q,e=>pe[e].element)),Object(L.jsx)(bs,{activeKey:X,onChange:e=>J(e),expandIconPosition:"right"},Object(L.jsx)(Po.a.Panel,{forceRender:!0,header:js.basic.name,key:js.basic.key},Object(L.jsx)(hs,{name:["filters",e,"defaultValueQueriesData"],hidden:!0,initialValue:null}),Object(L.jsx)(es,{title:Object(_.e)("Filter has default value"),initialValue:Se,disabled:we||Le,tooltip:Re,checked:Se,onChange:e=>{ke(e),_e()}},re.filterType&&Object(L.jsx)(ds,{name:["filters",e,"defaultDataMask"],initialValue:He,label:Object(L.jsx)(us,null,Object(_.e)("Default Value")),required:Se,rules:[{validator:()=>{var e,t;return null!=re&&null!=(e=re.defaultDataMask)&&null!=(t=e.filterState)&&t.value?_o.a.resolve():_o.a.reject(new Error(Object(_.e)("Default value is required")))}}]},B?Object(L.jsx)(Ao,{title:Object(_.e)("Cannot load filter"),body:B,level:"error"}):qe?Object(L.jsx)(ps,null,Object(L.jsx)(Jo,{setDataMask:t=>{var n,r;ua()(null==He?void 0:null==(n=He.filterState)?void 0:n.value,null==t?void 0:null==(r=t.filterState)?void 0:r.value)||_e(),Xa(a,e,{defaultDataMask:t}),a.validateFields([["filters",e,"defaultDataMask"]]),Z()},hasDefaultValue:Se,filterId:e,hasDataset:de,form:a,formData:Ce,enableNoResults:be}),de&&ue&&Object(L.jsx)(Ii.a,{title:Object(_.e)("Refresh the default values")},Object(L.jsx)(fs,{onClick:()=>Oe(!0)}))):Object(_.e)('Fill all required fields to enable "Default Value"'))),Tt()(A=O()(U=f()(he)).call(U,e=>l()(xs).call(xs,e))).call(A,e=>he[e].element)),Ve&&Object(L.jsx)(Po.a.Panel,{forceRender:!0,header:js.advanced.name,key:js.advanced.key},je&&Object(L.jsx)(es,{title:Object(_.e)("Filter is hierarchical"),initialValue:De,onChange:t=>{_e(),t&&_n()(()=>a.validateFields([["filters",e,"parentFilter"]]),0)}},Object(L.jsx)(ds,{name:["filters",e,"parentFilter"],label:Object(L.jsx)(us,null,Object(_.e)("Parent filter")),initialValue:Me,normalize:e=>e?{value:e}:void 0,required:!0,rules:[{required:!0,message:Object(_.e)("Parent filter is required")}]},Object(L.jsx)(({value:e,...t})=>Object(L.jsx)(Xt.a,Wn()({ariaLabel:Object(_.e)("Parent filter"),placeholder:Object(_.e)("None"),options:Ee,allowClear:!0,value:null==e?void 0:e.value},t)),null))),Tt()($=O()(V=f()(he)).call(V,e=>!l()(xs).call(xs,e))).call($,e=>he[e].element),de&&ve&&Object(L.jsx)(es,{title:Object(_.e)("Pre-filter available values"),initialValue:Pe,onChange:e=>{_e(),e&&Ae()}},Object(L.jsx)(ds,{name:["filters",e,"adhoc_filters"],initialValue:null==t?void 0:t.adhoc_filters,required:!0,rules:[{validator:Be}]},Object(L.jsx)(Mo.a,{columns:(null==ee?void 0:null==(H=ee.columns)?void 0:O()(H).call(H,e=>e.filterable))||[],savedMetrics:(null==ee?void 0:ee.metrics)||[],datasource:ee,onChange:t=>{Xa(a,e,{adhoc_filters:t}),Z(),Ae()},label:Object(L.jsx)("span",null,Object(L.jsx)(us,null,Object(_.e)("Pre-filter")),!Ue&&Object(L.jsx)(gs,null))})),ce&&Object(L.jsx)(cs,{name:["filters",e,"time_range"],label:Object(L.jsx)(us,null,Object(_.e)("Time range")),initialValue:(null==t?void 0:t.time_range)||"No filter",required:!$e,rules:[{validator:Be}]},Object(L.jsx)(Do.a,{name:"time_range",onChange:t=>{Xa(a,e,{time_range:t}),Z(),Ae()}})),Ue&&Object(L.jsx)(cs,{name:["filters",e,"granularity_sqla"],label:Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(us,null,Object(_.e)("Time column")),"",Object(L.jsx)(Fo.a,{placement:"top",tooltip:Object(_.e)("Optional time column if time range should apply to another column than the default time column")})),initialValue:null==t?void 0:t.granularity_sqla},Object(L.jsx)(Bo,{allowClear:!0,form:a,formField:"granularity_sqla",filterId:e,filterValues:e=>!!e.is_dttm,datasetId:ue,onChange:t=>{Xa(a,e,{granularity_sqla:t}),Z()}}))),"filter_range"!==(null==re?void 0:re.filterType)&&Object(L.jsx)(es,{title:Object(_.e)("Sort filter values"),onChange:e=>{ze(e||void 0),_e()},initialValue:Ie},Object(L.jsx)(cs,{name:["filters",e,"controlValues","sortAscending"],initialValue:Ne,label:Object(L.jsx)(us,null,Object(_.e)("Sort type"))},Object(L.jsx)(dr.a.Group,{onChange:e=>{ze(e.target.value)}},Object(L.jsx)(dr.a,{value:!0},Object(_.e)("Sort ascending")),Object(L.jsx)(dr.a,{value:!1},Object(_.e)("Sort descending")))),me&&Object(L.jsx)(ds,{name:["filters",e,"sortMetric"],initialValue:null==t?void 0:t.sortMetric,label:Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(us,null,Object(_.e)("Sort Metric")),"",Object(L.jsx)(Fo.a,{placement:"top",tooltip:Object(_.e)("If a metric is specified, sorting will be done based on the metric value")}))},Object(L.jsx)(Xt.a,{allowClear:!0,ariaLabel:Object(_.e)("Sort metric"),name:"sortMetric",options:Tt()(G).call(G,e=>{var t;return{value:e.metric_name,label:null!=(t=e.verbose_name)?t:e.metric_name}}),onChange:t=>{void 0!==t&&(Xa(a,e,{sortMetric:t}),Z())}})))))),Object(L.jsx)(as,{tab:vs.scoping.name,key:vs.scoping.key,forceRender:!0},Object(L.jsx)(La,{updateFormValues:Fe,pathToFormValue:["filters",e],forceUpdate:Z,filterScope:null==t?void 0:t.scope,formFilterScope:null==re?void 0:re.scope,formScopingType:null==re?void 0:re.scoping,initiallyExcludedCharts:Qe})))};var Rs=Object(w.forwardRef)(ws),ks=n(4984),Ts=n.n(ks);const _s=Object($.g)(_a.a)`
  min-width: 700px;
  .ant-modal-body {
    padding: 0px;
  }
`,Fs=$.g.div`
  display: flex;
  height: 700px;
  flex-direction: row;
  .filters-list {
    width: ${({theme:e})=>50*e.gridUnit}px;
    overflow: auto;
  }
`,Es=Object($.g)(Yt.l)`
  width: 100%;
`,Ms=Object(io.a)("filters-config-modal"),Ds=["filter_select"];function Ps({isOpen:e,initialFilterId:t,createNewOnOpen:n,onSave:r,onCancel:i}){const[a]=Yt.l.useForm(),o=Object(w.useRef)(),s=oo(),c=function(){const e=oo();return Object(w.useMemo)(()=>P()(e).call(e,(e,t)=>(e[t.id]=t,e),{}),[e])}(),[d,u]=Object(w.useState)([]),[h,p]=Object(w.useState)({}),[f,b]=Object(w.useState)(!1),g=Object(w.useMemo)(()=>{var e;return O()(e=ro()([...Object(uo.f)(s),...d])).call(e,e=>{var t;return!h[e]||(null==(t=h[e])?void 0:t.isPending)})},[s,d,h]),v=null!=t?t:g[0],[j,y]=Object(w.useState)(v),[x,C]=Object(w.useState)({filters:{}}),S=O()(d).call(d,e=>!h[e]),R=e=>{const t=h[e];null!=t&&t.isPending&&clearTimeout(t.timerId),p(t=>({...t,[e]:null}))},k=Object(w.useCallback)(()=>{const e=Object(uo.e)();u([...d,e]),y(e),b(!1)},[d,y]);((e,t,n)=>{const r=Object(Uo.a)(e);Object(w.useEffect)(()=>{n&&e&&!r&&t()},[n,e,r,t])})(e,k,n),((e,t,n,r)=>{Object(w.useEffect)(()=>{const i=e[t];if(i&&!i.isPending){const i=Ts()(n,n=>!e[n]&&n!==t);-1!==i&&r(n[i])}},[t,e,n])})(h,j,g,y);const T=Object(uo.d)(p,b,k),F=()=>{u([]),y(v),p({}),b(!1),C({filters:{}}),a.setFieldsValue({changed:!1})},E=e=>{var t,n,r,i;return null!=(t=null!=(n=null==(r=x.filters[e])?void 0:r.name)?n:null==(i=c[e])?void 0:i.name)?t:Object(_.e)("New filter")},M=e=>{var t,n;return Tt()(t=O()(n=O()(g).call(g,t=>t!==e&&!h[t])).call(n,e=>{var t;return l()(Ds).call(Ds,x.filters[e]?x.filters[e].filterType:null==(t=c[e])?void 0:t.filterType)})).call(t,e=>({id:e,title:E(e)}))},D=async()=>{const e=await Object(uo.g)(a,j,c,g,h,y);e?(Object(uo.c)(c,g,h,r,e)(),F()):o.current.changeTab("configuration")},I=()=>{F(),i()},N=()=>{const e=a.getFieldValue("changed");S.length>0||a.isFieldsTouched()||e?b(!0):I()};return Object(L.jsx)(_s,{visible:e,maskClosable:!1,title:Object(_.e)("Filters configuration and scoping"),width:"50%",destroyOnClose:!0,onCancel:N,onOk:D,centered:!0,footer:Object(L.jsx)(bo,{onDismiss:()=>b(!1),onCancel:N,handleSave:D,saveAlertVisible:f,onConfirmCancel:I})},Object(L.jsx)(V.a,null,Object(L.jsx)(Fs,null,Object(L.jsx)(Es,{preserve:!1,form:a,onValuesChange:(e,t)=>{var n;e.filters&&wr()(n=m()(e.filters)).call(n,e=>null!=e.name)&&C(t),b(!1)},layout:"vertical"},Object(L.jsx)(ko,{onEdit:T,onChange:y,getFilterTitle:E,currentFilterId:j,filterIds:g,removedFilters:h,restoreFilter:R},e=>Object(L.jsx)(Rs,{ref:o,form:a,filterId:e,filterToEdit:c[e],removed:!!h[e],restoreFilter:R,parentFilters:M(e)}))))))}var Is=({isOpen:e,chartId:t,onClose:n})=>{var r,a;const o=Object(i.c)(),[s]=Yt.l.useForm(),l=Object(i.d)(({dashboardInfo:e})=>{var t;return null==e?void 0:null==(t=e.metadata)?void 0:t.chart_configuration}),c=null==l?void 0:null==(r=l[t])?void 0:null==(a=r.crossFilters)?void 0:a.scope,d=()=>{o(Object(ea.c)({...l,[t]:{id:t,crossFilters:{scope:s.getFieldValue("scope")}}})),n()};return Object(L.jsx)(_a.a,{visible:e,maskClosable:!1,title:Object(_.e)("Cross Filter Scoping"),width:"55%",destroyOnClose:!0,onCancel:n,onOk:d,centered:!0,footer:Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(An.a,{key:"cancel",buttonStyle:"secondary",onClick:n},Object(_.e)("Cancel")),Object(L.jsx)(An.a,{key:"submit",buttonStyle:"primary",onClick:d},Object(_.e)("Save")))},Object(L.jsx)(Es,{preserve:!1,form:s,layout:"vertical"},Object(L.jsx)(to,{form:s,scope:c,chartId:t})))},Ns=n(1966);const qs="cross_filter_scoping",zs="download_as_image",As="explore_chart",Us="export_csv",$s="export_full_csv",Ls="force_refresh",Vs="resize_label",Hs="toggle_chart_description",Bs="view_query",Ws=$.g.div`
  padding: ${({theme:e})=>e.gridUnit/4}px
    ${({theme:e})=>1.5*e.gridUnit}px;

  .dot {
    display: block;
  }

  &:hover {
    cursor: pointer;
  }
`,Gs=$.g.div`
  height: auto;
  margin: ${({theme:e})=>e.gridUnit}px 0;
  color: ${({theme:e})=>e.colors.grayscale.base};
  line-height: ${({theme:e})=>1.5*e.typography.sizes.m}px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: flex-start;
`,Ks=()=>Object(L.jsx)(Ws,null,Object(L.jsx)("span",{className:"dot"}),Object(L.jsx)("span",{className:"dot"}),Object(L.jsx)("span",{className:"dot"}));class Qs extends R.a.PureComponent{constructor(e){var t,n,r;super(e),this.toggleControls=S()(t=this.toggleControls).call(t,this),this.refreshChart=S()(n=this.refreshChart).call(n,this),this.handleMenuClick=S()(r=this.handleMenuClick).call(r,this),this.state={showControls:!1,showCrossFilterScopingModal:!1}}refreshChart(){this.props.updatedDttm&&this.props.forceRefresh(Ca()(this.props).slice_id,this.props.dashboardId)}toggleControls(){this.setState(e=>({showControls:!e.showControls}))}handleMenuClick({key:e,domEvent:t}){switch(e){case Ls:this.refreshChart();break;case qs:this.setState({showCrossFilterScopingModal:!0});break;case Hs:this.props.toggleExpandSlice&&this.props.toggleExpandSlice(Ca()(this.props).slice_id);break;case As:this.props.logExploreChart&&this.props.logExploreChart(Ca()(this.props).slice_id);break;case Us:this.props.exportCSV&&this.props.exportCSV(Ca()(this.props).slice_id);break;case Vs:this.props.handleToggleFullSize();break;case $s:this.props.exportFullCSV&&this.props.exportFullCSV(Ca()(this.props).slice_id);break;case zs:{const e=document.querySelector(".ant-dropdown:not(.ant-dropdown-hidden)");e.style.visibility="hidden",Object(li.a)(".dashboard-component-chart-holder",Ca()(this.props).slice_name)(t).then(()=>{e.style.visibility="visible"});break}}}render(){var e,t,n;const{slice:r,isFullSize:i,componentId:a,cachedDttm:o=[],updatedDttm:s=null,addSuccessToast:c=(()=>{}),addDangerToast:d=(()=>{}),supersetCanShare:u=!1,isCached:p=[]}=this.props,f=Object(ka.a)().items,b="table"===r.viz_type,m=z()(e=O()(t=Rt()(f)).call(t,([,{value:e}])=>{var t;return null==(t=e.behaviors)?void 0:l()(t).call(t,Ta.b.INTERACTIVE_CHART)})).call(e,([e])=>e===r.viz_type),g=Tt()(n=o||[]).call(n,e=>Dn.a.utc(e).fromNow()),v=s?Dn.a.utc(s).fromNow():"",j=[...new h.a(Tt()(p).call(p,e=>e?Object(_.e)("Cached %s",g):v?Object(_.e)("Fetched %s",v):"")||"")],y=Tt()(j).call(j,(e,t)=>Object(L.jsx)("div",{key:`tooltip-${t}`},j.length>1?`${Object(_.e)("Query")} ${t+1}: ${e}`:e)),x=i?Object(_.e)("Minimize chart"):Object(_.e)("Maximize chart"),C=Object(L.jsx)(Yt.q,{onClick:this.handleMenuClick,selectable:!1},Object(L.jsx)(Yt.q.Item,{key:Ls,disabled:"loading"===this.props.chartStatus,style:{height:"auto",lineHeight:"initial"}},Object(_.e)("Force refresh"),Object(L.jsx)(Gs,null,y)),Object(L.jsx)(Yt.q.Divider,null),r.description&&Object(L.jsx)(Yt.q.Item,{key:Hs},Object(_.e)("Toggle chart description")),this.props.supersetCanExplore&&Object(L.jsx)(Yt.q.Item,{key:As},Object(L.jsx)("a",{href:this.props.exploreUrl,rel:"noopener noreferrer"},Object(_.e)("View chart in Explore"))),this.props.supersetCanExplore&&Object(L.jsx)(Yt.q.Item,{key:Bs},Object(L.jsx)(Xn.a,{triggerNode:Object(L.jsx)("span",null,Object(_.e)("View query")),modalTitle:Object(_.e)("View query"),modalBody:Object(L.jsx)(Ns.a,{latestQueryFormData:this.props.formData}),responsive:!0})),u&&Object(L.jsx)(Qn,{url:ji({pathname:window.location.pathname,filters:Object($r.b)(),hash:a}),copyMenuItemTitle:Object(_.e)("Copy chart URL"),emailMenuItemTitle:Object(_.e)("Share chart by email"),emailSubject:Object(_.e)("Superset chart"),emailBody:Object(_.e)("Check out this chart: "),addSuccessToast:c,addDangerToast:d}),Object(L.jsx)(Yt.q.Item,{key:Vs},x),Object(L.jsx)(Yt.q.Item,{key:zs},Object(_.e)("Download as image")),"filter_box"!==Ca()(this.props).viz_type&&this.props.supersetCanCSV&&Object(L.jsx)(Yt.q.Item,{key:Us},Object(_.e)("Export CSV")),"filter_box"!==Ca()(this.props).viz_type&&Object(qn.c)(qn.a.ALLOW_FULL_CSV_EXPORT)&&this.props.supersetCanCSV&&b&&Object(L.jsx)(Yt.q.Item,{key:$s},Object(_.e)("Export full CSV")),Object(qn.c)(qn.a.DASHBOARD_CROSS_FILTERS)&&m&&Object(L.jsx)(Yt.q.Item,{key:qs},Object(_.e)("Cross-filter scoping")));return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Is,{chartId:r.slice_id,isOpen:this.state.showCrossFilterScopingModal,onClose:()=>this.setState({showCrossFilterScopingModal:!1})}),i&&Object(L.jsx)(zn.a.FullscreenExitOutlined,{style:{fontSize:22},onClick:()=>{this.props.handleToggleFullSize()}}),Object(L.jsx)(Yt.s,{overlay:C,trigger:["click"],placement:"bottomRight",getPopupContainer:e=>e.closest(".dashboard-component-chart-holder")},Object(L.jsx)("span",{id:`slice_${r.slice_id}-controls`,role:"button","aria-label":"More Options"},Object(L.jsx)(Ks,null))))}}var Ys=Qs,Xs=n(4985),Js=n.n(Xs),Zs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},el=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:Zs}))};el.displayName="CheckCircleFilled";var tl=w.forwardRef(el),nl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},rl=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:nl}))};rl.displayName="ExclamationCircleFilled";var il=w.forwardRef(rl),al={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]},name:"minus-circle",theme:"filled"},ol=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:al}))};ol.displayName="MinusCircleFilled";var sl=w.forwardRef(ol),ll=n(144);const cl=$.g.div`
  display: inline-block;
  color: ${({theme:e})=>e.colors.grayscale.light5};
  background: ${({theme:e})=>e.colors.grayscale.base};
  border-radius: 1em;
  vertical-align: text-top;
  padding: ${({theme:e})=>`${e.gridUnit}px ${2*e.gridUnit}px`};
  font-size: ${({theme:e})=>e.typography.sizes.m}px;
  font-weight: bold;
  min-width: 1em;
  min-height: 1em;
  line-height: 1em;
  vertical-align: middle;
  white-space: nowrap;

  svg {
    position: relative;
    top: -2px;
    color: ${({theme:e})=>e.colors.grayscale.light5};
    width: 1em;
    height: 1em;
    display: inline-block;
    vertical-align: middle;
  }

  &:hover {
    cursor: pointer;
    background: ${({theme:e})=>e.colors.grayscale.dark1};
  }

  &.has-cross-filters {
    background: ${({theme:e})=>e.colors.primary.base};
    &:hover {
      background: ${({theme:e})=>e.colors.primary.dark1};
    }
  }

  &.has-incompatible-filters {
    color: ${({theme:e})=>e.colors.grayscale.dark2};
    background: ${({theme:e})=>e.colors.alert.base};
    &:hover {
      background: ${({theme:e})=>e.colors.alert.dark1};
    }
    svg {
      color: ${({theme:e})=>e.colors.grayscale.dark2};
    }
  }

  &.filters-inactive {
    color: ${({theme:e})=>e.colors.grayscale.light5};
    background: ${({theme:e})=>e.colors.grayscale.light1};
    padding: ${({theme:e})=>e.gridUnit}px;
    text-align: center;
    height: 22px;
    width: 22px;

    &:hover {
      background: ${({theme:e})=>e.colors.grayscale.base};
    }
  }
`,dl=$.g.span`
  position: relative;
  margin-right: ${({theme:e})=>e.gridUnit}px;
  font-weight: ${({bold:e,theme:t})=>e?t.typography.weights.bold:"auto"};
  color: ${({color:e,theme:t})=>e||t.colors.grayscale.light5};
  display: flex;
  align-items: center;
  & > * {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,ul=$.g.i`
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  left: -${({theme:e})=>5*e.gridUnit}px;
`,hl=$.g.button`
  cursor: pointer;
  display: flex;
  flex-wrap: wrap;
  text-align: left;
  padding: 0;
  border: none;
  background: none;
  outline: none;
  width: 100%;

  &::-moz-focus-inner {
    border: 0;
  }

  & i svg {
    color: transparent;
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }

  &:hover i svg {
    color: inherit;
  }
`,pl=$.g.div`
  margin: 0 -${({theme:e})=>4*e.gridUnit}px;
`,fl=$.g.div`
  padding-left: ${({theme:e})=>6*e.gridUnit}px;
  margin: -${({theme:e})=>3*e.gridUnit}px 0;
`,bl=$.g.div`
  min-width: 200px;
  max-width: 300px;
  overflow-x: hidden;
`,ml=$.g.div`
  max-width: 100%;
  flex-grow: 1;
  overflow: auto;
  color: ${({theme:e})=>e.colors.grayscale.light5};
`,gl=$.g.div`
  ${({theme:e})=>`\n  padding-top: ${3*e.gridUnit}px;\n  max-width: 100%;\n  flex-grow: 1;\n  overflow: auto;\n  color: ${e.colors.grayscale.light5};\n  `}
`;var vl=n(4632),jl=n(98),yl=n.n(jl);const xl=Object(_.e)("Please apply filter changes"),Ol=e=>null==e?"":"string"==typeof e||"number"==typeof e?`${e}`:fa()(e)?e.join(", "):"object"==typeof e?di()(e):Object(_.e)("Unknown value"),Cl=({filterSetFilterValues:e,dataMaskSelected:t})=>z()(e).call(e,({dataMask:e={}})=>{const n=Rt()(t);return Ke()(n).call(n,([t,r])=>{var i;const a=Object(Ra.f)(r.filterState,null==e?void 0:null==(i=e[t])?void 0:i.filterState),o=n.length===f()(null!=e?e:{}).length;return a&&o})});var Sl=({indicator:{column:e,name:t,value:n,path:r=[]},onClick:i=(()=>{}),text:a})=>{const o=Ol(n);return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(hl,{onClick:()=>i([...r,`LABEL-${e}`])},Object(L.jsx)(dl,{bold:!0},Object(L.jsx)(ul,null,Object(L.jsx)(vl.a,null)),t,o?": ":""),Object(L.jsx)(ml,null,o)),a&&Object(L.jsx)(gl,null,a))};var wl,Rl,kl=({appliedCrossFilterIndicators:e=[],appliedIndicators:t=[],incompatibleIndicators:n=[],unsetIndicators:r=[],onHighlightFilterSource:a,children:o})=>{const[s,l]=Object(w.useState)(!1),c=Object($.i)(),d=Object(i.d)(e=>{var t;return null==(t=e.dashboardState)?void 0:t.activeTabs});Object(w.useEffect)(()=>{s&&window.addEventListener("resize",()=>l(!1),{once:!0})},[s]),Object(w.useEffect)(()=>{l(!1)},[d]);const u=()=>{const r=[];return e.length&&r.push("appliedCrossFilters"),t.length&&r.push("applied"),n.length&&r.push("incompatible"),r.length?r:["unset"]},[h,p]=Object(w.useState)(()=>[...u()]);const f=e=>`${e.column} - ${e.name}`,b=Object(L.jsx)(bl,null,Object(L.jsx)(L.Global,{styles:Object(L.css)(".filterStatusPopover{.ant-popover-inner{background-color:",c.colors.grayscale.dark2,"cc;.ant-popover-inner-content{padding-top:0;padding-bottom:0;}}&.ant-popover-placement-bottom,&.ant-popover-placement-bottomLeft,&.ant-popover-placement-bottomRight{&>.ant-popover-content>.ant-popover-arrow{border-top-color:",c.colors.grayscale.dark2,"cc;border-left-color:",c.colors.grayscale.dark2,"cc;}}&.ant-popover-placement-top,&.ant-popover-placement-topLeft,&.ant-popover-placement-topRight{&>.ant-popover-content>.ant-popover-arrow{border-bottom-color:",c.colors.grayscale.dark2,"cc;border-right-color:",c.colors.grayscale.dark2,"cc;}}&.ant-popover-placement-left,&.ant-popover-placement-leftTop,&.ant-popover-placement-leftBottom{&>.ant-popover-content>.ant-popover-arrow{border-top-color:",c.colors.grayscale.dark2,"cc;border-right-color:",c.colors.grayscale.dark2,"cc;}}&.ant-popover-placement-right,&.ant-popover-placement-rightTop,&.ant-popover-placement-rightBottom{&>.ant-popover-content>.ant-popover-arrow{border-bottom-color:",c.colors.grayscale.dark2,"cc;border-left-color:",c.colors.grayscale.dark2,"cc;}}&.ant-popover{color:",c.colors.grayscale.light4,";z-index:99;}}","")}),Object(L.jsx)(pl,null,Object(L.jsx)(Po.a,{ghost:!0,light:!0,activeKey:h,onChange:function(e){p("string"==typeof e?[e]:e)}},e.length?Object(L.jsx)(Po.a.Panel,{key:"appliedCrossFilters",header:Object(L.jsx)(dl,{bold:!0,color:c.colors.primary.light1},Object(L.jsx)(zn.a.CursorTarget,{css:Object(L.css)({fill:c.colors.primary.light1},"",""),iconSize:"xl"}),Object(_.e)("Applied Cross Filters (%d)",e.length))},Object(L.jsx)(fl,{css:Object(L.css)({paddingBottom:3*c.gridUnit},"","")},Tt()(e).call(e,e=>Object(L.jsx)(Sl,{key:f(e),indicator:e,onClick:a})))):null,t.length?Object(L.jsx)(Po.a.Panel,{key:"applied",header:Object(L.jsx)(dl,{bold:!0,color:c.colors.success.base},Object(L.jsx)(tl,null)," ",Object(_.e)("Applied Filters (%d)",t.length))},Object(L.jsx)(fl,{css:Object(L.css)({paddingBottom:3*c.gridUnit},"","")},Tt()(t).call(t,e=>Object(L.jsx)(Sl,{key:f(e),indicator:e,onClick:a})))):null,n.length?Object(L.jsx)(Po.a.Panel,{key:"incompatible",header:Object(L.jsx)(dl,{bold:!0,color:c.colors.alert.base},Object(L.jsx)(il,null)," ",Object(_.e)("Incompatible Filters (%d)",n.length))},Object(L.jsx)(fl,{css:Object(L.css)({paddingBottom:3*c.gridUnit},"","")},Tt()(n).call(n,e=>Object(L.jsx)(Sl,{key:f(e),indicator:e,onClick:a})))):null,r.length?Object(L.jsx)(Po.a.Panel,{key:"unset",header:Object(L.jsx)(dl,{bold:!0,color:c.colors.grayscale.light1},Object(L.jsx)(sl,null)," ",Object(_.e)("Unset Filters (%d)",r.length)),disabled:!r.length},Object(L.jsx)(fl,{css:Object(L.css)({paddingBottom:3*c.gridUnit},"","")},Tt()(r).call(r,e=>Object(L.jsx)(Sl,{key:f(e),indicator:e,onClick:a})))):null)));return Object(L.jsx)(ll.a,{overlayClassName:"filterStatusPopover",content:b,visible:s,onVisibleChange:function(e){l(e),e&&p(u())},placement:"bottom",trigger:"click"},o)},Tl=n(34);!function(e){e.NativeFilters="nativeFilters",e.CrossFilters="crossFilters"}(wl||(wl={})),function(e){e.Unset="UNSET",e.Applied="APPLIED",e.Incompatible="INCOMPATIBLE",e.CrossFilterApplied="CROSS_FILTER_APPLIED"}(Rl||(Rl={}));const _l=new h.a(m()(Tl.q)),Fl=e=>null!=e&&e.label?e.label:null!=e&&e.value?Object(Ka.a)(null==e?void 0:e.value).join(", "):null,El=(e,t,n)=>{const r=t.columns[e],i=fa()(r)?r:[r];if(null==r||t.isDateFilter&&r===Tl.k||0===i.length)return[];if(t.isDateFilter&&_l.has(e)){var a;const t=P()(a=(e===Tl.q.time_grain_sqla?n.time_grain_sqla:n.granularity)||[]).call(a,(e,[t,n])=>({...e,[t]:n}),{});return Tt()(i).call(i,e=>t[e]||e)}return i},Ml=e=>{var t,n,r;return new h.a(Tt()(t=(null==e?void 0:null==(n=e.queriesResponse)?void 0:null==(r=n[0])?void 0:r.applied_filters)||[]).call(t,e=>e.column))},Dl=e=>{var t,n,r;return new h.a(Tt()(t=(null==e?void 0:null==(n=e.queriesResponse)?void 0:null==(r=n[0])?void 0:r.rejected_filters)||[]).call(t,e=>e.column))},Pl=(e,t,n,r)=>{var i,a;const o=Ml(r),s=Dl(r),c=P()(i=O()(a=m()(t)).call(a,t=>t.chartId!==e)).call(i,(t,r)=>d()(t).call(t,((e,t,n,r,i)=>{var a,o;const s=(e,t)=>r.has(e)&&t.columns[e]?Rl.Applied:i.has(e)?Rl.Incompatible:Rl.Unset;return Tt()(a=O()(o=f()(t.columns)).call(o,n=>{var r;return l()(r=Object($r.d)({filterScope:t.scopes[n]})).call(r,e)})).call(a,e=>({column:e,name:t.labels[e]||e,value:El(e,t,n),status:s(e,t),path:t.directPathToFilter}))})(e,r,n[r.datasourceId]||{},o,s)),[]);return Ft()(c).call(c,(e,t)=>e.name.localeCompare(t.name)),c},Il=({chartId:e})=>{var t;const n=Object(i.c)(),r=Object(i.d)(e=>e.datasources),a=Object(i.d)(e=>e.dashboardFilters),o=Object(i.d)(e=>{var t;return null==(t=e.nativeFilters)?void 0:t.filters}),s=Object(i.d)(e=>e.dashboardInfo),c=Object(i.d)(e=>e.charts),u=Object(i.d)(e=>e.dashboardLayout.present),h=Object(i.d)(e=>e.dataMask),[p,b]=Object(w.useState)([]),[g,v]=Object(w.useState)([]),j=Object(w.useCallback)(e=>{n(Object(gr.H)(e))},[n]),x=c[e],C=Object(Uo.a)(null==x?void 0:x.chartStatus),S=Object(w.useCallback)(()=>{var e;return(null==x?void 0:x.chartStatus)&&l()(e=["rendered","success"]).call(e,x.chartStatus)},[x.chartStatus]);Object(w.useEffect)(()=>{S||v([]),"success"!==C&&v(Pl(e,a,r,x))},[x,e,a,r,C,S]),Object(w.useEffect)(()=>{var t;(S||b([]),"success"!==C)&&b(((e,t,n,r,i,a={})=>{const o=Ml(r),s=Dl(r),l=({label:e,column:t,type:n=wl.NativeFilters})=>{const r=null!==e;return n===wl.CrossFilters&&r?Rl.CrossFilterApplied:!t&&r?Rl.Applied:t&&s.has(t)?Rl.Incompatible:t&&o.has(t)&&r?Rl.Applied:Rl.Unset};let c=[];var u,h;Object(F.b)(F.a.DASHBOARD_NATIVE_FILTERS)&&(c=e&&Tt()(u=O()(h=m()(e)).call(h,e=>{var t;return wr()(t=Pa(e.scope,i)).call(t,e=>{var t,r;return(null==(t=i[e])?void 0:null==(r=t.meta)?void 0:r.chartId)===n})})).call(u,e=>{var n,r,i;const a=null==(n=e.targets[0])?void 0:null==(r=n.column)?void 0:r.name,o=null==(i=t[e.id])?void 0:i.filterState,s=Fl(o);return{column:a,name:e.name,path:[e.id],status:l({label:s,column:a}),value:s}}));let p=[];var b,g,v;Object(F.b)(F.a.DASHBOARD_CROSS_FILTERS)&&(p=O()(b=Tt()(g=O()(v=m()(a)).call(v,e=>{var t,r;return wr()(t=Pa(null==e?void 0:null==(r=e.crossFilters)?void 0:r.scope,i)).call(t,e=>{var t,r;return(null==(t=i[e])?void 0:null==(r=t.meta)?void 0:r.chartId)===n})})).call(g,e=>{var n,r,a,o;const s=null==(n=t[e.id])?void 0:n.filterState,c=Fl(s),d=null==s?void 0:s.filters,u=d&&f()(d)[0],h=z()(r=m()(i)).call(r,t=>{var n;return(null==t?void 0:null==(n=t.meta)?void 0:n.chartId)===e.id});return{column:u,name:null==h?void 0:null==(a=h.meta)?void 0:a.sliceName,path:[...null!=(o=null==h?void 0:h.parents)?o:[],null==h?void 0:h.id],status:l({label:c,type:wl.CrossFilters}),value:c}})).call(b,e=>e.status===Rl.CrossFilterApplied));return d()(p).call(p,c)})(o,h,e,x,u,null==(t=s.metadata)?void 0:t.chart_configuration))},[x,e,null==(t=s.metadata)?void 0:t.chart_configuration,h,o,u,C,S]);const k=Object(w.useMemo)(()=>Js()((e=>{const t=[Rl.Applied,Rl.Unset,Rl.Incompatible];return Ft()(e).call(e,(e,n)=>y()(t).call(t,e.status)-y()(t).call(t,n.status))})([...g,...p]),(e,t)=>e.column===t.column&&e.name===t.name&&(e.status!==Rl.Applied||t.status!==Rl.Applied)),[g,p]),T=O()(k).call(k,e=>e.status===Rl.CrossFilterApplied),_=O()(k).call(k,e=>e.status===Rl.Applied),E=O()(k).call(k,e=>e.status===Rl.Unset),M=O()(k).call(k,e=>e.status===Rl.Incompatible);if(!(T.length||_.length||M.length||E.length))return null;const D=!T.length&&!_.length&&!M.length;return Object(L.jsx)(kl,{appliedCrossFilterIndicators:T,appliedIndicators:_,unsetIndicators:E,incompatibleIndicators:M,onHighlightFilterSource:j},Object(L.jsx)(cl,{className:U()("filter-counts",!!M.length&&"has-incompatible-filters",!!T.length&&"has-cross-filters",D&&"filters-inactive")},Object(L.jsx)(zn.a.Filter,{iconSize:"m"}),!D&&Object(L.jsx)("span",null,_.length+T.length),M.length?Object(L.jsx)(R.a.Fragment,null," ",Object(L.jsx)(zn.a.AlertSolid,null),Object(L.jsx)("span",null,M.length)):null))};var Nl=R.a.memo(Il);const ql=Object(_.e)("Annotation layers are still loading."),zl=Object(_.e)("One ore more annotation layers failed loading."),Al=Object($.g)(zn.a.CursorTarget)`
  cursor: pointer;
  color: ${({theme:e})=>e.colors.primary.base};
  height: 22px;
  width: 22px;
`;var Ul=({innerRef:e=null,forceRefresh:t=(()=>({})),updateSliceName:n=(()=>({})),toggleExpandSlice:r=(()=>({})),logExploreChart:a=(()=>({})),exploreUrl:o="#",exportCSV:s=(()=>({})),editMode:l=!1,annotationQuery:c={},annotationError:d={},cachedDttm:u=null,updatedDttm:h=null,isCached:p=[],isExpanded:f=!1,sliceName:b="",supersetCanExplore:g=!1,supersetCanShare:v=!1,supersetCanCSV:j=!1,sliceCanEdit:y=!1,exportFullCSV:x,slice:O,componentId:C,dashboardId:S,addSuccessToast:w,addDangerToast:k,handleToggleFullSize:T,isFullSize:F,chartStatus:E,formData:M})=>{const D=Object(i.c)(),P=Object(i.d)(e=>{var t,n;return null==(t=e.dataMask[null==O?void 0:O.slice_id])?void 0:null==(n=t.filterState)?void 0:n.value});return Object(L.jsx)("div",{className:"chart-header",ref:e},Object(L.jsx)("div",{className:"header-title"},Object(L.jsx)(Un.a,{title:b||(l?"---":""),canEdit:l,emptyText:"",onSaveTitle:n,showTooltip:!1}),!!m()(c).length&&Object(L.jsx)(Ii.a,{id:"annotations-loading-tooltip",placement:"top",title:ql},Object(L.jsx)("i",{role:"img","aria-label":ql,className:"fa fa-refresh warning"})),!!m()(d).length&&Object(L.jsx)(Ii.a,{id:"annoation-errors-tooltip",placement:"top",title:zl},Object(L.jsx)("i",{role:"img","aria-label":zl,className:"fa fa-exclamation-circle danger"}))),Object(L.jsx)("div",{className:"header-controls"},!l&&Object(L.jsx)(R.a.Fragment,null,P&&Object(L.jsx)(Ii.a,{placement:"top",title:Object(L.jsx)(Sl,{indicator:{value:P,name:Object(_.e)("Emitted values")},text:Object(_.e)("Click to clear emitted filters")})},Object(L.jsx)(Al,{onClick:()=>D(Object(kn.e)(null==O?void 0:O.slice_id))})),Object(L.jsx)(Nl,{chartId:O.slice_id}),Object(L.jsx)(Ys,{slice:O,isCached:p,isExpanded:f,cachedDttm:u,updatedDttm:h,toggleExpandSlice:r,forceRefresh:t,logExploreChart:a,exploreUrl:o,exportCSV:s,exportFullCSV:x,supersetCanExplore:g,supersetCanShare:v,supersetCanCSV:j,sliceCanEdit:y,componentId:C,dashboardId:S,addSuccessToast:w,addDangerToast:k,handleToggleFullSize:T,isFullSize:F,chartStatus:E,formData:M}))))};const $l={height:T.a.number.isRequired};function Ll({height:e}){return Object(L.jsx)("div",{className:"missing-chart-container",style:{height:e+20}},Object(L.jsx)("div",{className:"missing-chart-body"},Object(_.e)("There is no chart definition associated with this component, could it have been deleted?"),Object(L.jsx)("br",null),Object(L.jsx)("br",null),Object(_.e)("Delete this container and save to remove this message.")))}var Vl;Ll.propTypes=$l;const Hl={id:T.a.number.isRequired,componentId:T.a.string.isRequired,dashboardId:T.a.number.isRequired,width:T.a.number.isRequired,height:T.a.number.isRequired,updateSliceName:T.a.func.isRequired,isComponentVisible:T.a.bool,handleToggleFullSize:T.a.func.isRequired,chart:He.a.isRequired,formData:T.a.object.isRequired,datasource:T.a.object,slice:He.g.isRequired,sliceName:T.a.string.isRequired,timeout:T.a.number.isRequired,maxRows:T.a.number.isRequired,filters:T.a.object.isRequired,refreshChart:T.a.func.isRequired,logEvent:T.a.func.isRequired,toggleExpandSlice:T.a.func.isRequired,changeFilter:T.a.func.isRequired,setFocusedFilterField:T.a.func.isRequired,unsetFocusedFilterField:T.a.func.isRequired,editMode:T.a.bool.isRequired,isExpanded:T.a.bool.isRequired,isCached:T.a.bool,supersetCanExplore:T.a.bool.isRequired,supersetCanShare:T.a.bool.isRequired,supersetCanCSV:T.a.bool.isRequired,sliceCanEdit:T.a.bool.isRequired,addSuccessToast:T.a.func.isRequired,addDangerToast:T.a.func.isRequired,ownState:T.a.object,filterState:T.a.object},Bl=O()(Vl=f()(Hl)).call(Vl,e=>"width"!==e&&"height"!==e),Wl=new h.a(["filter_box"]),Gl=$.g.div`
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
`;class Kl extends R.a.Component{constructor(e){var t,n,r,i,a,o,s,l,c;super(e),this.logExploreChart=()=>{this.props.logEvent(Nn.c,{slice_id:Ca()(this.props).slice_id,is_cached:this.props.isCached})},this.getChartUrl=()=>Object(Sa.g)(this.props.formData),this.state={width:e.width,height:e.height,descriptionHeight:0},this.changeFilter=S()(t=this.changeFilter).call(t,this),this.handleFilterMenuOpen=S()(n=this.handleFilterMenuOpen).call(n,this),this.handleFilterMenuClose=S()(r=this.handleFilterMenuClose).call(r,this),this.exportCSV=S()(i=this.exportCSV).call(i,this),this.exportFullCSV=S()(a=this.exportFullCSV).call(a,this),this.forceRefresh=S()(o=this.forceRefresh).call(o,this),this.resize=S()(s=this.resize).call(s,this),this.setDescriptionRef=S()(l=this.setDescriptionRef).call(l,this),this.setHeaderRef=S()(c=this.setHeaderRef).call(c,this)}shouldComponentUpdate(e,t){if(t.width!==this.state.width||t.height!==this.state.height||t.descriptionHeight!==this.state.descriptionHeight||!ua()(e.datasource,this.props.datasource))return!0;if(e.isComponentVisible){if(e.chart.triggerQuery)return!0;if(e.isFullSize!==this.props.isFullSize)return clearTimeout(this.resizeTimeout),this.resizeTimeout=_n()(this.resize,350),!1;e.width===this.props.width&&e.height===this.props.height||(clearTimeout(this.resizeTimeout),this.resizeTimeout=_n()(this.resize,350));for(let t=0;t<Bl.length;t+=1){const n=Bl[t];if(!Object(Ra.f)(e[n],this.props[n]))return!0}}return this.props.cacheBusterProp!==e.cacheBusterProp}componentWillUnmount(){clearTimeout(this.resizeTimeout)}componentDidUpdate(e){if(this.props.isExpanded!==e.isExpanded){const e=this.props.isExpanded&&this.descriptionRef?this.descriptionRef.offsetHeight:0;this.setState({descriptionHeight:e})}}getChartHeight(){const e=this.getHeaderHeight();return this.state.height-e-this.state.descriptionHeight}getHeaderHeight(){return this.headerRef&&this.headerRef.offsetHeight||22}setDescriptionRef(e){this.descriptionRef=e}setHeaderRef(e){this.headerRef=e}resize(){const{width:e,height:t}=this.props;this.setState(()=>({width:e,height:t}))}changeFilter(e={}){this.props.logEvent(Nn.a,{id:this.props.chart.id,columns:f()(e)}),this.props.changeFilter(this.props.chart.id,e)}handleFilterMenuOpen(e,t){this.props.setFocusedFilterField(e,t)}handleFilterMenuClose(e,t){this.props.unsetFocusedFilterField(e,t)}exportCSV(e=!1){this.props.logEvent(Nn.d,{slice_id:Ca()(this.props).slice_id,is_cached:this.props.isCached}),Object(Sa.c)({formData:e?{...this.props.formData,row_limit:this.props.maxRows}:this.props.formData,resultType:"results",resultFormat:"csv"})}exportFullCSV(){this.exportCSV(!0)}forceRefresh(){return this.props.logEvent(Nn.e,{slice_id:Ca()(this.props).slice_id,is_cached:this.props.isCached}),this.props.refreshChart(this.props.chart.id,!0,this.props.dashboardId)}render(){const{id:e,componentId:t,dashboardId:n,chart:r,slice:i,datasource:a,isExpanded:o,editMode:s,filters:l,formData:c,updateSliceName:d,sliceName:u,toggleExpandSlice:h,timeout:p,supersetCanExplore:f,supersetCanShare:b,supersetCanCSV:m,sliceCanEdit:g,addSuccessToast:v,addDangerToast:j,ownState:y,filterState:x,handleToggleFullSize:O,isFullSize:C}=this.props,{width:S}=this.state;if(!r||!i)return Object(L.jsx)(Ll,{height:this.getChartHeight()});const{queriesResponse:w,chartUpdateEndTime:R,chartStatus:k}=r,T="loading"===k,_=(null==w?void 0:Tt()(w).call(w,({is_cached:e})=>e))||[],F=(null==w?void 0:Tt()(w).call(w,({cached_dttm:e})=>e))||[],E=Wl.has(i.viz_type),M=Object($r.e)(e)?function({activeFilters:e={},filterId:t}){var n;return P()(n=Rt()(e)).call(n,(e,n)=>{const[r,{values:i}]=n,{chartId:a,column:o}=Object(Rr.a)(r);return a===t?{...e,[o]:i}:e},{})}({activeFilters:l,filterId:e}):{};return Object(L.jsx)("div",{className:"chart-slice","data-test-chart-id":e,"data-test-viz-type":i.viz_type,"data-test-chart-name":i.slice_name},Object(L.jsx)(Ul,{innerRef:this.setHeaderRef,slice:i,isExpanded:!!o,isCached:_,cachedDttm:F,updatedDttm:R,toggleExpandSlice:h,forceRefresh:this.forceRefresh,editMode:s,annotationQuery:r.annotationQuery,logExploreChart:this.logExploreChart,exploreUrl:this.getChartUrl(),exportCSV:this.exportCSV,exportFullCSV:this.exportFullCSV,updateSliceName:d,sliceName:u,supersetCanExplore:f,supersetCanShare:b,supersetCanCSV:m,sliceCanEdit:g,componentId:t,dashboardId:n,filters:l,addSuccessToast:v,addDangerToast:j,handleToggleFullSize:O,isFullSize:C,chartStatus:r.chartStatus,formData:c}),o&&i.description_markeddown&&Object(L.jsx)("div",{className:"slice_description bs-callout bs-callout-default",ref:this.setDescriptionRef,dangerouslySetInnerHTML:{__html:i.description_markeddown}}),Object(L.jsx)("div",{className:U()("dashboard-chart",E&&"dashboard-chart--overflowable")},T&&Object(L.jsx)(Gl,{style:{width:S,height:this.getChartHeight()}}),Object(L.jsx)(wa.a,{width:S,height:this.getChartHeight(),addFilter:this.changeFilter,onFilterMenuOpen:this.handleFilterMenuOpen,onFilterMenuClose:this.handleFilterMenuClose,annotationData:r.annotationData,chartAlert:r.chartAlert,chartId:e,chartStatus:k,datasource:a,dashboardId:n,initialValues:M,formData:c,ownState:y,filterState:x,queriesResponse:r.queriesResponse,timeout:p,triggerQuery:r.triggerQuery,vizType:i.viz_type})))}}Kl.propTypes=Hl,Kl.defaultProps={isCached:!1,isComponentVisible:!0};var Ql=n(1942);const Yl={};var Xl=Object(i.b)((function({charts:e,dashboardInfo:t,dashboardState:n,dashboardLayout:r,dataMask:i,datasources:a,sliceEntities:o,nativeFilters:s,common:c},d){var u,h,p;const{id:f}=d,b=e[f]||{},m=b&&b.form_data&&a[b.form_data.datasource]||Ql.a,{colorScheme:g,colorNamespace:v}=n,j=function({chart:e,charts:t,filters:n,nativeFilters:r,chartConfiguration:i,colorScheme:a,colorNamespace:o,sliceId:s,layout:c,dataMask:d}){var u,h;const p=Pn.b.getScale(a,o).getColorMap();if((ja[s]||{})===n&&(null==a||ya[s].color_scheme===a)&&ya[s].color_namespace===o&&ua()(ya[s].label_colors,p)&&ya[s]&&void 0===d)return ya[s];let f={};const b=va({chartConfiguration:i,dataMask:d,layout:c,nativeFilters:r.filters}),m=Tt()(u=O()(h=Rt()(b)).call(h,([,{scope:t}])=>l()(t).call(t,e.id))).call(u,([e])=>e);m.length&&(f={extra_form_data:Object(ha.b)(d,t,m)});const g={...e.formData,...a&&{color_scheme:a},label_colors:p,extra_filters:ba(n),...f};return ja[s]=n,ya[s]=g,g}({layout:r.present,chart:b,chartConfiguration:null==(u=t.metadata)?void 0:u.chart_configuration,charts:e,filters:Object($r.c)(f),colorScheme:g,colorNamespace:v,sliceId:f,nativeFilters:s,dataMask:i});return j.dashboardId=t.id,{chart:b,datasource:m,slice:o.slices[f],timeout:t.common.conf.SUPERSET_WEBSERVER_TIMEOUT,filters:Object($r.b)()||Yl,formData:j,editMode:n.editMode,isExpanded:!!n.expandedSlices[f],supersetCanExplore:!!t.superset_can_explore,supersetCanShare:!!t.superset_can_share,supersetCanCSV:!!t.superset_can_csv,sliceCanEdit:!!t.slice_can_edit,ownState:null==(h=i[f])?void 0:h.ownState,filterState:null==(p=i[f])?void 0:p.filterState,maxRows:c.conf.SQL_MAX_ROW}}),(function(e){return Object(r.b)({updateComponents:ta.s,addSuccessToast:na.e,addDangerToast:na.c,toggleExpandSlice:gr.P,changeFilter:mr.h,setFocusedFilterField:gr.J,unsetFocusedFilterField:gr.Q,refreshChart:ca.refreshChart,logEvent:ra.logEvent},e)}))(Kl),Jl=n(221);const Zl={url:T.a.string,emailSubject:T.a.string,emailContent:T.a.string,addDangerToast:T.a.func.isRequired,placement:T.a.oneOf(["right","left","top","bottom"])};class ec extends R.a.Component{constructor(e){var t,n;super(e),this.state={shortUrl:""},this.onShortUrlSuccess=S()(t=this.onShortUrlSuccess).call(t,this),this.getCopyUrl=S()(n=this.getCopyUrl).call(n,this)}onShortUrlSuccess(e){this.setState(()=>({shortUrl:e}))}getCopyUrl(e){e.stopPropagation(),Object(yi.a)(this.props.url).then(this.onShortUrlSuccess).catch(this.props.addDangerToast)}renderPopover(){const e=Object(_.e)("%s%s",this.props.emailContent,this.state.shortUrl);return Object(L.jsx)("div",{id:"shorturl-popover"},Object(L.jsx)(Jl.a,{text:this.state.shortUrl,copyNode:Object(L.jsx)("i",{className:"fa fa-clipboard",title:Object(_.e)("Copy to clipboard")})}),"",Object(L.jsx)("a",{href:`mailto:?Subject=${this.props.emailSubject}%20&Body=${e}`},Object(L.jsx)("i",{className:"fa fa-envelope"})))}render(){return Object(L.jsx)(ll.a,{trigger:"click",placement:this.props.placement,onClick:this.getCopyUrl,content:this.renderPopover()},Object(L.jsx)("span",{className:"short-link-trigger btn btn-default btn-sm",role:"button"},Object(L.jsx)("i",{className:"short-link-trigger fa fa-link"}),""))}}ec.defaultProps={url:window.location.href.substring(window.location.origin.length),placement:"left",emailSubject:"",emailContent:""},ec.propTypes=Zl;var tc=Object($o.a)(ec),nc=n(1296);const rc={anchorLinkId:T.a.string.isRequired,filters:T.a.object,showShortLinkButton:T.a.bool,inFocus:T.a.bool,placement:T.a.oneOf(["right","left","top","bottom"])};class ic extends R.a.PureComponent{componentDidMount(){const e=Object(nc.a)(),{anchorLinkId:t}=this.props;e&&t===e&&this.scrollToView()}UNSAFE_componentWillReceiveProps(e){const{inFocus:t=!1}=e;t&&this.scrollToView()}scrollToView(e=0){const{anchorLinkId:t}=this.props,n=document.getElementById(t);n&&_n()(()=>{n.scrollIntoView({block:"center",behavior:"smooth"})},e)}render(){const{anchorLinkId:e,filters:t,showShortLinkButton:n,placement:r}=this.props;return Object(L.jsx)("span",{className:"anchor-link-container",id:e},n&&Object(L.jsx)(tc,{url:ji({pathname:window.location.pathname,filters:t,hash:e}),emailSubject:Object(_.e)("Superset chart"),emailContent:Object(_.e)("Check out this chart in dashboard:"),placement:r}))}}ic.propTypes=rc,ic.defaultProps={inFocus:!1,showShortLinkButton:!1,placement:"right",filters:{}};var ac=ic;const oc={onDelete:T.a.func.isRequired};class sc extends R.a.PureComponent{render(){const{onDelete:e}=this.props;return Object(L.jsx)(la,{onClick:e,icon:Object(L.jsx)(zn.a.Trash,{iconSize:"xl"})})}}sc.propTypes=oc,sc.defaultProps={};class lc extends R.a.PureComponent{render(){const{innerRef:e,position:t,children:n}=this.props;return Object(L.jsx)("div",{ref:e,className:U()("hover-menu","left"===t&&"hover-menu--left","top"===t&&"hover-menu--top")},n)}}lc.defaultProps={position:"left",innerRef:null,children:null};var cc=n(1910);var dc={right:function(){return Object(L.jsx)("div",{className:"resize-handle resize-handle--right"})},bottom:function(){return Object(L.jsx)("div",{className:"resize-handle resize-handle--bottom"})},bottomRight:function(){return Object(L.jsx)("div",{className:"resize-handle resize-handle--bottom-right"})}};const uc={top:!1,right:!0,bottom:!0,left:!1,topRight:!1,bottomRight:!0,bottomLeft:!1,topLeft:!1};var hc={widthAndHeight:uc,widthOnly:{...uc,bottomRight:!1,bottom:!1},heightOnly:{...uc,bottomRight:!1,right:!1},notAdjustable:{...uc,bottomRight:!1,bottom:!1,right:!1}};const pc=Number.MAX_VALUE,fc={id:T.a.string.isRequired,children:T.a.node,adjustableWidth:T.a.bool,adjustableHeight:T.a.bool,gutterWidth:T.a.number,widthStep:T.a.number,heightStep:T.a.number,widthMultiple:T.a.number,heightMultiple:T.a.number,minWidthMultiple:T.a.number,maxWidthMultiple:T.a.number,minHeightMultiple:T.a.number,maxHeightMultiple:T.a.number,staticHeight:T.a.number,staticHeightMultiple:T.a.number,staticWidth:T.a.number,staticWidthMultiple:T.a.number,onResizeStop:T.a.func,onResize:T.a.func,onResizeStart:T.a.func,editMode:T.a.bool.isRequired},bc={children:null,adjustableWidth:!0,adjustableHeight:!0,gutterWidth:Z.n,widthStep:Z.k,heightStep:Z.k,widthMultiple:null,heightMultiple:null,minWidthMultiple:1,maxWidthMultiple:pc,minHeightMultiple:1,maxHeightMultiple:pc,staticHeight:null,staticHeightMultiple:null,staticWidth:null,staticWidthMultiple:null,onResizeStop:null,onResize:null,onResizeStart:null},mc=[Z.k,Z.k],gc={right:"resizable-container-handle--right",bottom:"resizable-container-handle--bottom"};class vc extends R.a.PureComponent{constructor(e){var t,n,r;super(e),this.state={isResizing:!1},this.handleResizeStart=S()(t=this.handleResizeStart).call(t,this),this.handleResize=S()(n=this.handleResize).call(n,this),this.handleResizeStop=S()(r=this.handleResizeStop).call(r,this)}handleResizeStart(e,t,n){const{id:r,onResizeStart:i}=this.props;i&&i({id:r,direction:t,ref:n}),this.setState(()=>({isResizing:!0}))}handleResize(e,t,n){const{onResize:r,id:i}=this.props;r&&r({id:i,direction:t,ref:n})}handleResizeStop(e,t,n,r){const{id:i,onResizeStop:a,widthStep:o,heightStep:s,widthMultiple:l,heightMultiple:c,adjustableHeight:d,adjustableWidth:u,gutterWidth:h}=this.props;if(a){const e=l+Math.round(r.width/(o+h)),t=c+Math.round(r.height/s);a({id:i,widthMultiple:u?e:null,heightMultiple:d?t:null}),this.setState(()=>({isResizing:!1}))}}render(){const{children:e,adjustableWidth:t,adjustableHeight:n,widthStep:r,heightStep:i,widthMultiple:a,heightMultiple:o,staticHeight:s,staticHeightMultiple:l,staticWidth:c,staticWidthMultiple:d,minWidthMultiple:u,maxWidthMultiple:h,minHeightMultiple:p,maxHeightMultiple:f,gutterWidth:b,editMode:m}=this.props,g={width:t?(r+b)*a-b:d&&d*r||c||void 0,height:n?i*o:l&&l*i||s||void 0};let v=hc.notAdjustable;m&&t&&n?v=hc.widthAndHeight:m&&t?v=hc.widthOnly:m&&n&&(v=hc.heightOnly);const{isResizing:j}=this.state;return Object(L.jsx)(cc.a,{enable:v,grid:mc,minWidth:t?u*(r+b)-b:void 0,minHeight:n?p*i:void 0,maxWidth:t?Math.max(g.width,Math.min(pc,h*(r+b)-b)):void 0,maxHeight:n?Math.max(g.height,Math.min(pc,f*i)):void 0,size:g,onResizeStart:this.handleResizeStart,onResize:this.handleResize,onResizeStop:this.handleResizeStop,handleComponent:dc,className:U()("resizable-container",j&&"resizable-container--resizing"),handleClasses:gc},e)}}vc.propTypes=fc,vc.defaultProps=bc;var jc=vc;const yc={id:T.a.string.isRequired,parentId:T.a.string.isRequired,dashboardId:T.a.number.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,editMode:T.a.bool.isRequired,directPathToChild:T.a.arrayOf(T.a.string),directPathLastUpdated:T.a.number,focusedFilterScope:T.a.object,fullSizeChartId:T.a.oneOf([T.a.number,null]),availableColumnCount:T.a.number.isRequired,columnWidth:T.a.number.isRequired,onResizeStart:T.a.func.isRequired,onResize:T.a.func.isRequired,onResizeStop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,updateComponents:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,setFullSizeChartId:T.a.func.isRequired};const xc=R.a.forwardRef(({chartId:e,...t},n)=>{var r;const a=Object($.i)(),o=Object(i.d)(e=>e.nativeFilters),s=function(e,t){if(!e.focusedFilterField)return null;const{chartId:n,column:r}=e.focusedFilterField;return{chartId:n,scope:t[n].scopes[r]}}(Object(i.d)(e=>e.dashboardState),Object(i.d)(e=>e.dashboardFilters)),c=o.focusedFilterId;if(!s&&!c)return Object(L.jsx)("div",Wn()({ref:n},t));const d={borderColor:a.colors.primary.light2,opacity:1,boxShadow:`0px 0px ${2*a.gridUnit}px ${a.colors.primary.base}`,pointerEvents:"auto"};var u,h;if(c){if(null!=(u=o.filters[c])&&null!=(h=u.chartsInScope)&&l()(h).call(h,e))return Object(L.jsx)("div",Wn()({ref:n,style:d},t))}else if(e===s.chartId||l()(r=Object($r.d)({filterScope:s.scope})).call(r,e))return Object(L.jsx)("div",Wn()({ref:n,style:d},t));return Object(L.jsx)("div",Wn()({ref:n,style:{opacity:.3,pointerEvents:"none"}},t))});class Oc extends R.a.Component{static renderInFocusCSS(e){return Object(L.jsx)("style",null,`label[for=${e}] + .Select .Select__control {\n                    border-color: #00736a;\n                    transition: border-color 1s ease-in-out;\n           }`)}static getDerivedStateFromProps(e,t){const{component:n,directPathToChild:r,directPathLastUpdated:i}=e,{label:a,chart:o}=function(e){const t={};if(e.length>0){const n=Ca()(e).call(e);for(;n.length;){const e=n.pop(),r=e.split("-")[0];if(t[r.toLowerCase()]=e,!l()(Z.q).call(Z.q,r))break}}return t}(r);return i!==t.directPathLastUpdated&&n.id===o?{outlinedComponentId:n.id,outlinedColumnName:a,directPathLastUpdated:i}:null}constructor(e){var t,n,r,i;super(e),this.state={isFocused:!1,outlinedComponentId:null,outlinedColumnName:null,directPathLastUpdated:0},this.handleChangeFocus=S()(t=this.handleChangeFocus).call(t,this),this.handleDeleteComponent=S()(n=this.handleDeleteComponent).call(n,this),this.handleUpdateSliceName=S()(r=this.handleUpdateSliceName).call(r,this),this.handleToggleFullSize=S()(i=this.handleToggleFullSize).call(i,this)}componentDidMount(){this.hideOutline({},this.state)}componentDidUpdate(e,t){this.hideOutline(t,this.state)}hideOutline(e,t){const{outlinedComponentId:n}=t,{outlinedComponentId:r}=e;n&&!r&&_n()(()=>{this.setState(()=>({outlinedComponentId:null,outlinedColumnName:null}))},2e3)}handleChangeFocus(e){this.setState(()=>({isFocused:e}))}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}handleUpdateSliceName(e){const{component:t,updateComponents:n}=this.props;n({[t.id]:{...t,meta:{...t.meta,sliceNameOverride:e}}})}handleToggleFullSize(){const{component:e,fullSizeChartId:t,setFullSizeChartId:n}=this.props,{chartId:r}=e.meta;n(t===r?null:r)}render(){const{isFocused:e}=this.state,{component:t,parentComponent:n,index:r,depth:i,availableColumnCount:a,columnWidth:o,onResizeStart:s,onResize:l,onResizeStop:c,handleComponentDrop:d,editMode:u,isComponentVisible:h,dashboardId:p,fullSizeChartId:f}=this.props,{chartId:b}=t.meta,m=f===b,g=n.type===I.b?n.meta.width||Z.o:t.meta.width||Z.o;let v=0,j=0;return m?(v=window.innerWidth-32,j=window.innerHeight-32):(v=Math.floor(g*o+(g-1)*Z.n-32),j=Math.floor(t.meta.height*Z.k-32)),Object(L.jsx)(bt,{component:t,parentComponent:n,orientation:n.type===I.j?"column":"row",index:r,depth:i,onDrop:d,disableDragDrop:e,editMode:u},({dropIndicatorProps:e,dragSourceRef:r})=>Object(L.jsx)(jc,{id:t.id,adjustableWidth:n.type===I.j,adjustableHeight:!0,widthStep:o,widthMultiple:g,heightStep:Z.k,heightMultiple:t.meta.height,minWidthMultiple:Z.o,minHeightMultiple:Z.p,maxWidthMultiple:a+g,onResizeStart:s,onResize:l,onResizeStop:c,editMode:u},Object(L.jsx)(xc,{chartId:b,ref:r,className:U()("dashboard-component","dashboard-component-chart-holder",this.state.outlinedComponentId?"fade-in":"fade-out",m&&"full-size")},!u&&Object(L.jsx)(ac,{anchorLinkId:t.id,inFocus:!!this.state.outlinedComponentId}),!!this.state.outlinedComponentId&&Oc.renderInFocusCSS(this.state.outlinedColumnName),Object(L.jsx)(Xl,{componentId:t.id,id:t.meta.chartId,dashboardId:p,width:v,height:j,sliceName:t.meta.sliceNameOverride||t.meta.sliceName||"",updateSliceName:this.handleUpdateSliceName,isComponentVisible:h,handleToggleFullSize:this.handleToggleFullSize,isFullSize:m}),u&&Object(L.jsx)(lc,{position:"top"},Object(L.jsx)("div",null,Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent})))),e&&Object(L.jsx)("div",e)))}}Oc.propTypes=yc,Oc.defaultProps={directPathToChild:[],directPathLastUpdated:0};var Cc=Oc,Sc=n(528);const wc=Object($.g)(Yt.q.Item)`
  &.ant-menu-item {
    height: auto;
    line-height: 1.4;

    padding-top: ${({theme:e})=>e.gridUnit}px;
    padding-bottom: ${({theme:e})=>e.gridUnit}px;

    margin-top: 0;
    margin-bottom: 0;

    &:not(:last-child) {
      margin-bottom: 0;
    }

    &:hover {
      background: ${({theme:e})=>e.colors.grayscale.light3};
    }

    &.active {
      font-weight: ${({theme:e})=>e.typography.weights.bold};
      background: ${({theme:e})=>e.colors.grayscale.light2};
    }
  }

  &.ant-menu-item-selected {
    color: unset;
  }
`;var Rc={name:"s5xdrg",styles:"display:flex;align-items:center"};var kc=e=>{const{value:t,options:n,onChange:r,renderButton:i=(e=>e.label),renderOption:a=(e=>Object(L.jsx)("div",{className:e.className},e.label))}=e,o=Object($.i)(),s=z()(n).call(n,e=>e.value===t);return Object(L.jsx)(Yt.j,{trigger:["click"],overlayStyle:{zIndex:o.zIndex.max},overlay:Object(L.jsx)(Yt.q,{onClick:({key:e})=>r(e)},Tt()(n).call(n,e=>Object(L.jsx)(wc,{id:"menu-item",key:e.value,className:U()("dropdown-item",{active:e.value===t})},a(e))))},Object(L.jsx)("div",{role:"button",css:Rc},s&&i(s),Object(L.jsx)(zn.a.CaretDown,{iconColor:o.colors.grayscale.base,css:Object(L.css)({marginTop:.5*o.gridUnit},"","")})))};const Tc=[{value:"edit",label:Object(_.e)("Edit")},{value:"preview",label:Object(_.e)("Preview")}];class _c extends R.a.PureComponent{render(){const{id:e,value:t,onChange:n}=this.props;return Object(L.jsx)(kc,{id:e,options:Tc,value:t,onChange:n})}}class Fc extends R.a.PureComponent{constructor(e){var t,n;super(e),this.container=void 0,this.state={isFocused:e.isFocused},this.setRef=S()(t=this.setRef).call(t,this),this.handleClick=S()(n=this.handleClick).call(n,this)}UNSAFE_componentWillReceiveProps(e){e.editMode&&e.isFocused&&!this.state.isFocused?(document.addEventListener("click",this.handleClick),document.addEventListener("drag",this.handleClick),this.setState({isFocused:!0})):this.state.isFocused&&!e.editMode&&(document.removeEventListener("click",this.handleClick),document.removeEventListener("drag",this.handleClick),this.setState({isFocused:!1}))}componentWillUnmount(){document.removeEventListener("click",this.handleClick),document.removeEventListener("drag",this.handleClick)}setRef(e){this.container=e}handleClick(e){if(!this.props.editMode)return;const{onChangeFocus:t,shouldFocus:n,disableClick:r}=this.props,i=n(e,this.container);r||!i||this.state.isFocused?!i&&this.state.isFocused&&(document.removeEventListener("click",this.handleClick),document.removeEventListener("drag",this.handleClick),this.setState(()=>({isFocused:!1})),t&&t(!1)):(document.addEventListener("click",this.handleClick),document.addEventListener("drag",this.handleClick),this.setState(()=>({isFocused:!0})),t&&t(!0))}render(){var e;const{children:t,menuItems:n,editMode:r,style:i}=this.props,{isFocused:a}=this.state;return Object(L.jsx)("div",{ref:this.setRef,onClick:this.handleClick,role:"none",className:U()("with-popover-menu",r&&a&&"with-popover-menu--focused"),style:i},t,r&&a&&(null!=(e=null==n?void 0:n.length)?e:0)>0&&Object(L.jsx)("div",{className:"popover-menu"},Tt()(n).call(n,(e,t)=>Object(L.jsx)("div",{className:"menu-item",key:`menu-item-${t}`},e))))}}Fc.defaultProps={children:null,disableClick:!1,onChangeFocus:null,menuItems:[],isFocused:!1,shouldFocus:(e,t)=>{var n;return(null==t?void 0:t.contains(e.target))||"menu-item"===e.target.id||"menu-item"===(null==(n=e.target.parentNode)?void 0:n.id)},style:null};const Ec={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,editMode:T.a.bool.isRequired,logEvent:T.a.func.isRequired,addDangerToast:T.a.func.isRequired,undoLength:T.a.number.isRequired,redoLength:T.a.number.isRequired,availableColumnCount:T.a.number.isRequired,columnWidth:T.a.number.isRequired,onResizeStart:T.a.func.isRequired,onResize:T.a.func.isRequired,onResizeStop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,updateComponents:T.a.func.isRequired},Mc="# Markdown\n## Markdown\n### Markdown\n\n<br />\n\nClick here to edit [markdown](https://bit.ly/1dQOfRK)",Dc=Object(_.e)("This markdown component has an error.");class Pc extends R.a.PureComponent{constructor(e){var t,n,r,i,a,o;super(e),this.state={isFocused:!1,markdownSource:e.component.meta.code,editor:null,editorMode:"preview",undoLength:e.undoLength,redoLength:e.redoLength},this.renderStartTime=Nn.q.getTimestamp(),this.handleChangeFocus=S()(t=this.handleChangeFocus).call(t,this),this.handleChangeEditorMode=S()(n=this.handleChangeEditorMode).call(n,this),this.handleMarkdownChange=S()(r=this.handleMarkdownChange).call(r,this),this.handleDeleteComponent=S()(i=this.handleDeleteComponent).call(i,this),this.handleResizeStart=S()(a=this.handleResizeStart).call(a,this),this.setEditor=S()(o=this.setEditor).call(o,this)}componentDidMount(){this.props.logEvent(Nn.m,{viz_type:"markdown",start_offset:this.renderStartTime,ts:(new Date).getTime(),duration:Nn.q.getTimestamp()-this.renderStartTime})}static getDerivedStateFromProps(e,t){const{hasError:n,editorMode:r,markdownSource:i,undoLength:a,redoLength:o}=t,{component:s,undoLength:l,redoLength:c}=e;return l!==a||c!==o?{...t,undoLength:l,redoLength:c,markdownSource:s.meta.code,hasError:!1}:n||"preview"!==r||s.meta.code===i?t:{...t,markdownSource:s.meta.code}}static getDerivedStateFromError(){return{hasError:!0}}componentDidUpdate(e){!this.state.editor||e.component.meta.width===this.props.component.meta.width&&e.columnWidth===this.props.columnWidth||this.state.editor.resize(!0),this.props.editMode&&Jn.e.preload()}componentDidCatch(){this.state.editor&&"preview"===this.state.editorMode&&this.props.addDangerToast(Object(_.e)("This markdown component has an error. Please revert your recent changes."))}setEditor(e){e.getSession().setUseWrapMode(!0),this.setState({editor:e})}handleChangeFocus(e){const t=!!e,n=t?"edit":"preview";this.setState(()=>({isFocused:t})),this.handleChangeEditorMode(n)}handleChangeEditorMode(e){const t={...this.state,editorMode:e};"preview"===e&&(this.updateMarkdownContent(),t.hasError=!1),this.setState(t)}updateMarkdownContent(){const{updateComponents:e,component:t}=this.props;t.meta.code!==this.state.markdownSource&&e({[t.id]:{...t,meta:{...t.meta,code:this.state.markdownSource}}})}handleMarkdownChange(e){this.setState({markdownSource:e})}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}handleResizeStart(e){const{editorMode:t}=this.state,{editMode:n,onResizeStart:r}=this.props,i="edit"===t;r(e),n&&i&&this.updateMarkdownContent()}renderEditMode(){return Object(L.jsx)(Jn.e,{onChange:this.handleMarkdownChange,width:"100%",height:"100%",showGutter:!1,editorProps:{$blockScrolling:!0},value:"string"==typeof this.state.markdownSource?this.state.markdownSource:Mc,readOnly:!1,onLoad:this.setEditor})}renderPreviewMode(){const{hasError:e}=this.state;return Object(L.jsx)(Sc.a,{source:e?Dc:this.state.markdownSource||Mc})}render(){const{isFocused:e,editorMode:t}=this.state,{component:n,parentComponent:r,index:i,depth:a,availableColumnCount:o,columnWidth:s,onResize:l,onResizeStop:c,handleComponentDrop:d,editMode:u}=this.props,h=r.type===I.b?r.meta.width||Z.o:n.meta.width||Z.o,p="edit"===t;return Object(L.jsx)(bt,{component:n,parentComponent:r,orientation:r.type===I.j?"column":"row",index:i,depth:a,onDrop:d,disableDragDrop:e,editMode:u},({dropIndicatorProps:t,dragSourceRef:i})=>Object(L.jsx)(Fc,{onChangeFocus:this.handleChangeFocus,menuItems:[Object(L.jsx)(_c,{id:`${n.id}-mode`,value:this.state.editorMode,onChange:this.handleChangeEditorMode}),Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent})],editMode:u},Object(L.jsx)("div",{className:U()("dashboard-markdown",p&&"dashboard-markdown--editing"),id:n.id},Object(L.jsx)(jc,{id:n.id,adjustableWidth:r.type===I.j,adjustableHeight:!0,widthStep:s,widthMultiple:h,heightStep:Z.k,heightMultiple:n.meta.height,minWidthMultiple:Z.o,minHeightMultiple:Z.p,maxWidthMultiple:o+h,onResizeStart:this.handleResizeStart,onResize:l,onResizeStop:c,editMode:!e&&u},Object(L.jsx)("div",{ref:i,className:"dashboard-component dashboard-component-chart-holder"},u&&p?this.renderEditMode():this.renderPreviewMode()))),t&&Object(L.jsx)("div",t)))}}Pc.propTypes=Ec,Pc.defaultProps={};var Ic=Pc,Nc=n(1186),qc=n.n(Nc);const zc={position:T.a.oneOf(["left","top"]),innerRef:T.a.func,dotCount:T.a.number};class Ac extends R.a.PureComponent{render(){var e,t;const{innerRef:n,position:r,dotCount:i}=this.props;return Object(L.jsx)("div",{ref:n,className:U()("drag-handle","left"===r&&"drag-handle--left","top"===r&&"drag-handle--top")},Tt()(e=qc()(t=Array(i)).call(t,null)).call(e,(e,t)=>Object(L.jsx)("div",{key:`handle-dot-${t}`,className:"drag-handle-dot"})))}}Ac.propTypes=zc,Ac.defaultProps={position:"left",innerRef:null,dotCount:8};var Uc=n(1686);function $c(e){return Object(L.jsx)("div",{className:U()("background-style-option",e.className)},`${e.label} background`)}function Lc(e){return Object(L.jsx)("div",{className:U()("background-style-option",e.className)},e.label)}class Vc extends R.a.PureComponent{render(){const{id:e,value:t,onChange:n}=this.props;return Object(L.jsx)(kc,{id:e,options:Uc.a,value:t,onChange:n,renderButton:$c,renderOption:Lc})}}const Hc={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,editMode:T.a.bool.isRequired,availableColumnCount:T.a.number.isRequired,columnWidth:T.a.number.isRequired,minColumnWidth:T.a.number.isRequired,onResizeStart:T.a.func.isRequired,onResize:T.a.func.isRequired,onResizeStop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,updateComponents:T.a.func.isRequired};class Bc extends R.a.PureComponent{constructor(e){var t,n,r;super(e),this.state={isFocused:!1},this.handleChangeBackground=S()(t=this.handleUpdateMeta).call(t,this,"background"),this.handleChangeFocus=S()(n=this.handleChangeFocus).call(n,this),this.handleDeleteComponent=S()(r=this.handleDeleteComponent).call(r,this)}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}handleChangeFocus(e){this.setState(()=>({isFocused:Boolean(e)}))}handleUpdateMeta(e,t){const{updateComponents:n,component:r}=this.props;t&&r.meta[e]!==t&&n({[r.id]:{...r,meta:{...r.meta,[e]:t}}})}render(){const{component:e,parentComponent:t,index:n,availableColumnCount:r,columnWidth:i,minColumnWidth:a,depth:o,onResizeStart:s,onResize:l,onResizeStop:c,handleComponentDrop:d,editMode:u,isComponentVisible:h}=this.props,p=e.children||[],f=z()(Uc.a).call(Uc.a,t=>t.value===(e.meta.background||Z.b));return Object(L.jsx)(bt,{component:e,parentComponent:t,orientation:"column",index:n,depth:o,onDrop:d,editMode:u},({dropIndicatorProps:t,dragSourceRef:n})=>Object(L.jsx)(jc,{id:e.id,adjustableWidth:!0,adjustableHeight:!1,widthStep:i,widthMultiple:e.meta.width,minWidthMultiple:a,maxWidthMultiple:r+(e.meta.width||0),onResizeStart:s,onResize:l,onResizeStop:c,editMode:u},Object(L.jsx)(Fc,{isFocused:this.state.isFocused,onChangeFocus:this.handleChangeFocus,disableClick:!0,menuItems:[Object(L.jsx)(Vc,{id:`${e.id}-background`,value:e.meta.background,onChange:this.handleChangeBackground})],editMode:u},u&&Object(L.jsx)(lc,{innerRef:n,position:"top"},Object(L.jsx)(Ac,{position:"top"}),Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent}),Object(L.jsx)(la,{onClick:this.handleChangeFocus,icon:Object(L.jsx)(zn.a.Cog,{iconSize:"xl"})})),Object(L.jsx)("div",{className:U()("grid-column",0===p.length&&"grid-column--empty",f.className)},Tt()(p).call(p,(t,n)=>Object(L.jsx)(xd,{key:t,id:t,parentId:e.id,depth:o+1,index:n,availableColumnCount:e.meta.width,columnWidth:i,onResizeStart:s,onResize:l,onResizeStop:c,isComponentVisible:h})),t&&Object(L.jsx)("div",t)))))}}Bc.propTypes=Hc,Bc.defaultProps={};var Wc=Bc;const Gc={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,depth:T.a.number.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,editMode:T.a.bool.isRequired,handleComponentDrop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired};class Kc extends R.a.PureComponent{constructor(e){var t;super(e),this.handleDeleteComponent=S()(t=this.handleDeleteComponent).call(t,this)}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}render(){const{component:e,depth:t,parentComponent:n,index:r,handleComponentDrop:i,editMode:a}=this.props;return Object(L.jsx)(bt,{component:e,parentComponent:n,orientation:"row",index:r,depth:t,onDrop:i,editMode:a},({dropIndicatorProps:e,dragSourceRef:t})=>Object(L.jsx)("div",{ref:t},a&&Object(L.jsx)(lc,{position:"left"},Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent})),Object(L.jsx)("div",{className:"dashboard-component dashboard-component-divider"}),e&&Object(L.jsx)("div",e)))}}Kc.propTypes=Gc;var Qc=Kc,Yc=n(1742);const Xc={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,depth:T.a.number.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,editMode:T.a.bool.isRequired,filters:T.a.object.isRequired,handleComponentDrop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,updateComponents:T.a.func.isRequired};class Jc extends R.a.PureComponent{constructor(e){var t,n,r,i,a,o;super(e),this.state={isFocused:!1},this.handleDeleteComponent=S()(t=this.handleDeleteComponent).call(t,this),this.handleChangeFocus=S()(n=this.handleChangeFocus).call(n,this),this.handleUpdateMeta=S()(r=this.handleUpdateMeta).call(r,this),this.handleChangeSize=S()(i=this.handleUpdateMeta).call(i,this,"headerSize"),this.handleChangeBackground=S()(a=this.handleUpdateMeta).call(a,this,"background"),this.handleChangeText=S()(o=this.handleUpdateMeta).call(o,this,"text")}handleChangeFocus(e){this.setState(()=>({isFocused:e}))}handleUpdateMeta(e,t){const{updateComponents:n,component:r}=this.props;t&&r.meta[e]!==t&&n({[r.id]:{...r,meta:{...r.meta,[e]:t}}})}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}render(){const{isFocused:e}=this.state,{component:t,depth:n,parentComponent:r,index:i,handleComponentDrop:a,editMode:o,filters:s}=this.props,l=z()(Yc.a).call(Yc.a,e=>e.value===(t.meta.headerSize||Z.E)),c=z()(Uc.a).call(Uc.a,e=>e.value===(t.meta.background||Z.b));return Object(L.jsx)(bt,{component:t,parentComponent:r,orientation:"row",index:i,depth:n,onDrop:a,disableDragDrop:e,editMode:o},({dropIndicatorProps:e,dragSourceRef:r})=>Object(L.jsx)("div",{ref:r},o&&n<=2&&Object(L.jsx)(lc,{position:"left"},Object(L.jsx)(Ac,{position:"left"})),Object(L.jsx)(Fc,{onChangeFocus:this.handleChangeFocus,menuItems:[Object(L.jsx)(kc,{id:`${t.id}-header-style`,options:Yc.a,value:t.meta.headerSize,onChange:this.handleChangeSize}),Object(L.jsx)(Vc,{id:`${t.id}-background`,value:t.meta.background,onChange:this.handleChangeBackground}),Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent})],editMode:o},Object(L.jsx)("div",{className:U()("dashboard-component","dashboard-component-header",l.className,c.className)},Object(L.jsx)(Un.a,{title:t.meta.text,canEdit:o,onSaveTitle:this.handleChangeText,showTooltip:!1}),!o&&Object(L.jsx)(ac,{anchorLinkId:t.id,filters:s,showShortLinkButton:!0}))),e&&Object(L.jsx)("div",e)))}}Jc.propTypes=Xc,Jc.defaultProps={};var Zc=Jc;const ed={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,editMode:T.a.bool.isRequired,availableColumnCount:T.a.number.isRequired,columnWidth:T.a.number.isRequired,occupiedColumnCount:T.a.number.isRequired,onResizeStart:T.a.func.isRequired,onResize:T.a.func.isRequired,onResizeStop:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,updateComponents:T.a.func.isRequired};class td extends R.a.PureComponent{constructor(e){var t,n,r,i;super(e),this.state={isFocused:!1},this.handleDeleteComponent=S()(t=this.handleDeleteComponent).call(t,this),this.handleUpdateMeta=S()(n=this.handleUpdateMeta).call(n,this),this.handleChangeBackground=S()(r=this.handleUpdateMeta).call(r,this,"background"),this.handleChangeFocus=S()(i=this.handleChangeFocus).call(i,this)}handleChangeFocus(e){this.setState(()=>({isFocused:Boolean(e)}))}handleUpdateMeta(e,t){const{updateComponents:n,component:r}=this.props;t&&r.meta[e]!==t&&n({[r.id]:{...r,meta:{...r.meta,[e]:t}}})}handleDeleteComponent(){const{deleteComponent:e,component:t,parentId:n}=this.props;e(t.id,n)}render(){const{component:e,parentComponent:t,index:n,availableColumnCount:r,columnWidth:i,occupiedColumnCount:a,depth:o,onResizeStart:s,onResize:l,onResizeStop:c,handleComponentDrop:d,editMode:u,isComponentVisible:h}=this.props,p=e.children||[],f=z()(Uc.a).call(Uc.a,t=>t.value===(e.meta.background||Z.b));return Object(L.jsx)(bt,{component:e,parentComponent:t,orientation:"row",index:n,depth:o,onDrop:d,editMode:u},({dropIndicatorProps:t,dragSourceRef:n})=>Object(L.jsx)(Fc,{isFocused:this.state.isFocused,onChangeFocus:this.handleChangeFocus,disableClick:!0,menuItems:[Object(L.jsx)(Vc,{id:`${e.id}-background`,value:f.value,onChange:this.handleChangeBackground})],editMode:u},u&&Object(L.jsx)(lc,{innerRef:n,position:"left"},Object(L.jsx)(Ac,{position:"left"}),Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent}),Object(L.jsx)(la,{onClick:this.handleChangeFocus,icon:Object(L.jsx)(zn.a.Cog,{iconSize:"xl"})})),Object(L.jsx)("div",{className:U()("grid-row",0===p.length&&"grid-row--empty",f.className)},Tt()(p).call(p,(t,n)=>Object(L.jsx)(xd,{key:t,id:t,parentId:e.id,depth:o+1,index:n,availableColumnCount:r-a,columnWidth:i,onResizeStart:s,onResize:l,onResizeStop:c,isComponentVisible:h})),t&&Object(L.jsx)("div",t))))}}td.propTypes=ed;var nd=td;const rd={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,renderType:T.a.oneOf(["RENDER_TAB","RENDER_TAB_CONTENT"]).isRequired,onDropOnTab:T.a.func,editMode:T.a.bool.isRequired,filters:T.a.object.isRequired,availableColumnCount:T.a.number,columnWidth:T.a.number,onResizeStart:T.a.func,onResize:T.a.func,onResizeStop:T.a.func,handleComponentDrop:T.a.func.isRequired,updateComponents:T.a.func.isRequired,setDirectPathToChild:T.a.func.isRequired},id={availableColumnCount:0,columnWidth:0,onDropOnTab(){},onResizeStart(){},onResize(){},onResizeStop(){}},ad=$.g.div`
  ${({isHighlighted:e,theme:{gridUnit:t,colors:n}})=>`\n    padding: ${t}px ${2*t}px;\n    margin: ${-t}px ${-2*t}px;\n    transition: box-shadow 0.2s ease-in-out;\n    ${e&&`box-shadow: 0 0 ${t}px ${n.primary.light1};`}\n  `}
`;class od extends R.a.PureComponent{constructor(e){var t,n,r,i;super(e),this.handleChangeText=S()(t=this.handleChangeText).call(t,this),this.handleDrop=S()(n=this.handleDrop).call(n,this),this.handleTopDropTargetDrop=S()(r=this.handleTopDropTargetDrop).call(r,this),this.handleChangeTab=S()(i=this.handleChangeTab).call(i,this)}handleChangeTab({pathToTabIndex:e}){this.props.setDirectPathToChild(e)}handleChangeText(e){const{updateComponents:t,component:n}=this.props;e&&e!==n.meta.text&&t({[n.id]:{...n,meta:{...n.meta,text:e}}})}handleDrop(e){this.props.handleComponentDrop(e),this.props.onDropOnTab(e)}handleTopDropTargetDrop(e){e&&this.props.handleComponentDrop({...e,destination:{...e.destination,index:0}})}renderTabContent(){var e;const{component:t,parentComponent:n,depth:r,availableColumnCount:i,columnWidth:a,onResizeStart:o,onResize:s,onResizeStop:l,editMode:c,isComponentVisible:d}=this.props;return Object(L.jsx)("div",{className:"dashboard-component-tabs-content"},c&&Object(L.jsx)(bt,{component:t,parentComponent:n,orientation:"column",index:0,depth:r,onDrop:this.handleTopDropTargetDrop,editMode:!0,className:"empty-droptarget"},({dropIndicatorProps:e})=>e&&Object(L.jsx)("div",{className:"drop-indicator drop-indicator--top"})),Tt()(e=t.children).call(e,(e,n)=>Object(L.jsx)(xd,{key:e,id:e,parentId:t.id,depth:r,index:n,onDrop:this.handleDrop,availableColumnCount:i,columnWidth:a,onResizeStart:o,onResize:s,onResizeStop:l,isComponentVisible:d,onChangeTab:this.handleChangeTab})),c&&Object(L.jsx)(bt,{component:t,parentComponent:n,orientation:"column",index:t.children.length,depth:r,onDrop:this.handleDrop,editMode:!0,className:"empty-droptarget"},({dropIndicatorProps:e})=>e&&Object(L.jsx)("div",{className:"drop-indicator drop-indicator--bottom"})))}renderTab(){const{component:e,parentComponent:t,index:n,depth:r,editMode:i,filters:a,isFocused:o,isHighlighted:s}=this.props;return Object(L.jsx)(bt,{component:e,parentComponent:t,orientation:"column",index:n,depth:r,onDrop:this.handleDrop,editMode:i},({dropIndicatorProps:t,dragSourceRef:r})=>Object(L.jsx)(ad,{isHighlighted:s,className:"dragdroppable-tab",ref:r},Object(L.jsx)(Un.a,{title:e.meta.text,defaultTitle:e.meta.defaultText,placeholder:e.meta.placeholder,canEdit:i&&o,onSaveTitle:this.handleChangeText,showTooltip:!1,editing:i&&o}),!i&&Object(L.jsx)(ac,{anchorLinkId:e.id,filters:a,showShortLinkButton:!0,placement:n>=5?"left":"right"}),t&&Object(L.jsx)("div",t)))}render(){const{renderType:e}=this.props;return"RENDER_TAB"===e?this.renderTab():this.renderTabContent()}}od.propTypes=rd,od.defaultProps=id;var sd=n(637),ld=n.n(sd);function cd({currentComponent:e,directPathToChild:t=[]}){var n;if(!e||0===t.length||-1===y()(t).call(t,e.id))return-1;const r=t[ld()(t).call(t,t=>t===e.id)+1];var i;return y()(n=e.children).call(n,r)>=0?ld()(i=e.children).call(i,e=>e===r):-1}function dd(e,t){var n;const r=Ca()(n=e.parents||[]).call(n);return r.push(e.id),r.push(e.children[t]),r}function ud(e=[]){if(e.length>0){const t=Ca()(e).call(e);for(;t.length;){const e=t.pop(),n=e.split("-")[0];if(!l()(Z.q).call(Z.q,n))return e}}return null}const hd={id:T.a.string.isRequired,parentId:T.a.string.isRequired,component:He.b.isRequired,parentComponent:He.b.isRequired,index:T.a.number.isRequired,depth:T.a.number.isRequired,renderTabContent:T.a.bool,editMode:T.a.bool.isRequired,renderHoverMenu:T.a.bool,directPathToChild:T.a.arrayOf(T.a.string),activeTabs:T.a.arrayOf(T.a.string),logEvent:T.a.func.isRequired,setActiveTabs:T.a.func,availableColumnCount:T.a.number,columnWidth:T.a.number,onResizeStart:T.a.func,onResize:T.a.func,onResizeStop:T.a.func,createComponent:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,onChangeTab:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,updateComponents:T.a.func.isRequired},pd={renderTabContent:!0,renderHoverMenu:!0,availableColumnCount:0,columnWidth:0,directPathToChild:[],activeTabs:[],setActiveTabs(){},onResizeStart(){},onResize(){},onResizeStop(){}},fd=$.g.div`
  width: 100%;
  background-color: ${({theme:e})=>e.colors.grayscale.light5};

  .dashboard-component-tabs-content {
    min-height: ${({theme:e})=>12*e.gridUnit}px;
    margin-top: ${({theme:e})=>e.gridUnit/4}px;
    position: relative;
  }

  .ant-tabs {
    overflow: visible;

    .ant-tabs-nav-wrap {
      min-height: ${({theme:e})=>12.5*e.gridUnit}px;
    }

    .ant-tabs-content-holder {
      overflow: visible;
    }
  }

  div .ant-tabs-tab-btn {
    text-transform: none;
  }
`;class bd extends R.a.PureComponent{constructor(e){var t,n,r,i;super(e),this.showDeleteConfirmModal=e=>{const{component:t,deleteComponent:n}=this.props;Yt.r.confirm({title:Object(_.e)("Delete dashboard tab?"),content:Object(L.jsx)("span",null,"Deleting a tab will remove all content within it. You may still reverse this action with the ",Object(L.jsx)("b",null,"undo")," button (cmd + z) until you save your changes."),onOk:()=>{var r;n(e,t.id);const i=y()(r=t.children).call(r,e);this.handleDeleteTab(i)},okType:"danger",okText:"DELETE",cancelText:"CANCEL",icon:null})},this.handleEdit=(e,t)=>{const{component:n,createComponent:r}=this.props;"add"===t?r({destination:{id:n.id,type:n.type,index:n.children.length},dragging:{id:Z.B,type:I.l}}):"remove"===t&&this.showDeleteConfirmModal(e)};const a=Math.max(0,cd({currentComponent:e.component,directPathToChild:e.directPathToChild})),{children:o}=e.component,s=o[a];this.state={tabIndex:a,activeKey:s},this.handleClickTab=S()(t=this.handleClickTab).call(t,this),this.handleDeleteComponent=S()(n=this.handleDeleteComponent).call(n,this),this.handleDeleteTab=S()(r=this.handleDeleteTab).call(r,this),this.handleDropOnTab=S()(i=this.handleDropOnTab).call(i,this)}componentDidMount(){this.props.setActiveTabs([...this.props.activeTabs,this.state.activeKey])}componentDidUpdate(e,t){var n;t.activeKey!==this.state.activeKey&&this.props.setActiveTabs([...O()(n=this.props.activeTabs).call(n,e=>e!==t.activeKey),this.state.activeKey])}UNSAFE_componentWillReceiveProps(e){const t=Math.max(0,e.component.children.length-1),n=this.props.component.children,r=e.component.children;if(this.state.tabIndex>t&&this.setState(()=>({tabIndex:t})),r.length){const e=r[r.length-1];r.length>n.length&&this.setState(()=>({activeKey:e,tabIndex:t})),r.length<n.length&&this.setState(()=>({activeKey:r[0]}))}if(e.isComponentVisible){if(ud(e.directPathToChild)!==ud(this.props.directPathToChild)){const t=cd({currentComponent:e.component,directPathToChild:e.directPathToChild});t>-1&&t!==this.state.tabIndex&&this.setState(()=>({tabIndex:t,activeKey:r[t]}))}}}handleClickTab(e){const{component:t}=this.props,{children:n}=t;if(e!==this.state.tabIndex){const n=dd(t,e),r=n[n.length-1];this.props.logEvent(Nn.n,{target_id:r,index:e}),this.props.onChangeTab({pathToTabIndex:n})}this.setState(()=>({activeKey:n[e]}))}handleDeleteComponent(){const{deleteComponent:e,id:t,parentId:n}=this.props;e(t,n)}handleDeleteTab(e){this.handleClickTab(Math.max(0,e-1))}handleDropOnTab(e){const{component:t}=this.props,{destination:n}=e;if(n){var r;const e=n.id===t.id?n.index:y()(r=t.children).call(r,n.id);e>-1&&_n()(()=>{this.handleClickTab(e)},30)}}render(){const{depth:e,component:t,parentComponent:n,index:r,availableColumnCount:i,columnWidth:a,onResizeStart:o,onResize:s,onResizeStop:c,handleComponentDrop:d,renderTabContent:u,renderHoverMenu:h,isComponentVisible:p,editMode:f,nativeFilters:b}=this.props,{children:m}=t,{tabIndex:g,activeKey:v}=this.state;let j;return null!=b&&b.focusedFilterId&&(j=b.filters[b.focusedFilterId].tabsInScope),Object(L.jsx)(bt,{component:t,parentComponent:n,orientation:"row",index:r,depth:e,onDrop:e=>{e.dragging.type!==I.k&&d(e)},editMode:f},({dropIndicatorProps:r,dragSourceRef:d})=>Object(L.jsx)(fd,{className:"dashboard-component dashboard-component-tabs"},f&&h&&Object(L.jsx)(lc,{innerRef:d,position:"left"},Object(L.jsx)(Ac,{position:"left"}),Object(L.jsx)(sc,{onDelete:this.handleDeleteComponent})),Object(L.jsx)(H.b,{id:t.id,activeKey:v,onChange:e=>{this.handleClickTab(y()(m).call(m,e))},onEdit:this.handleEdit,type:f?"editable-card":"card"},Tt()(m).call(m,(n,r)=>{var d;return Object(L.jsx)(H.b.TabPane,{key:n,tab:Object(L.jsx)(xd,{id:n,parentId:t.id,depth:e,index:r,renderType:"RENDER_TAB",availableColumnCount:i,columnWidth:a,onDropOnTab:this.handleDropOnTab,isFocused:v===n,isHighlighted:v!==n&&(null==(d=j)?void 0:l()(d).call(d,n))})},u&&Object(L.jsx)(xd,{id:n,parentId:t.id,depth:e,index:r,renderType:"RENDER_TAB_CONTENT",availableColumnCount:i,columnWidth:a,onResizeStart:o,onResize:s,onResizeStop:c,onDropOnTab:this.handleDropOnTab,isComponentVisible:g===r&&p}))})),r&&n.id!==Z.h&&Object(L.jsx)("div",r)))}}bd.propTypes=hd,bd.defaultProps=pd;var md=Object(i.b)((function(e){return{nativeFilters:e.nativeFilters}}))(bd);const gd={[I.a]:Cc,[I.h]:Ic,[I.b]:Wc,[I.f]:Qc,[I.g]:Zc,[I.j]:nd,[I.l]:od,[I.k]:md};var vd=n(1681);const jd={id:T.a.string,parentId:T.a.string,depth:T.a.number,index:T.a.number,renderHoverMenu:T.a.bool,renderTabContent:T.a.bool,onChangeTab:T.a.func,component:He.b.isRequired,parentComponent:He.b.isRequired,createComponent:T.a.func.isRequired,deleteComponent:T.a.func.isRequired,updateComponents:T.a.func.isRequired,handleComponentDrop:T.a.func.isRequired,logEvent:T.a.func.isRequired,directPathToChild:T.a.arrayOf(T.a.string),directPathLastUpdated:T.a.number,dashboardId:T.a.number.isRequired,isComponentVisible:T.a.bool};class yd extends R.a.PureComponent{render(){const{component:e}=this.props,t=e?gd[e.type]:null;return t?Object(L.jsx)(t,this.props):null}}yd.propTypes=jd,yd.defaultProps={directPathToChild:[],directPathLastUpdated:0,isComponentVisible:!0};var xd=Object(i.b)((function({dashboardLayout:e,dashboardState:t,dashboardInfo:n},r){const i=e.present,{id:a,parentId:o}=r,s=i[a],l={component:s,dashboardLayout:i,parentComponent:i[o],editMode:t.editMode,undoLength:e.past.length,redoLength:e.future.length,filters:Object($r.b)(),directPathToChild:t.directPathToChild,activeTabs:t.activeTabs,directPathLastUpdated:t.directPathLastUpdated,dashboardId:n.id,fullSizeChartId:t.fullSizeChartId};if(s){const e=s.type;if(e===I.j||e===I.b){const{occupiedWidth:t,minimumWidth:n}=Object(vd.a)({id:a,components:i});e===I.j&&(l.occupiedColumnCount=t),e===I.b&&(l.minColumnWidth=n)}}return l}),(function(e){return Object(r.b)({addDangerToast:na.c,createComponent:ta.k,deleteComponent:ta.m,updateComponents:ta.s,handleComponentDrop:ta.o,setDirectPathToChild:gr.H,setFullSizeChartId:gr.K,setActiveTabs:gr.F,logEvent:ra.logEvent},e)}))(yd);var Od,Cd=n(365),Sd=n(4758),wd=n(504);!function(e){e.AllFilters="allFilters",e.FilterSets="filterSets"}(Od||(Od={}));const Rd=e=>{var t;return P()(t=m()(e)).call(t,(e,t)=>({...e,[t.id]:t.extraFormData}),{})},kd=(e,t)=>{var n;const r=null==t?void 0:t.value;return(null==(n=e.controlValues)?void 0:n.enableEmptyFilter)&&null==r};var Td=n(115),_d=n.n(Td),Fd=n(446),Ed=n(158),Md=n.n(Ed);const Dd=()=>Object(i.d)(e=>e.nativeFilters.filterSets||{}),Pd=()=>Object(i.d)(e=>{var t,n;const r=(null==(t=e.dashboardState)?void 0:t.preselectNativeFilters)||{};return P()(n=Rt()(e.nativeFilters.filters)).call(n,(e,[t,n])=>({...e,[t]:{...n,preselect:r[t]}}),{})}),Id=()=>{var e,t;const n=Object(i.d)(e=>e.dataMask);return P()(e=O()(t=m()(n)).call(t,e=>{var t;return Md()(t=String(e.id)).call(t,uo.a)})).call(e,(e,t)=>({...e,[t.id]:t}),{})},Nd=(e,t)=>{const n=Dd(),r=m()(n),i=Object(w.useMemo)(()=>!!z()(r).call(r,({name:t})=>t===e),[r,e]);return t!==e&&i},qd=$.g.div`
  display: flex;
  & button {
    ${({disabled:e})=>`pointer-events: ${e?"none":"all"}`};
    flex: 1;
  }
`,zd=$.g.div`
  display: grid;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  grid-gap: 10px;
  grid-template-columns: 1fr 1fr;
`;var Ad=({onCancel:e,editMode:t,onEdit:n,onCreate:r,disabled:i,filterSetName:a})=>{const o=Nd(a),s=!a||o||i;return Object(L.jsx)(R.a.Fragment,null,t?Object(L.jsx)(zd,null,Object(L.jsx)(An.a,{buttonStyle:"tertiary",buttonSize:"small",onClick:e},Object(_.e)("Cancel")),Object(L.jsx)(Ii.a,{placement:"right",title:!a&&Object(_.e)("Please filter set name")||o&&Object(_.e)("Filter set with this name already exists")||i&&xl},Object(L.jsx)(qd,{disabled:s},Object(L.jsx)(An.a,Wn()({disabled:s,buttonStyle:"primary",htmlType:"submit",buttonSize:"small",onClick:r},Ku("create-filter-set-button")),Object(_.e)("Create"))))):Object(L.jsx)(Ii.a,{placement:"bottom",title:i&&xl},Object(L.jsx)(qd,{disabled:i},Object(L.jsx)(An.a,Wn()({disabled:i,buttonStyle:"tertiary",buttonSize:"small",onClick:n},Ku("new-filter-set-button")),Object(_.e)("Create new filter set")))))},Ud={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},$d=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:Ud}))};$d.displayName="CheckOutlined";var Ld=w.forwardRef($d),Vd={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},Hd=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:Vd}))};Hd.displayName="EllipsisOutlined";var Bd=w.forwardRef(Hd);const Wd=$.g.div`
  display: flex;
  align-items: center;
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
`,Gd=Object($.g)(Yt.h)`
  &.ant-collapse-ghost > .ant-collapse-item {
    & > .ant-collapse-content > .ant-collapse-content-box {
      padding: 0;
      padding-top: 0;
      padding-bottom: 0;
      font-size: ${({theme:e})=>e.typography.sizes.s}px;
    }
    & > .ant-collapse-header {
      padding: 0;
      display: flex;
      align-items: center;
      flex-direction: row-reverse;
      justify-content: flex-end;
      max-width: max-content;
      & .ant-collapse-arrow {
        position: static;
        padding-left: ${({theme:e})=>e.gridUnit}px;
      }
  }
`,Kd=$.g.div`
  padding-top: ${({theme:e})=>e.gridUnit}px;
  padding-bottom: ${({theme:e})=>e.gridUnit}px;
`;var Qd=({dataMask:e,filterSet:t})=>{const n=Object($.i)(),r=Pd(),i=m()(r);let a=null!=i?i:[];null!=t&&t.nativeFilters&&(a=m()(null==t?void 0:t.nativeFilters));return Object(L.jsx)(Gd,{ghost:!0,expandIconPosition:"right",defaultActiveKey:t?void 0:["filters"],expandIcon:({isActive:e})=>{const t=n.colors.grayscale.base,r=e?zn.a.CaretUpOutlined:zn.a.CaretDownOutlined;return Object(L.jsx)(r,{iconColor:t})}},Object(L.jsx)(Yt.h.Panel,Wn()({},Ku("collapse-filter-set-description"),{header:Object(L.jsx)(Wd,null,Object(L.jsx)(Yt.E.Text,{type:"secondary"},Object(_.e)("Filters (%d)",a.length))),key:"filters"}),Tt()(a).call(a,({id:n,name:i})=>{var a,o,s,c;const d=t&&!Object(Ra.f)(r[n],null==t?void 0:null==(a=t.nativeFilters)?void 0:a[n],{ignoreUndefined:!0}),u=!l()(o=f()(r)).call(o,n);return Object(L.jsx)(Yt.C,{title:u&&Object(_.e)("This filter doesn't exist in dashboard. It will not be applied.")||d&&Object(_.e)("Filter metadata changed in dashboard. It will not be applied."),placement:"bottomLeft",key:n},Object(L.jsx)(Kd,null,Object(L.jsx)(Yt.E.Text,{strong:!0,delete:u,mark:d},i,":"),Object(L.jsx)(Yt.E.Text,{delete:u,mark:d},Ol(null==e?void 0:null==(s=e[n])?void 0:null==(c=s.filterState)?void 0:c.value)||Object(L.jsx)(Yt.E.Text,{type:"secondary"},Object(_.e)("None")))))})))};const Yd=Object($.g)(An.a)`
  padding: 0;
`,Xd=$.g.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
`,Jd=$.g.div`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  & > *,
  & > button.superset-button {
    ${({theme:e})=>`margin-left: ${2*e.gridUnit}px`};
  }
`;var Zd=({editMode:e,setFilterSetName:t,onDelete:n,onEdit:r,filterSetName:i,dataMaskSelected:a,filterSet:o,isApplied:s,onRebuild:l})=>{var c,d;const u=Object(L.jsx)(Yt.q,null,Object(L.jsx)(Yt.q.Item,{onClick:r},Object(_.e)("Edit")),Object(L.jsx)(Yt.q.Item,{onClick:l},Object(L.jsx)(Ii.a,{placement:"right",title:Object(_.e)("Remove invalid filters")},Object(_.e)("Rebuild"))),Object(L.jsx)(Yt.q.Item,{onClick:n,danger:!0},Object(_.e)("Delete")));return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Xd,null,Object(L.jsx)(Yt.E.Text,{strong:!0,editable:{editing:e,icon:Object(L.jsx)("span",null),onChange:t}},null!=(c=null==o?void 0:o.name)?c:i),Object(L.jsx)(Jd,null,s&&Object(L.jsx)(Ld,{style:{color:$.h.colors.success.base}}),n&&Object(L.jsx)(Yt.j,{overlay:u,placement:"bottomRight",trigger:["click"]},Object(L.jsx)(Yd,Wn()({onClick:e=>{e.stopPropagation(),e.preventDefault()}},Ku("filter-set-menu-button"),{buttonStyle:"link",buttonSize:"xsmall"}),Object(L.jsx)(Bd,null))))),Object(L.jsx)(Qd,{filterSet:o,dataMask:null!=(d=null==o?void 0:o.dataMask)?d:a}))};const eu=$.g.div`
  display: grid;
  align-items: center;
  justify-content: center;
  grid-template-columns: 1fr;
  padding: ${({theme:e})=>2*e.gridUnit}px
    ${({theme:e})=>4*e.gridUnit}px;

  & button.superset-button {
    margin-left: 0;
  }
  & input {
    width: 100%;
  }
`,tu=$.g.div`
  ${({theme:e,"data-selected":t,onClick:n})=>`\n    display: grid;\n    align-items: center;\n    justify-content: center;\n    grid-template-columns: 1fr;\n    grid-gap: ${e.gridUnit}px;\n    border-bottom: 1px solid ${e.colors.grayscale.light2};\n    padding: ${2*e.gridUnit}px 0px};\n    cursor: ${n?"pointer":"auto"};\n    background: ${t?e.colors.primary.light5:"transparent"};\n  `}
`,nu=Object(_.e)("New filter set");var ru=({dataMaskSelected:e,onEditFilterSet:t,disabled:n,onFilterSelectionChange:r,isFilterSetChanged:a})=>{const o=Object(i.c)(),[s,l]=Object(w.useState)(nu),[c,u]=Object(w.useState)(!1),h=Id(),p=Dd(),b=m()(p),g=Pd(),j=m()(g),[y,x]=Object(w.useState)(null);Object(w.useEffect)(()=>{var t;if(a)return;const n=Cl({dataMaskSelected:e,filterSetFilterValues:b});x(null!=(t=null==n?void 0:n.id)?t:null)},[a,e,b]);const C=(e,t)=>{var n;return!z()(j).call(j,t=>(null==t?void 0:t.id)===e)||!Object(Ra.f)(g[e],null==t?void 0:null==(n=t.nativeFilters)?void 0:n[e],{ignoreUndefined:!0})},S=(e,t)=>{var n,i,a,o,s,l,c,d;if(null!=t&&t.classList.contains("ant-collapse-header")||null!=t&&t.classList.contains("ant-dropdown-menu-item")||null!=t&&null!=(n=t.parentElement)&&n.classList.contains("ant-collapse-header")||null!=t&&null!=(i=t.parentElement)&&null!=(a=i.parentElement)&&a.classList.contains("ant-collapse-header")||null!=t&&null!=(o=t.parentElement)&&null!=(s=o.parentElement)&&null!=(l=s.parentElement)&&l.classList.contains("ant-collapse-header"))return;if(x(e),!e)return;const u=p[e];v()(c=null!=(d=m()(null==u?void 0:u.dataMask))?d:[]).call(c,e=>{const{extraFormData:t,filterState:n,id:i}=e;C(i,u)||r({id:i},{extraFormData:t,filterState:n})})};return Object(L.jsx)(eu,null,!y&&Object(L.jsx)(tu,null,Object(L.jsx)(Zd,{dataMaskSelected:e,editMode:c,setFilterSetName:l,filterSetName:s}),Object(L.jsx)(Ad,{filterSetName:_d()(s).call(s),disabled:n,onCancel:()=>{u(!1),l(nu)},editMode:c,onEdit:()=>u(!0),onCreate:()=>{var e,t;const n={name:_d()(s).call(s),id:`FILTERS_SET-${yl.a.generate()}`,nativeFilters:g,dataMask:P()(e=f()(g)).call(e,(e,t)=>({...e,[t]:h[t]}),{})};o(Object(Fd.h)(d()(t=[n]).call(t,b))),u(!1),l(nu)}})),Tt()(b).call(b,r=>Object(L.jsx)(tu,Wn()({},Ku("filter-set-wrapper"),{"data-selected":r.id===y,onClick:e=>S(r.id,e.target),key:r.id}),Object(L.jsx)(Zd,{isApplied:r.id===y&&!n,onDelete:()=>{return e=r.id,o(Object(Fd.h)(O()(b).call(b,t=>t.id!==e))),void(e===y&&x(null));var e},onEdit:()=>{return e=r.id,S(e),void t(e);var e},onRebuild:()=>(e=>{var t,n,r,i;const a=p[e],s=P()(t=O()(n=m()(null!=(r=null==a?void 0:a.dataMask)?r:{})).call(n,e=>{const{id:t}=e;return!C(t,a)})).call(t,(e,t)=>({...e,[t.id]:g[t.id]}),{}),l={...a,nativeFilters:s,dataMask:P()(i=f()(s)).call(i,(e,t)=>{var n;return{...e,[t]:null==(n=a.dataMask)?void 0:n[t]}},{})};o(Object(Fd.h)(Tt()(b).call(b,e=>e.id===l.id?l:e)))})(r.id),dataMaskSelected:e,filterSet:r}))))},iu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},au=function(e,t){return w.createElement(go.a,Object.assign({},e,{ref:t,icon:iu}))};au.displayName="WarningOutlined";var ou=w.forwardRef(au);const su=$.g.div`
  display: grid;
  grid-template-columns: 1fr;
  align-items: flex-start;
  justify-content: flex-start;
  grid-gap: ${({theme:e})=>e.gridUnit}px;
  background: ${({theme:e})=>e.colors.primary.light4};
  padding: ${({theme:e})=>2*e.gridUnit}px;
`,lu=Object($.g)(Yt.E.Text)`
  color: ${({theme:e})=>e.colors.primary.dark2};
`,cu=Object($.g)(Yt.E.Text)`
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
  & .anticon {
    padding: ${({theme:e})=>e.gridUnit}px;
  }
`,du=$.g.div`
  display: flex;
  & button {
    ${({disabled:e})=>`pointer-events: ${e?"none":"all"}`};
    flex: 1;
  }
`;var uu=({filterSetId:e,onCancel:t,dataMaskSelected:n,disabled:r})=>{const a=Id(),o=Object(i.c)(),s=Dd(),l=Pd(),c=m()(s),[d,u]=Object(w.useState)(s[e].name),h=Nd(d,s[e].name),p=Object(w.useMemo)(()=>Cl({dataMaskSelected:n,filterSetFilterValues:c}),[n,c]),f=p&&p.id!==e,b=r||f||h;return Object(L.jsx)(su,null,Object(L.jsx)(lu,{strong:!0},Object(_.e)("Editing filter set:")),Object(L.jsx)(lu,{editable:{editing:!0,icon:Object(L.jsx)("span",null),onChange:u}},d),Object(L.jsx)(zd,null,Object(L.jsx)(An.a,{ghost:!0,buttonStyle:"tertiary",buttonSize:"small",onClick:t},Object(_.e)("Cancel")),Object(L.jsx)(Yt.C,{placement:"right",title:h&&Object(_.e)("Filter set with this name already exists")||f&&Object(_.e)("Filter set already exists")||r&&xl},Object(L.jsx)(du,{disabled:b},Object(L.jsx)(An.a,Wn()({disabled:b,buttonStyle:"primary",htmlType:"submit",buttonSize:"small",onClick:()=>{o(Object(Fd.h)(Tt()(c).call(c,t=>{const n={...t,name:d,nativeFilters:l,dataMask:{...a}};return e===t.id?n:t}))),t()}},Ku("filter-set-edit-save")),Object(_.e)("Save"))))),f&&Object(L.jsx)(cu,{mark:!0},Object(L.jsx)(ou,null),Object(_.e)('This filter set is identical to: "%s"',null==p?void 0:p.name)))};const hu=Object($.g)(An.a)`
  padding: 0;
`;var pu=({createNewOnOpen:e,children:t})=>{const n=Object(i.c)(),[r,a]=Object(w.useState)(!1);function o(){a(!1)}return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(hu,Wn()({},Ku("create-filter"),{buttonStyle:"link",buttonSize:"xsmall",onClick:()=>a(!0)}),t),Object(L.jsx)(Ps,{isOpen:r,onSave:async function(e){n(await Object(Fd.g)(e)),o()},onCancel:o,createNewOnOpen:e}))};const fu=$.g.h4`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  margin: 0;
  padding: ${({theme:e})=>2*e.gridUnit}px;

  & > span {
    flex-grow: 1;
  }
`,bu=$.g.div`
  display: grid;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  grid-gap: 10px;
  grid-template-columns: 1fr 1fr;
  ${({theme:e})=>`padding: 0 ${2*e.gridUnit}px`};

  .btn {
    flex: 1;
  }
`,mu=Object($.g)(An.a)`
  padding: 0;
`,gu=$.g.div`
  padding: ${({theme:e})=>e.gridUnit}px
    ${({theme:e})=>2*e.gridUnit}px;
`;var vu,ju=({onApply:e,onClearAll:t,isApplyDisabled:n,dataMaskSelected:r,dataMaskApplied:a,toggleFiltersBar:o})=>{var s;const l=Object($.i)(),c=Pd(),d=m()(c),u=Object(i.d)(({dashboardInfo:e})=>e.dash_edit_perm),h=Ke()(s=m()(a)).call(s,e=>{var t,n,i;return null===(null==(t=r[e.id])?void 0:null==(n=t.filterState)?void 0:n.value)||!r[e.id]&&null===(null==(i=e.filterState)?void 0:i.value)});return Object(L.jsx)(gu,null,Object(L.jsx)(fu,null,Object(L.jsx)("span",null,Object(_.e)("Filters")),u&&Object(L.jsx)(pu,{createNewOnOpen:0===d.length},Object(L.jsx)(zn.a.Edit,{iconColor:l.colors.grayscale.base})),Object(L.jsx)(mu,Wn()({},Ku("collapse-button"),{buttonStyle:"link",buttonSize:"xsmall",onClick:()=>o(!1)}),Object(L.jsx)(zn.a.Expand,{iconColor:l.colors.grayscale.base}))),Object(L.jsx)(bu,null,Object(L.jsx)(An.a,Wn()({disabled:h,buttonStyle:"tertiary",buttonSize:"small",onClick:t},Ku("clear-button")),Object(_.e)("Clear all")),Object(L.jsx)(An.a,Wn()({disabled:n,buttonStyle:"primary",htmlType:"submit",buttonSize:"small",onClick:e},Ku("apply-button")),Object(_.e)("Apply"))))},yu=n(29),xu=(vu=function(e,t){return(vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}vu(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ou=function(e){var t,n,r,i={};if("html"===e)r=document.createElement("div");else{if("svg"!==e)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');r=document.createElementNS("http://www.w3.org/2000/svg","g")}var a={element:r,elementType:e,setPortalProps:function(e){i=e},getInitialPortalProps:function(){return i},mount:function(r,i){if(i!==n){if(a.unmount(),r!==t&&!function(e,t){if("html"===t)return e instanceof HTMLElement;if("svg"===t)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(r,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+r.tagName+">.");r.replaceChild(a.element,i),t=r,n=i}},unmount:function(e){e&&e!==n||t&&n&&(t.replaceChild(n,a.element),t=void 0,n=void 0)}};return a},Cu=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return xu(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,r=t.node;return yu.createPortal(w.Children.map(n,(function(t){return w.isValidElement(t)?w.cloneElement(t,e.state.nodeProps):t})),r.element)},t}(w.PureComponent),Su=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=w.createRef(),n.passPropsThroughPortal(),n}return xu(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return w.createElement("div",{ref:this.placeholderNode})},t}(w.PureComponent),wu=Ou.bind(null,"html"),Ru=(Ou.bind(null,"svg"),n(941)),ku=n.n(Ru);function Tu(e){var t;const n=function(e){const t={};return v()(e).call(e,e=>{const[n]=e.cascadeParentIds||[];n&&(t[n]||(t[n]=[]),t[n].push(e))}),t}(e),r=e=>{const t=n[e.id]||[];return{...e,cascadeChildren:Tt()(t).call(t,r)}};return Tt()(t=O()(e).call(e,e=>{var t;return!(null!=(t=e.cascadeParentIds)&&t.length)})).call(t,r)}const _u=G()((e,t)=>{e(t?Object(Fd.i)(t):Object(Fd.k)())},300);const Fu=$.g.div`
  & > div {
    height: auto !important;
    min-height: ${32}px;
  }
`;var Eu=({dataMaskSelected:e,filter:t,directPathToChild:n,onFilterSelectionChange:r,inView:a=!0})=>{var o,s,l;const{id:c,targets:d,filterType:u,adhoc_filters:h,time_range:p}=t,f=Object(ka.a)().get(u),b=function(e,t){var n;const{filters:r}=Object(i.d)(e=>e.nativeFilters),a=r[e],o=null!=(n=null==a?void 0:a.cascadeParentIds)?n:[];let s={};return v()(o).call(o,e=>{const n=null==t?void 0:t[e];s=Object(ha.d)(s,null==n?void 0:n.extraFormData)}),s}(c,e),m=Object(i.d)(e=>e.dashboardState.isRefreshing),[g,j]=Object(w.useState)([]),[y,x]=Object(w.useState)(""),[O,C]=Object(w.useState)({inView:!1}),[S,R]=Object(w.useState)({}),[k,T]=Object(w.useState)(a),F=Object(w.useRef)(null),[E]=d,{datasetId:D,column:P={}}=E,{name:I}=P,N=!!D,[q,z]=Object(w.useState)(N),[A,U]=Object(w.useState)(!1),$=Object(i.c)();Object(w.useEffect)(()=>{!k&&a&&T(!0)},[a,k,T]),Object(w.useEffect)(()=>{var e;if(!k)return;const n=Object(ha.c)({...t,datasetId:D,cascadingFilters:b,groupby:I,inputRef:F,adhoc_filters:h,time_range:p}),r=(null==(e=t.dataMask)?void 0:e.ownState)||{};if(!A&&(!Object(Ra.f)(O,n)||!Object(Ra.f)(S,r)||m)){if(C(n),R(r),!N)return;U(!0),Object(ca.getChartDataRequest)({formData:n,force:!1,requestParams:{dashboardId:0},ownState:r}).then(({response:e,json:t})=>{if(Object(qn.c)(qn.a.GLOBAL_ASYNC_QUERIES)){const n="result"in t?t.result[0]:t;if(200===e.status)U(!1),z(!1),j([n]);else{if(202!==e.status)throw new Error(`Received unexpected response status (${e.status}) while fetching chart data`);Object(Io.a)(n).then(e=>{U(!1),z(!1),j(e)}).catch(e=>{x(e.message||e.error||Object(_.e)("Check configuration")),U(!1),z(!1)})}}else j(t.result),x(""),U(!1),z(!1)}).catch(e=>{x(e.statusText),U(!1),z(!1)})}},[k,b,D,I,di()(t),N,A,m]),Object(w.useEffect)(()=>{if((null==n?void 0:n[0])===t.id){const e=_n()(()=>{var e;null==F||null==(e=F.current)||e.focus()},200);return()=>clearTimeout(e)}},[F,n,t.id]);if(y)return Object(L.jsx)(Ao,{title:Object(_.e)("Cannot load filter"),body:y,level:"error"});const V=kd(t,null==(o=t.dataMask)?void 0:o.filterState),H={...null==(s=t.dataMask)?void 0:s.filterState,validateStatus:V&&"error"};return Object(L.jsx)(Fu,null,q?Object(L.jsx)(M.a,{position:"inline-centered"}):Object(L.jsx)(Xo.a,{height:32,width:"100%",formData:O,queriesData:N?g:[{data:[{}]}],chartType:u,behaviors:[Ta.b.NATIVE_FILTER],filterState:H,ownState:null==(l=t.dataMask)?void 0:l.ownState,enableNoResults:null==f?void 0:f.enableNoResults,isRefreshing:A,hooks:{setDataMask:e=>r(t,e),setFocusedFilter:()=>_u($,c),unsetFocusedFilter:()=>_u($)}}))};const Mu=$.g.div`
  position: absolute;
  right: 0;
`,Du=$.g.h4`
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
  color: ${({theme:e})=>e.colors.grayscale.dark1};
  margin: 0;
  overflow-wrap: break-word;
`,Pu=$.g.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-between;
  margin-bottom: ${({theme:e})=>e.gridUnit}px;
`,Iu=Object($.g)(ir.a)`
  width: 100%;
  && .ant-form-item-label > label {
    text-transform: none;
    width: 100%;
    padding-right: ${({theme:e})=>11*e.gridUnit}px;
  }
`;var Nu=({dataMaskSelected:e,filter:t,icon:n,onFilterSelectionChange:r,directPathToChild:i,inView:a})=>{var o,s;const{name:l="<undefined>"}=t,c=kd(t,null==(o=t.dataMask)?void 0:o.filterState);return Object(L.jsx)(Iu,{layout:"vertical"},Object(L.jsx)(ir.b,{label:Object(L.jsx)(Pu,null,Object(L.jsx)(Du,null,l),Object(L.jsx)(Mu,null,n)),required:null==t?void 0:null==(s=t.controlValues)?void 0:s.enableEmptyFilter,validateStatus:c?"error":void 0},Object(L.jsx)(Eu,{dataMaskSelected:e,filter:t,directPathToChild:i,onFilterSelectionChange:r,inView:a})))};const qu=$.g.div`
  display: flex;
  width: 100%;
  flex-direction: column;
  align-items: center;

  .ant-form-item {
    margin-bottom: ${({theme:e})=>4*e.gridUnit}px;
  }
`,zu=({dataMaskSelected:e,filter:t,directPathToChild:n,onFilterSelectionChange:r})=>{var i;return Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Nu,{dataMaskSelected:e,filter:t,directPathToChild:n,onFilterSelectionChange:r}),Object(L.jsx)(qu,null,null==(i=t.cascadeChildren)?void 0:Tt()(i).call(i,t=>Object(L.jsx)(zu,{key:t.id,dataMaskSelected:e,filter:t,directPathToChild:n,onFilterSelectionChange:r}))))};var Au=zu;const Uu=$.g.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  background-color: ${({theme:e})=>e.colors.grayscale.light4};
  margin: ${({theme:e})=>-1*e.gridUnit}px
    ${({theme:e})=>-4*e.gridUnit}px; // to override default antd padding
  padding: ${({theme:e})=>2*e.gridUnit}px
    ${({theme:e})=>4*e.gridUnit}px;

  & > *:last-child {
    cursor: pointer;
  }
`,$u=$.g.h4`
  display: flex;
  align-items: center;
  color: ${({theme:e})=>e.colors.grayscale.dark1};
  margin: 0;
  padding: 0;
`,Lu=e=>L.css`
  margin-right: ${e.gridUnit}px;
  color: ${e.colors.grayscale.dark1};
  width: ${4*e.gridUnit}px;
`,Vu=Object($.g)(cl)`
  padding: ${({theme:e})=>e.gridUnit}px
    ${({theme:e})=>2*e.gridUnit}px;
  font-size: ${({theme:e})=>e.typography.sizes.s}px;
  background: ${({theme:e})=>e.colors.grayscale.light1};
`,Hu=$.g.div`
  max-height: 700px;
  overflow-y: auto;
`;var Bu=({dataMaskSelected:e,filter:t,visible:n,onVisibleChange:r,onFilterSelectionChange:i,directPathToChild:a,inView:o})=>{var s;const[c,d]=Object(w.useState)(),u=e[t.id];Object(w.useEffect)(()=>{d(a);const e=_n()(()=>d(void 0),500);return()=>clearTimeout(e)},[a,d]);const h=Object(w.useCallback)(e=>{var t;const n=e.cascadeChildren||[],r=null==u?void 0:null==(t=u.filterState)?void 0:t.value,i=ku()(n).call(n,e=>h(e)||[]);return i.length>0?i:null!=r?[e]:null},[u]),p=e=>{const t=e.cascadeChildren||[];return[e,...ku()(t).call(t,p)]},f=p(t),b=Object(w.useMemo)(()=>h(t)||[t],[t,h]);if(Object(w.useEffect)(()=>{const e=null==c?void 0:c[0],t=O()(f).call(f,e=>!l()(b).call(b,e));wr()(t).call(t,t=>t.id===e)&&r(!0)},[c]),null==(s=t.cascadeChildren)||!s.length)return Object(L.jsx)(Nu,{dataMaskSelected:e,filter:t,directPathToChild:a,onFilterSelectionChange:i,inView:o});const m=Object(L.jsx)(Uu,null,Object(L.jsx)($u,null,Object(L.jsx)(zn.a.Edit,{iconSize:"l",css:e=>Lu(e)}),Object(_.e)("Select parent filters")," (",f.length,")"),Object(L.jsx)(zn.a.Close,{iconSize:"l",css:e=>Lu(e),onClick:()=>r(!1)})),g=Object(L.jsx)(Hu,null,Object(L.jsx)(Au,{dataMaskSelected:e,key:t.id,filter:t,directPathToChild:n?c:void 0,onFilterSelectionChange:i}));return Object(L.jsx)(ll.a,{content:g,title:m,trigger:"click",visible:n,onVisibleChange:r,placement:"rightTop",id:t.id,overlayStyle:{width:"400px"}},Object(L.jsx)("div",null,Tt()(b).call(b,n=>Object(L.jsx)(Nu,{dataMaskSelected:e,key:n.id,filter:n,onFilterSelectionChange:i,directPathToChild:c,inView:o,icon:Object(L.jsx)(R.a.Fragment,null,0!==t.cascadeChildren.length&&Object(L.jsx)(Vu,{onClick:()=>r(!0)},Object(L.jsx)(zn.a.Filter,{iconSize:"m"})," ",f.length))}))))};const Wu=$.g.div`
  padding: ${({theme:e})=>4*e.gridUnit}px;
  &:hover {
    cursor: pointer;
  }
`;var Gu=({directPathToChild:e,dataMaskSelected:t,onFilterSelectionChange:n})=>{var r;const[i,a]=Object(w.useState)(null),o=Pd(),s=m()(o),l=R.a.useMemo(()=>{const e=new Array(s.length);for(let t=0;t<s.length;t+=1)e[t]=wu();return e},[s.length]),c=Object(w.useMemo)(()=>Tu(Tt()(s).call(s,e=>({...e,dataMask:t[e.id]}))),[s,t]),d=new h.a(Tt()(c).call(c,e=>e.id)),[u,p]=function(e){const t=lo(),n=co();return Object(w.useMemo)(()=>{let r=[];const i=[];return t?v()(e).call(e,e=>{n(e)?r.push(e):i.push(e)}):r=e,[r,i]},[e,t,n])}(c),f=lo()&&c.length>0;return Object(L.jsx)(Wu,null,Tt()(r=O()(l).call(l,(e,t)=>d.has(s[t].id))).call(r,(r,o)=>Object(L.jsx)(Cu,{node:r},Object(L.jsx)(Bu,{key:c[o].id,dataMaskSelected:t,visible:i===c[o].id,onVisibleChange:e=>a(e?c[o].id:null),filter:c[o],onFilterSelectionChange:n,directPathToChild:e,inView:!1}))),Tt()(u).call(u,e=>{const t=ld()(s).call(s,t=>t.id===e.id);return Object(L.jsx)(Su,{node:l[t],inView:!0})}),f&&Object(L.jsx)(Yt.h,{ghost:!0,bordered:!0,expandIconPosition:"right",collapsible:0===p.length?"disabled":void 0,css:e=>Object(L.css)("&.ant-collapse{margin-top:",u.length>0?6*e.gridUnit:0,"px;&>.ant-collapse-item{&>.ant-collapse-header{padding-left:0;padding-bottom:",2*e.gridUnit,"px;&>.ant-collapse-arrow{right:",e.gridUnit,"px;}}& .ant-collapse-content-box{padding:",4*e.gridUnit,"px 0 0;}}}","")},Object(L.jsx)(Yt.h.Panel,{header:`${Object(_.e)("Filters out of scope")} (${p.length})`,key:"1"},Tt()(p).call(p,e=>{const t=ld()(c).call(c,t=>t.id===e.id);return Object(L.jsx)(Su,{node:l[t],inView:!0})}))))};const Ku=Object(io.a)("filter-bar"),Qu=$.g.div`
  width: ${({theme:e})=>8*e.gridUnit}px;

  & .ant-tabs-top > .ant-tabs-nav {
    margin: 0;
  }
  &.open {
    width: ${({width:e})=>e}px; // arbitrary...
  }
`,Yu=$.g.div`
  & .ant-typography-edit-content {
    left: 0;
    margin-top: 0;
    width: 100%;
  }
  position: absolute;
  top: 0;
  left: 0;
  flex-direction: column;
  flex-grow: 1;
  width: ${({width:e})=>e}px;
  background: ${({theme:e})=>e.colors.grayscale.light5};
  border-right: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  border-bottom: 1px solid ${({theme:e})=>e.colors.grayscale.light2};
  min-height: 100%;
  display: none;

  &.open {
    display: flex;
  }
`,Xu=$.g.div`
  position: absolute;
  top: ${({offset:e})=>e}px;
  left: 0;
  height: 100%;
  width: ${({theme:e})=>8*e.gridUnit}px;
  padding-top: ${({theme:e})=>2*e.gridUnit}px;
  display: none;
  text-align: center;

  &.open {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: ${({theme:e})=>2*e.gridUnit}px;
  }

  svg {
    cursor: pointer;
  }
`,Ju=Object($.g)(zn.a.Collapse)`
  color: ${({theme:e})=>e.colors.primary.base};
  margin-bottom: ${({theme:e})=>3*e.gridUnit}px;
`,Zu=Object($.g)(zn.a.Filter)`
  color: ${({theme:e})=>e.colors.grayscale.base};
`,eh=Object($.g)(Yt.y)`
  & .ant-tabs-nav-list {
    width: 100%;
  }
  & .ant-tabs-tab {
    display: flex;
    justify-content: center;
    margin: 0;
    flex: 1;
  }
`;var th=({filtersOpen:e,toggleFiltersBar:t,directPathToChild:n,width:r,height:a,offset:o})=>{const s=Object(Cd.f)(),l=Id(),[c,d]=Object(w.useState)(null),[u,h]=Object(Sd.a)(l),p=Object(i.c)(),b=Dd(),g=m()(b),[j,y]=Object(w.useState)(Od.AllFilters),x=Pd(),C=Object(Uo.a)(x),S=m()(x),[R,k]=Object(w.useState)(!1);Object(w.useEffect)(()=>{h(()=>l)},[di()(l),h]),Object(w.useEffect)(()=>{h(e=>{var t;v()(t=m()(x)).call(t,t=>{var n,r;t.filterType!==(null==C?void 0:null==(n=C[t.id])?void 0:n.filterType)&&void 0!==(null==C?void 0:null==(r=C[t.id])?void 0:r.filterType)&&(e[t.id]=Object(wd.b)(t.id))})})},[di()(x),di()(C),h]);const T=(e,t)=>{k(j!==Od.AllFilters),h(n=>{var r,i,a;void 0!==(null==(r=t.filterState)?void 0:r.value)&&void 0===(null==(i=u[e.id])?void 0:null==(a=i.filterState)?void 0:a.value)&&e.requiredFirst&&p(Object(kn.h)(e.id,t)),n[e.id]={...Object(wd.b)(e.id),...t}})},F=Object(w.useCallback)(e=>{const{location:t}=s,{search:n}=t,r=new hi.a(n),i=new hi.a;v()(r).call(r,(e,t)=>{t!==Hn.g.nativeFilters.name&&i.append(t,e)}),i.set(Hn.g.nativeFilters.name,fi.a.encode(gi(e))),s.replace({search:i.toString()})},[s]),E=di()(l);Object(w.useEffect)(()=>{F(l)},[E,F]);((e,t)=>{const n=Pd(),r=Id();Object(w.useEffect)(()=>{var r;v()(r=f()(e)).call(r,e=>{n[e]||t(t=>{delete t[e]})})},[r,e,n,t])})(u,h);const D=((e,t,n)=>{const r=m()(e),i=m()(t);return Object(Ra.f)(Rd(e),Rd(t),{ignoreUndefined:!0})||r.length!==i.length||wr()(n).call(n,t=>{var n;return kd(t,null==e?void 0:null==(n=e[null==t?void 0:t.id])?void 0:n.filterState)})})(u,l,S),P=(()=>{const[e,t]=Object(w.useState)(!1),n=Pd(),r=Object(i.d)(e=>e.charts);let a=0;return e||(a=document.querySelectorAll('[data-ui-anchor="chart"]').length),Object(w.useEffect)(()=>{var i,o;if(e)return;if(z()(i=m()(n)).call(i,({requiredFirst:e})=>e))return void t(!0);let s;0===a&&(s=_n()(()=>{t(!0)},1e3)),a>0&&void 0!==s&&clearTimeout(s);const l=O()(o=m()(r)).call(o,({chartStatus:e})=>"loading"!==e).length;a>0&&l>=a&&t(!0)},[r,e,a]),e})();return Object(L.jsx)(Qu,Wn()({},Ku(),{className:U()({open:e}),width:r}),Object(L.jsx)(Xu,Wn()({},Ku("collapsable"),{className:U()({open:!e}),onClick:()=>t(!0),offset:o}),Object(L.jsx)(Ju,Wn()({},Ku("expand-button"),{iconSize:"l"})),Object(L.jsx)(Zu,Wn()({},Ku("filter-icon"),{iconSize:"l"}))),Object(L.jsx)(Yu,{className:U()({open:e}),width:r},Object(L.jsx)(ju,{toggleFiltersBar:t,onApply:()=>{const e=f()(u);v()(e).call(e,e=>{u[e]&&p(Object(kn.h)(e,u[e]))})},onClearAll:()=>{const e=f()(u);v()(e).call(e,e=>{u[e]&&p(Object(kn.e)(e))})},isApplyDisabled:D,dataMaskSelected:u,dataMaskApplied:l}),P?Object(qn.c)(qn.a.DASHBOARD_NATIVE_FILTERS_SET)?Object(L.jsx)(eh,{centered:!0,onChange:y,defaultActiveKey:Od.AllFilters,activeKey:c?Od.AllFilters:void 0},Object(L.jsx)(Yt.y.TabPane,{tab:Object(_.e)(`All Filters (${S.length})`),key:Od.AllFilters,css:Object(L.css)({overflow:"auto",height:a},"","")},c&&Object(L.jsx)(uu,{dataMaskSelected:u,disabled:!D,onCancel:()=>d(null),filterSetId:c}),Object(L.jsx)(Gu,{dataMaskSelected:u,directPathToChild:n,onFilterSelectionChange:T})),Object(L.jsx)(Yt.y.TabPane,{disabled:!!c,tab:Object(_.e)(`Filter Sets (${g.length})`),key:Od.FilterSets,css:Object(L.css)({overflow:"auto",height:a},"","")},Object(L.jsx)(ru,{onEditFilterSet:d,disabled:!D,dataMaskSelected:u,isFilterSetChanged:R,onFilterSelectionChange:T}))):Object(L.jsx)("div",{css:Object(L.css)({overflow:"auto",height:a},"","")},Object(L.jsx)(Gu,{dataMaskSelected:u,directPathToChild:n,onFilterSelectionChange:T})):Object(L.jsx)("div",{css:Object(L.css)({height:a},"","")},Object(L.jsx)(M.a,null))))};const nh=e=>{const t=e[Z.h].children[0];return t===Z.d?e[Z.h]:e[t]},rh=(e,t)=>"ant-tabs-nav-wrap"===e.target.className||t.contains(e.target);var ih=n(288),ah=n.n(ih);const oh={depth:T.a.number.isRequired,editMode:T.a.bool.isRequired,gridComponent:He.b.isRequired,handleComponentDrop:T.a.func.isRequired,isComponentVisible:T.a.bool.isRequired,resizeComponent:T.a.func.isRequired,setDirectPathToChild:T.a.func.isRequired,width:T.a.number.isRequired};class sh extends R.a.PureComponent{constructor(e){var t,n,r,i,a,o,s;super(e),this.state={isResizing:!1,rowGuideTop:null},this.handleResizeStart=S()(t=this.handleResizeStart).call(t,this),this.handleResize=S()(n=this.handleResize).call(n,this),this.handleResizeStop=S()(r=this.handleResizeStop).call(r,this),this.handleTopDropTargetDrop=S()(i=this.handleTopDropTargetDrop).call(i,this),this.getRowGuidePosition=S()(a=this.getRowGuidePosition).call(a,this),this.setGridRef=S()(o=this.setGridRef).call(o,this),this.handleChangeTab=S()(s=this.handleChangeTab).call(s,this)}getRowGuidePosition(e){return e&&this.grid?e.getBoundingClientRect().bottom-this.grid.getBoundingClientRect().top-2:null}setGridRef(e){this.grid=e}handleResizeStart({ref:e,direction:t}){let n=null;"bottom"!==t&&"bottomRight"!==t||(n=this.getRowGuidePosition(e)),this.setState(()=>({isResizing:!0,rowGuideTop:n}))}handleResize({ref:e,direction:t}){"bottom"!==t&&"bottomRight"!==t||this.setState(()=>({rowGuideTop:this.getRowGuidePosition(e)}))}handleResizeStop({id:e,widthMultiple:t,heightMultiple:n}){this.props.resizeComponent({id:e,width:t,height:n}),this.setState(()=>({isResizing:!1,rowGuideTop:null}))}handleTopDropTargetDrop(e){e&&this.props.handleComponentDrop({...e,destination:{...e.destination,index:0}})}handleChangeTab({pathToTabIndex:e}){this.props.setDirectPathToChild(e)}render(){var e,t,n;const{gridComponent:r,handleComponentDrop:i,depth:a,editMode:o,width:s,isComponentVisible:l}=this.props,c=(s+Z.n)/Z.l-Z.n,{isResizing:d,rowGuideTop:u}=this.state;return s<100?null:Object(L.jsx)("div",{className:"dashboard-grid",ref:this.setGridRef},Object(L.jsx)("div",{className:"grid-content"},o&&Object(L.jsx)(bt,{component:r,depth:a,parentComponent:null,index:0,orientation:"column",onDrop:this.handleTopDropTargetDrop,className:"empty-droptarget",editMode:!0},({dropIndicatorProps:e})=>e&&Object(L.jsx)("div",{className:"drop-indicator drop-indicator--bottom"})),Tt()(e=r.children).call(e,(e,t)=>Object(L.jsx)(xd,{key:e,id:e,parentId:r.id,depth:a+1,index:t,availableColumnCount:Z.l,columnWidth:c,isComponentVisible:l,onResizeStart:this.handleResizeStart,onResize:this.handleResize,onResizeStop:this.handleResizeStop,onChangeTab:this.handleChangeTab})),o&&r.children.length>0&&Object(L.jsx)(bt,{component:r,depth:a,parentComponent:null,index:r.children.length,orientation:"column",onDrop:i,className:"empty-droptarget",editMode:!0},({dropIndicatorProps:e})=>e&&Object(L.jsx)("div",{className:"drop-indicator drop-indicator--top"})),d&&Tt()(t=qc()(n=Array(Z.l)).call(n,null)).call(t,(e,t)=>Object(L.jsx)("div",{key:`grid-column-${t}`,className:"grid-column-guide",style:{left:t*Z.n+t*c,width:c}})),d&&u&&Object(L.jsx)("div",{className:"grid-row-guide",style:{top:u,width:s}})))}}sh.propTypes=oh,sh.defaultProps={};var lh=sh;var ch=Object(i.b)((function({dashboardState:e}){return{editMode:e.editMode}}),(function(e){return Object(r.b)({handleComponentDrop:ta.o,resizeComponent:ta.q,setDirectPathToChild:gr.H},e)}))(lh);var dh=({topLevelTabs:e})=>{var t,n;const r=Object(i.d)(e=>e.dashboardLayout.present),a=null!=(t=Object(i.d)(e=>{var t;return null==(t=e.nativeFilters)?void 0:t.filters}))?t:{},o=Object(i.d)(e=>e.dashboardState.directPathToChild),[s,l]=Object(w.useState)(((e,t)=>Math.max(0,cd({currentComponent:nh(e),directPathToChild:t})))(r,o)),c=Object(i.c)();Object(w.useEffect)(()=>{const e=cd({currentComponent:nh(r),directPathToChild:o});e>-1&&l(e)},[ud(o)]);const d=Tt()(n=m()(a)).call(n,e=>({id:e.id,scope:e.scope}));Object(w.useEffect)(()=>{if(!Object(F.b)(F.a.DASHBOARD_NATIVE_FILTERS)||0===d.length)return;const e=Tt()(d).call(d,e=>{const{scope:t}=e,n=Object($r.d)({filterScope:{scope:t.rootPath,immune:t.excluded}}),i=Object(ha.a)(r,n);return{filterId:e.id,tabsInScope:ah()(i),chartsInScope:n}});c(Object(Fd.j)(e))},[di()(d),r,c]);const u=e?e.children:[Z.d],h=Math.min(s,u.length-1),p=0===h?Z.d:h.toString();return Object(L.jsx)("div",{className:"grid-container"},Object(L.jsx)(J,null,({width:e})=>Object(L.jsx)(H.c,{id:Z.d,activeKey:p,renderTabBar:()=>Object(L.jsx)(R.a.Fragment,null),fullWidth:!1,animated:!1,allowOverflow:!0},Tt()(u).call(u,(t,n)=>Object(L.jsx)(H.c.TabPane,{key:0===n?Z.d:n.toString()},Object(L.jsx)(ch,{gridComponent:r[t],depth:Z.g+1,width:e,isComponentVisible:n===s}))))))};const uh=$.g.div`
  display: grid;
  grid-template-columns: auto 1fr;
  grid-template-rows: auto 1fr;
  flex: 1;
`,hh=$.g.div`
  grid-column: 1;
  grid-row: 1 / span 2;
  z-index: 11;
`,ph=$.g.div`
  position: sticky;
  top: -1px;
  width: ${({width:e})=>e}px;
  flex: 0 0 ${({width:e})=>e}px;
`,fh=$.g.div`
  grid-column: 2;
  grid-row: 1;
  position: sticky;
  top: 0px;
  z-index: 100;
`,bh=$.g.div`
  grid-column: 2;
  grid-row: 2;
  // @z-index-above-dashboard-header (100) + 1 = 101
  ${({fullSizeChartId:e})=>e&&"z-index: 101;"}
`,mh=$.g.div`
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  height: auto;
  flex: 1;

  .grid-container .dashboard-component-tabs {
    box-shadow: none;
    padding-left: 0;
  }

  .grid-container {
    /* without this, the grid will not get smaller upon toggling the builder panel on */
    width: 0px;
    flex: 1;
    position: relative;
    margin-top: ${({theme:e})=>6*e.gridUnit}px;
    margin-right: ${({theme:e})=>8*e.gridUnit}px;
    margin-bottom: ${({theme:e})=>6*e.gridUnit}px;
    margin-left: ${({theme:e,dashboardFiltersOpen:t,editMode:n})=>t||n?8*e.gridUnit:0}px;
  }

  .dashboard-component-chart-holder {
    // transitionable traits to show filter relevance
    transition: opacity ${({theme:e})=>e.transitionTiming}s,
      border-color ${({theme:e})=>e.transitionTiming}s,
      box-shadow ${({theme:e})=>e.transitionTiming}s;
    border: 0 solid transparent;
  }
`;var gh=()=>{const e=Object(i.c)(),t=Object(i.d)(e=>e.dashboardLayout.present),n=Object(i.d)(e=>e.dashboardState.editMode),r=Object(i.d)(e=>e.dashboardState.directPathToChild),a=Object(i.d)(e=>e.dashboardState.fullSizeChartId),o=({pathToTabIndex:t})=>{e(Object(gr.H)(t))},s=()=>{e(Object(ta.n)());const n=dd(nh(t),0);e(Object(gr.H)(n))},l=t[Z.h],c=l.children[0],d=c!==Z.d?t[c]:void 0,u=Object(yi.b)(Hn.g.standalone),h=u===Z.j.REPORT,p=u===Z.j.HIDE_NAV_AND_TITLE||h,f=(p?0:72)+(d?50:0),{showDashboard:b,dashboardFiltersOpen:g,toggleDashboardFiltersOpen:v,nativeFiltersEnabled:j}=(()=>{var e;const[t,n]=Object(w.useState)(!1),[r,a]=Object(w.useState)(null==(e=Object(yi.b)(Hn.g.showFilters))||e),o=Object(i.d)(e=>{var t;return null==(t=e.dashboardInfo.metadata)?void 0:t.show_native_filters}),s=Object(i.d)(({dashboardInfo:e})=>e.dash_edit_perm),l=Pd(),c=m()(l),d=o&&Object(qn.c)(qn.a.DASHBOARD_NATIVE_FILTERS)&&(s||!s&&0!==c.length),u=O()(c).call(c,e=>e.requiredFirst),h=Id(),p=t||!d||!(d&&u.length&&z()(u).call(u,({id:e})=>{var t,n;return void 0===(null==(t=h[e])?void 0:null==(n=t.filterState)?void 0:n.value)})),f=e=>{a(null!=e?e:!r)};return Object(w.useEffect)(()=>{0===c.length&&r&&d&&f(!1)},[c.length]),Object(w.useEffect)(()=>{p&&n(!0)},[p]),{showDashboard:p,dashboardFiltersOpen:r,toggleDashboardFiltersOpen:f,nativeFiltersEnabled:d}})(),y=g?260:32,[x,C]=function(e){const t=Object(w.useRef)(null),[n,r]=Object(w.useState)(!1),i=e=>{const[t]=e;r(t.intersectionRatio<1)};return Object(w.useEffect)(()=>{const n=new IntersectionObserver(i,e),r=t.current;return r&&n.observe(r),()=>{r&&n.unobserve(r)}},[t,e]),[t,n]}({threshold:[1]}),S=`calc(100vh - ${80+(C||u?0:53)+(Object(qn.c)(qn.a.DASHBOARD_NATIVE_FILTERS_SET)?46:0)}px)`,R=g?0:f+20;return Object(L.jsx)(uh,null,j&&!n&&Object(L.jsx)(hh,null,Object(L.jsx)(ph,{ref:x,width:y},Object(L.jsx)(V.a,null,Object(L.jsx)(th,{filtersOpen:g,toggleFiltersBar:v,directPathToChild:r,width:y,height:S,offset:R})))),Object(L.jsx)(fh,null,Object(L.jsx)(bt,{component:l,parentComponent:null,depth:Z.g,index:0,orientation:"column",onDrop:t=>e(Object(ta.o)(t)),editMode:n,disableDragDrop:!!d,style:{marginLeft:g||n?0:-32}},({dropIndicatorProps:e})=>Object(L.jsx)("div",null,!p&&Object(L.jsx)(aa,null),e&&Object(L.jsx)("div",e),!h&&d&&Object(L.jsx)(Fc,{shouldFocus:rh,menuItems:[Object(L.jsx)(la,{icon:Object(L.jsx)(zn.a.FallOutlined,{iconSize:"xl"}),label:"Collapse tab content",onClick:s})],editMode:n},Object(L.jsx)(xd,{id:null==d?void 0:d.id,parentId:Z.h,depth:Z.g+1,index:0,renderTabContent:!1,renderHoverMenu:!1,onChangeTab:o}))))),Object(L.jsx)(bh,{fullSizeChartId:a},Object(L.jsx)(L.Global,{styles:L.css`
            // @z-index-above-dashboard-header (100) + 1 = 101
            ${a&&"div > .filterStatusPopover.ant-popover{z-index: 101}"}
          `}),Object(L.jsx)("div",{className:U()("dashboard",n&&"dashboard--editing")},Object(L.jsx)(mh,{className:"dashboard-content",dashboardFiltersOpen:g,editMode:n},b?Object(L.jsx)(dh,{topLevelTabs:d}):Object(L.jsx)(M.a,null),n&&Object(L.jsx)(Rn,{topOffset:f})))))},vh=n(1136),jh=n(4986),yh=n.n(jh);function xh({extensions:e,placeholder:t,id:n}){return Object(L.jsx)(yh.a,{id:n,placeholder:t,extensions:e})}const Oh=async e=>{var t,n;let r;try{r=await Vn.a.get({endpoint:`/dashboardasync/api/read?_oc_DashboardModelViewAsync=changed_on&_od_DashboardModelViewAsync=desc&_flt_2_dashboard_title=${e}`})}catch(e){return[{title:Object(_.e)("An error occurred while fetching dashboards")}]}return null==(t=r)?void 0:Tt()(n=t.json.result).call(n,e=>({title:e.dashboard_title,...e}))},Ch=Object($.g)(_a.b)`
  margin-top: 20%;

  .ant-modal-body {
    padding: 0;
  }
`;function Sh({logEvent:e}){const t=Object(w.useRef)(),[n,r]=Object(w.useState)(!1);return Object(vh.a)(()=>{function n(n){var i;if(!Object(qn.c)(qn.a.OMNIBAR))return;const a=n.ctrlKey||n.metaKey,o=l()(i=["KeyK","KeyS"]).call(i,n.code);var s;a&&o&&(e(Nn.k,{show_omni:!!t.current}),t.current=!t.current,r(t.current),t.current&&(null==(s=document.getElementById("InputOmnibar"))||s.focus()))}return t.current=!1,document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)}),Object(L.jsx)(Ch,{title:"",show:n,hideFooter:!0,closable:!1,onHide:()=>{}},Object(L.jsx)(xh,{id:"InputOmnibar",placeholder:"Search all dashboards",extensions:[Oh]}))}n(4988);const wh=[I.a,I.h];function Rh(e){var t;return!wr()(t=m()(e)).call(t,({type:e})=>e&&l()(wh).call(wh,e))}const kh=(e,t)=>{var n;const r=f()(e),i=f()(t),a=O()((o=r,s=i,n=[...O()(o).call(o,e=>!l()(s).call(s,e)),...O()(s).call(s,e=>!l()(o).call(o,e))])).call(n,n=>e[n]||t[n]);var o,s;const c=new h.a([...r,...i]);return v()(c).call(c,n=>{Object(Ra.f)(e[n],t[n])||a.push(n)}),[...new h.a(a)]},Th={actions:T.a.shape({addSliceToDashboard:T.a.func.isRequired,removeSliceFromDashboard:T.a.func.isRequired,triggerQuery:T.a.func.isRequired,logEvent:T.a.func.isRequired,clearDataMaskState:T.a.func.isRequired}).isRequired,dashboardInfo:He.d.isRequired,dashboardState:He.e.isRequired,charts:T.a.objectOf(He.a).isRequired,slices:T.a.objectOf(He.g).isRequired,activeFilters:T.a.object.isRequired,chartConfiguration:T.a.object.isRequired,datasources:T.a.object.isRequired,ownDataCharts:T.a.object.isRequired,layout:T.a.object.isRequired,impressionId:T.a.string.isRequired,initMessages:T.a.array,timeout:T.a.number,userId:T.a.string};class _h extends R.a.PureComponent{static onBeforeUnload(e){e?window.addEventListener("beforeunload",_h.unload):window.removeEventListener("beforeunload",_h.unload)}static unload(){const e=Object(_.e)("You have unsaved changes.");return window.event.returnValue=e,e}constructor(e){var t,n,r;super(e),this.appliedFilters=null!=(t=e.activeFilters)?t:{},this.appliedOwnDataCharts=null!=(n=e.ownDataCharts)?n:{},this.onVisibilityChange=S()(r=this.onVisibilityChange).call(r,this)}componentDidMount(){const e=document.getElementById("app"),t=(null==e?void 0:e.getAttribute("data-bootstrap"))||"",{dashboardState:n,layout:r}=this.props,i={is_edit_mode:n.editMode,mount_duration:Nn.q.getTimestamp(),is_empty:Rh(r),is_published:n.isPublished,bootstrap_data_length:t.length},a=Object(nc.a)();a&&(i.target_id=a),this.props.actions.logEvent(Nn.i,i),"hidden"===document.visibilityState&&(this.visibilityEventData={start_offset:Nn.q.getTimestamp(),ts:(new Date).getTime()}),window.addEventListener("visibilitychange",this.onVisibilityChange),this.applyCharts()}componentDidUpdate(){this.applyCharts()}UNSAFE_componentWillReceiveProps(e){const t=N(this.props.layout),n=N(e.layout);if(this.props.dashboardInfo.id===e.dashboardInfo.id)if(t.length<n.length){const r=O()(n).call(n,e=>-1===y()(t).call(t,e));v()(r).call(r,t=>{return this.props.actions.addSliceToDashboard(t,(n=e.layout,r=t,z()(i=m()(n)).call(i,e=>e&&e.type===I.a&&e.meta&&e.meta.chartId===r)));var n,r,i})}else if(t.length>n.length){const e=O()(t).call(t,e=>-1===y()(n).call(n,e));v()(e).call(e,e=>this.props.actions.removeSliceFromDashboard(e))}}applyCharts(){const{hasUnsavedChanges:e,editMode:t}=this.props.dashboardState,{appliedFilters:n,appliedOwnDataCharts:r}=this,{activeFilters:i,ownDataCharts:a,chartConfiguration:o}=this.props;Object(F.b)(F.a.DASHBOARD_CROSS_FILTERS)&&!o||(t||Object(Ra.f)(r,a,{ignoreUndefined:!0})&&Object(Ra.f)(n,i,{ignoreUndefined:!0})||this.applyFilters(),e?_h.onBeforeUnload(!0):_h.onBeforeUnload(!1))}componentWillUnmount(){window.removeEventListener("visibilitychange",this.onVisibilityChange),this.props.actions.clearDataMaskState()}onVisibilityChange(){if("hidden"===document.visibilityState)this.visibilityEventData={start_offset:Nn.q.getTimestamp(),ts:(new Date).getTime()};else if("visible"===document.visibilityState){const e=this.visibilityEventData.start_offset;this.props.actions.logEvent(Nn.g,{...this.visibilityEventData,duration:Nn.q.getTimestamp()-e})}}getAllCharts(){return m()(this.props.charts)}applyFilters(){var e;const{appliedFilters:t}=this,{activeFilters:n,ownDataCharts:r}=this.props,i=f()(n),a=f()(t),s=new h.a(d()(i).call(i,a)),c=kh(r,this.appliedOwnDataCharts);v()(e=[...s]).call(e,e=>{if(!l()(i).call(i,e)&&l()(a).call(a,e))c.push(...t[e].scope);else if(l()(a).call(a,e)){if(Object(Ra.f)(o()(t[e]),o()(n[e]),{ignoreUndefined:!0})||c.push(...n[e].scope),!Object(Ra.f)(t[e].scope,n[e].scope)){var r;const i=d()(r=n[e].scope||[]).call(r,t[e].scope||[]);c.push(...i)}}else c.push(...n[e].scope)}),this.refreshCharts([...new h.a(c)]),this.appliedFilters=n,this.appliedOwnDataCharts=r}refreshCharts(e){v()(e).call(e,e=>{this.props.actions.triggerQuery(!0,e)})}render(){return this.context.loading?Object(L.jsx)(M.a,null):Object(L.jsx)(R.a.Fragment,null,Object(L.jsx)(Sh,{logEvent:this.props.actions.logEvent}),Object(L.jsx)(gh,null))}}_h.contextType=E.b,_h.propTypes=Th,_h.defaultProps={initMessages:[],timeout:60,userId:""};var Fh=_h,Eh=n(525);t.default=Object(i.b)((function(e){var t,n;const{datasources:r,sliceEntities:i,charts:a,dataMask:o,dashboardInfo:s,dashboardState:l,dashboardLayout:c,impressionId:d,nativeFilters:u}=e;return{initMessages:s.common.flash_messages,timeout:s.common.conf.SUPERSET_WEBSERVER_TIMEOUT,userId:s.userId,dashboardInfo:s,dashboardState:l,charts:a,datasources:r,activeFilters:{...Object($r.b)(),...va({chartConfiguration:null==(t=s.metadata)?void 0:t.chart_configuration,nativeFilters:u.filters,dataMask:o,layout:c.present})},chartConfiguration:null==(n=s.metadata)?void 0:n.chart_configuration,ownDataCharts:ga(o,"ownState"),slices:i.slices,layout:c.present,impressionId:d}}),(function(e){return{actions:Object(r.b)({setDatasources:Eh.c,clearDataMaskState:kn.f,addSliceToDashboard:gr.v,removeSliceFromDashboard:gr.B,triggerQuery:ca.triggerQuery,logEvent:ra.logEvent},e)}}))(Fh)},664:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return F})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return M})),n.d(t,"f",(function(){return D}));var r=n(39),i=n.n(r),a=n(11),o=n.n(a),s=n(32),l=n.n(s),c=n(71),d=n.n(c),u=n(128),h=n.n(u),p=n(35),f=n.n(p),b=n(0),m=n(40),g=n(13),v=n(97),j=n.n(v),y=n(19),x=n(104),O=n(45),C=n(220),S=n(221),w=n(1638),R=n(1);const k=Object(m.g)(O.a)`
  font-size: ${({theme:e})=>e.typography.sizes.s}px;

  // needed to override button's first-of-type margin: 0
  && {
    margin: 0 ${({theme:e})=>2*e.gridUnit}px;
  }

  i {
    padding: 0 ${({theme:e})=>e.gridUnit}px;
  }
`,T=Object(R.jsx)(k,{buttonSize:"xsmall"},Object(R.jsx)("i",{className:"fa fa-clipboard"})),_=({data:e,columns:t})=>Object(R.jsx)(S.a,{text:e&&t?Object(C.g)(e,t):"",wrapped:!1,copyNode:T}),F=({onChangeHandler:e})=>{const t=j()(e,x.e);return Object(R.jsx)(y.m,{placeholder:Object(g.e)("Search"),onChange:e=>{const n=e.target.value;t(n)}})},E=({data:e,loading:t})=>{var n;return Object(R.jsx)(w.a,{rowcount:null!=(n=null==e?void 0:e.length)?n:0,loading:t,suffix:Object(g.e)("rows retrieved")})},M=(e,t)=>Object(b.useMemo)(()=>{if(null==t||!t.length)return[];const n=Object(C.d)(t);return f()(n).call(n,t=>{var n;return h()(n=d()(t)).call(n,t=>{var n;return null==t?void 0:l()(n=t.toString().toLowerCase()).call(n,e.toLowerCase())})})},[t,e]),D=(e,t,n)=>Object(b.useMemo)(()=>{var r;return e&&null!=t&&t.length?o()(r=f()(e).call(e,e=>{var n;return l()(n=i()(t[0])).call(n,e)})).call(r,e=>({accessor:t=>t[e],Header:e,Cell:({value:e})=>!0===e?x.b:!1===e?x.a:String(e),...null==n?void 0:n[e]})):[]},[t,n])},957:function(e,t){function n(e,t,n,r){var i,a=null==(i=r)||"number"==typeof i||"boolean"==typeof i?r:n(r),o=t.get(a);return void 0===o&&(o=e.call(this,r),t.set(a,o)),o}function r(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),a=t.get(i);return void 0===a&&(a=e.apply(this,r),t.set(i,a)),a}function i(e,t,n,r,i){return n.bind(t,e,r,i)}function a(e,t){return i(e,this,1===e.length?n:r,t.cache.create(),t.serializer)}function o(){return JSON.stringify(arguments)}function s(){this.cache=Object.create(null)}s.prototype.has=function(e){return e in this.cache},s.prototype.get=function(e){return this.cache[e]},s.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new s}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,r=t&&t.serializer?t.serializer:o;return(t&&t.strategy?t.strategy:a)(e,{cache:n,serializer:r})},e.exports.strategies={variadic:function(e,t){return i(e,this,r,t.cache.create(),t.serializer)},monadic:function(e,t){return i(e,this,n,t.cache.create(),t.serializer)}}}}]);